function convertDateIntoYYMMDD(t){var e=t.getMonth()+1,n=t.getDate();10>e&&(e="0"+e),10>n&&(n="0"+n);var r=t.getFullYear()+"-"+e+"-"+n;return r}function getMinRange(t){return Math.min(Math.min(getMinFromArray(t,"Trend"),getMinFromArray(t,"LowBand")),getMinFromArray(t,"Low"),getMinFromArray(t,"Close"))}function getMaxRange(t){return Math.max(Math.max(getMaxFromArray(t,"Trend"),getMaxFromArray(t,"HighBand")),getMaxFromArray(t,"High"),getMaxFromArray(t,"Close"))}function getMinFromArray(t,e){var n=Number.MAX_VALUE;return angular.forEach(t,function(t){t[e]<n&&0!=t[e]&&(n=t[e])}),n}function getMaxFromArray(t,e){var n=-Number.MAX_VALUE;return angular.forEach(t,function(t){t[e]>n&&0!=t[e]&&(n=t[e])}),n==Number.MIN_VALUE?void 0:n}!function(){function t(t,e){return e>t?-1:t>e?1:t>=e?0:0/0}function e(t){return null===t?0/0:+t}function n(t){return!isNaN(t)}function r(t){return{left:function(e,n,r,a){for(arguments.length<3&&(r=0),arguments.length<4&&(a=e.length);a>r;){var i=r+a>>>1;t(e[i],n)<0?r=i+1:a=i}return r},right:function(e,n,r,a){for(arguments.length<3&&(r=0),arguments.length<4&&(a=e.length);a>r;){var i=r+a>>>1;t(e[i],n)>0?a=i:r=i+1}return r}}}function a(t){return t.length}function i(t){for(var e=1;t*e%1;)e*=10;return e}function o(t,e){for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}function l(){this._=Object.create(null)}function s(t){return(t+="")===cl||t[0]===dl?dl+t:t}function u(t){return(t+="")[0]===dl?t.slice(1):t}function c(t){return s(t)in this._}function d(t){return(t=s(t))in this._&&delete this._[t]}function f(){var t=[];for(var e in this._)t.push(u(e));return t}function h(){var t=0;for(var e in this._)++t;return t}function p(){for(var t in this._)return!1;return!0}function g(){this._=Object.create(null)}function y(t,e,n){return function(){var r=n.apply(e,arguments);return r===e?t:r}}function v(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var n=0,r=fl.length;r>n;++n){var a=fl[n]+e;if(a in t)return a}}function m(){}function x(){}function b(t){function e(){for(var e,r=n,a=-1,i=r.length;++a<i;)(e=r[a].on)&&e.apply(this,arguments);return t}var n=[],r=new l;return e.on=function(e,a){var i,o=r.get(e);return arguments.length<2?o&&o.on:(o&&(o.on=null,n=n.slice(0,i=n.indexOf(o)).concat(n.slice(i+1)),r.remove(e)),a&&n.push(r.set(e,{on:a})),t)},e}function k(){$o.event.preventDefault()}function A(){for(var t,e=$o.event;t=e.sourceEvent;)e=t;return e}function M(t){for(var e=new x,n=0,r=arguments.length;++n<r;)e[arguments[n]]=b(e);return e.of=function(n,r){return function(a){try{var i=a.sourceEvent=$o.event;a.target=t,$o.event=a,e[a.type].apply(n,r)}finally{$o.event=i}}},e}function w(t){return pl(t,xl),t}function C(t){return"function"==typeof t?t:function(){return gl(t,this)}}function S(t){return"function"==typeof t?t:function(){return yl(t,this)}}function T(t,e){function n(){this.removeAttribute(t)}function r(){this.removeAttributeNS(t.space,t.local)}function a(){this.setAttribute(t,e)}function i(){this.setAttributeNS(t.space,t.local,e)}function o(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function l(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}return t=$o.ns.qualify(t),null==e?t.local?r:n:"function"==typeof e?t.local?l:o:t.local?i:a}function L(t){return t.trim().replace(/\s+/g," ")}function _(t){return new RegExp("(?:^|\\s+)"+$o.requote(t)+"(?:\\s+|$)","g")}function N(t){return(t+"").trim().split(/^|\s+/)}function D(t,e){function n(){for(var n=-1;++n<a;)t[n](this,e)}function r(){for(var n=-1,r=e.apply(this,arguments);++n<a;)t[n](this,r)}t=N(t).map(F);var a=t.length;return"function"==typeof e?r:n}function F(t){var e=_(t);return function(n,r){if(a=n.classList)return r?a.add(t):a.remove(t);var a=n.getAttribute("class")||"";r?(e.lastIndex=0,e.test(a)||n.setAttribute("class",L(a+" "+t))):n.setAttribute("class",L(a.replace(e," ")))}}function V(t,e,n){function r(){this.style.removeProperty(t)}function a(){this.style.setProperty(t,e,n)}function i(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}return null==e?r:"function"==typeof e?i:a}function I(t,e){function n(){delete this[t]}function r(){this[t]=e}function a(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}return null==e?n:"function"==typeof e?a:r}function P(t){return"function"==typeof t?t:(t=$o.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,t)}}function z(t){return{__data__:t}}function E(t){return function(){return ml(this,t)}}function O(e){return arguments.length||(e=t),function(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}}function R(t,e){for(var n=0,r=t.length;r>n;n++)for(var a,i=t[n],o=0,l=i.length;l>o;o++)(a=i[o])&&e(a,o,n);return t}function B(t){return pl(t,kl),t}function Y(t){var e,n;return function(r,a,i){var o,l=t[i].update,s=l.length;for(i!=n&&(n=i,e=0),a>=e&&(e=a+1);!(o=l[e])&&++e<s;);return o}}function q(){var t=this.__transition__;t&&++t.active}function G(t,e,n){function r(){var e=this[o];e&&(this.removeEventListener(t,e,e.$),delete this[o])}function a(){var a=s(e,Zo(arguments));r.call(this),this.addEventListener(t,this[o]=a,a.$=n),a._=e}function i(){var e,n=new RegExp("^__on([^.]+)"+$o.requote(t)+"$");for(var r in this)if(e=r.match(n)){var a=this[r];this.removeEventListener(e[1],a,a.$),delete this[r]}}var o="__on"+t,l=t.indexOf("."),s=j;l>0&&(t=t.slice(0,l));var u=Ml.get(t);return u&&(t=u,s=U),l?e?a:r:e?m:i}function j(t,e){return function(n){var r=$o.event;$o.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{$o.event=r}}}function U(t,e){var n=j(t,e);return function(t){var e=this,r=t.relatedTarget;r&&(r===e||8&r.compareDocumentPosition(e))||n.call(e,t)}}function H(){var t=".dragsuppress-"+ ++Cl,e="click"+t,n=$o.select(tl).on("touchmove"+t,k).on("dragstart"+t,k).on("selectstart"+t,k);if(wl){var r=Qo.style,a=r[wl];r[wl]="none"}return function(i){function o(){n.on(e,null)}n.on(t,null),wl&&(r[wl]=a),i&&(n.on(e,function(){k(),o()},!0),setTimeout(o,0))}}function X(t,e){e.changedTouches&&(e=e.changedTouches[0]);var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();if(0>Sl&&(tl.scrollX||tl.scrollY)){n=$o.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var a=n[0][0].getScreenCTM();Sl=!(a.f||a.e),n.remove()}return Sl?(r.x=e.pageX,r.y=e.pageY):(r.x=e.clientX,r.y=e.clientY),r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}function W(){return $o.event.changedTouches[0].identifier}function $(){return $o.event.target}function J(){return tl}function Z(t){return t>0?1:0>t?-1:0}function K(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function Q(t){return t>1?0:-1>t?Tl:Math.acos(t)}function te(t){return t>1?_l:-1>t?-_l:Math.asin(t)}function ee(t){return((t=Math.exp(t))-1/t)/2}function ne(t){return((t=Math.exp(t))+1/t)/2}function re(t){return((t=Math.exp(2*t))-1)/(t+1)}function ae(t){return(t=Math.sin(t/2))*t}function ie(){}function oe(t,e,n){return this instanceof oe?(this.h=+t,this.s=+e,void(this.l=+n)):arguments.length<2?t instanceof oe?new oe(t.h,t.s,t.l):be(""+t,ke,oe):new oe(t,e,n)}function le(t,e,n){function r(t){return t>360?t-=360:0>t&&(t+=360),60>t?i+(o-i)*t/60:180>t?o:240>t?i+(o-i)*(240-t)/60:i}function a(t){return Math.round(255*r(t))}var i,o;return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:0>e?0:e>1?1:e,n=0>n?0:n>1?1:n,o=.5>=n?n*(1+e):n+e-n*e,i=2*n-o,new ye(a(t+120),a(t),a(t-120))}function se(t,e,n){return this instanceof se?(this.h=+t,this.c=+e,void(this.l=+n)):arguments.length<2?t instanceof se?new se(t.h,t.c,t.l):t instanceof ce?fe(t.l,t.a,t.b):fe((t=Ae((t=$o.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new se(t,e,n)}function ue(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new ce(n,Math.cos(t*=Fl)*e,Math.sin(t)*e)}function ce(t,e,n){return this instanceof ce?(this.l=+t,this.a=+e,void(this.b=+n)):arguments.length<2?t instanceof ce?new ce(t.l,t.a,t.b):t instanceof se?ue(t.h,t.c,t.l):Ae((t=ye(t)).r,t.g,t.b):new ce(t,e,n)}function de(t,e,n){var r=(t+16)/116,a=r+e/500,i=r-n/200;return a=he(a)*Gl,r=he(r)*jl,i=he(i)*Ul,new ye(ge(3.2404542*a-1.5371385*r-.4985314*i),ge(-.969266*a+1.8760108*r+.041556*i),ge(.0556434*a-.2040259*r+1.0572252*i))}function fe(t,e,n){return t>0?new se(Math.atan2(n,e)*Vl,Math.sqrt(e*e+n*n),t):new se(0/0,0/0,t)}function he(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function pe(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function ge(t){return Math.round(255*(.00304>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function ye(t,e,n){return this instanceof ye?(this.r=~~t,this.g=~~e,void(this.b=~~n)):arguments.length<2?t instanceof ye?new ye(t.r,t.g,t.b):be(""+t,ye,le):new ye(t,e,n)}function ve(t){return new ye(t>>16,255&t>>8,255&t)}function me(t){return ve(t)+""}function xe(t){return 16>t?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function be(t,e,n){var r,a,i,o=0,l=0,s=0;if(r=/([a-z]+)\((.*)\)/i.exec(t))switch(a=r[2].split(","),r[1]){case"hsl":return n(parseFloat(a[0]),parseFloat(a[1])/100,parseFloat(a[2])/100);case"rgb":return e(we(a[0]),we(a[1]),we(a[2]))}return(i=Wl.get(t))?e(i.r,i.g,i.b):(null==t||"#"!==t.charAt(0)||isNaN(i=parseInt(t.slice(1),16))||(4===t.length?(o=(3840&i)>>4,o=o>>4|o,l=240&i,l=l>>4|l,s=15&i,s=s<<4|s):7===t.length&&(o=(16711680&i)>>16,l=(65280&i)>>8,s=255&i)),e(o,l,s))}function ke(t,e,n){var r,a,i=Math.min(t/=255,e/=255,n/=255),o=Math.max(t,e,n),l=o-i,s=(o+i)/2;return l?(a=.5>s?l/(o+i):l/(2-o-i),r=t==o?(e-n)/l+(n>e?6:0):e==o?(n-t)/l+2:(t-e)/l+4,r*=60):(r=0/0,a=s>0&&1>s?0:r),new oe(r,a,s)}function Ae(t,e,n){t=Me(t),e=Me(e),n=Me(n);var r=pe((.4124564*t+.3575761*e+.1804375*n)/Gl),a=pe((.2126729*t+.7151522*e+.072175*n)/jl),i=pe((.0193339*t+.119192*e+.9503041*n)/Ul);return ce(116*a-16,500*(r-a),200*(a-i))}function Me(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function we(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function Ce(t){return"function"==typeof t?t:function(){return t}}function Se(t){return t}function Te(t){return function(e,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=null),Le(e,n,t,r)}}function Le(t,e,n,r){function a(){var t,e=s.status;if(!e&&Ne(s)||e>=200&&300>e||304===e){try{t=n.call(i,s)}catch(r){return void o.error.call(i,r)}o.load.call(i,t)}else o.error.call(i,s)}var i={},o=$o.dispatch("beforesend","progress","load","error"),l={},s=new XMLHttpRequest,u=null;return!tl.XDomainRequest||"withCredentials"in s||!/^(http(s)?:)?\/\//.test(t)||(s=new XDomainRequest),"onload"in s?s.onload=s.onerror=a:s.onreadystatechange=function(){s.readyState>3&&a()},s.onprogress=function(t){var e=$o.event;$o.event=t;try{o.progress.call(i,s)}finally{$o.event=e}},i.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?l[t]:(null==e?delete l[t]:l[t]=e+"",i)},i.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",i):e},i.responseType=function(t){return arguments.length?(u=t,i):u},i.response=function(t){return n=t,i},["get","post"].forEach(function(t){i[t]=function(){return i.send.apply(i,[t].concat(Zo(arguments)))}}),i.send=function(n,r,a){if(2===arguments.length&&"function"==typeof r&&(a=r,r=null),s.open(n,t,!0),null==e||"accept"in l||(l.accept=e+",*/*"),s.setRequestHeader)for(var c in l)s.setRequestHeader(c,l[c]);return null!=e&&s.overrideMimeType&&s.overrideMimeType(e),null!=u&&(s.responseType=u),null!=a&&i.on("error",a).on("load",function(t){a(null,t)}),o.beforesend.call(i,s),s.send(null==r?null:r),i},i.abort=function(){return s.abort(),i},$o.rebind(i,o,"on"),null==r?i:i.get(_e(r))}function _e(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}function Ne(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function De(){var t=Fe(),e=Ve()-t;e>24?(isFinite(e)&&(clearTimeout(Kl),Kl=setTimeout(De,e)),Zl=0):(Zl=1,ts(De))}function Fe(){var t=Date.now();for(Ql=$l;Ql;)t>=Ql.t&&(Ql.f=Ql.c(t-Ql.t)),Ql=Ql.n;return t}function Ve(){for(var t,e=$l,n=1/0;e;)e.f?e=t?t.n=e.n:$l=e.n:(e.t<n&&(n=e.t),e=(t=e).n);return Jl=t,n}function Ie(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function Pe(t,e){var n=Math.pow(10,3*ul(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}function ze(t){var e=t.decimal,n=t.thousands,r=t.grouping,a=t.currency,i=r&&n?function(t,e){for(var a=t.length,i=[],o=0,l=r[0],s=0;a>0&&l>0&&(s+l+1>e&&(l=Math.max(1,e-s)),i.push(t.substring(a-=l,a+l)),!((s+=l+1)>e));)l=r[o=(o+1)%r.length];return i.reverse().join(n)}:Se;return function(t){var n=ns.exec(t),r=n[1]||" ",o=n[2]||">",l=n[3]||"-",s=n[4]||"",u=n[5],c=+n[6],d=n[7],f=n[8],h=n[9],p=1,g="",y="",v=!1,m=!0;switch(f&&(f=+f.substring(1)),(u||"0"===r&&"="===o)&&(u=r="0",o="="),h){case"n":d=!0,h="g";break;case"%":p=100,y="%",h="f";break;case"p":p=100,y="%",h="r";break;case"b":case"o":case"x":case"X":"#"===s&&(g="0"+h.toLowerCase());case"c":m=!1;case"d":v=!0,f=0;break;case"s":p=-1,h="r"}"$"===s&&(g=a[0],y=a[1]),"r"!=h||f||(h="g"),null!=f&&("g"==h?f=Math.max(1,Math.min(21,f)):("e"==h||"f"==h)&&(f=Math.max(0,Math.min(20,f)))),h=rs.get(h)||Ee;var x=u&&d;return function(t){var n=y;if(v&&t%1)return"";var a=0>t||0===t&&0>1/t?(t=-t,"-"):"-"===l?"":l;if(0>p){var s=$o.formatPrefix(t,f);t=s.scale(t),n=s.symbol+y}else t*=p;t=h(t,f);var b,k,A=t.lastIndexOf(".");if(0>A){var M=m?t.lastIndexOf("e"):-1;0>M?(b=t,k=""):(b=t.substring(0,M),k=t.substring(M))}else b=t.substring(0,A),k=e+t.substring(A+1);!u&&d&&(b=i(b,1/0));var w=g.length+b.length+k.length+(x?0:a.length),C=c>w?new Array(w=c-w+1).join(r):"";return x&&(b=i(C+b,C.length?c-k.length:1/0)),a+=g,t=b+k,("<"===o?a+t+C:">"===o?C+a+t:"^"===o?C.substring(0,w>>=1)+a+t+C.substring(w):a+(x?t:C+t))+n}}}function Ee(t){return t+""}function Oe(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Re(t,e,n){function r(e){var n=t(e),r=i(n,1);return r-e>e-n?n:r}function a(n){return e(n=t(new is(n-1)),1),n}function i(t,n){return e(t=new is(+t),n),t}function o(t,r,i){var o=a(t),l=[];if(i>1)for(;r>o;)n(o)%i||l.push(new Date(+o)),e(o,1);else for(;r>o;)l.push(new Date(+o)),e(o,1);return l}function l(t,e,n){try{is=Oe;var r=new Oe;return r._=t,o(r,e,n)}finally{is=Date}}t.floor=t,t.round=r,t.ceil=a,t.offset=i,t.range=o;var s=t.utc=Be(t);return s.floor=s,s.round=Be(r),s.ceil=Be(a),s.offset=Be(i),s.range=l,t}function Be(t){return function(e,n){try{is=Oe;var r=new Oe;return r._=e,t(r,n)._}finally{is=Date}}}function Ye(t){function e(t){function e(e){for(var n,a,i,o=[],l=-1,s=0;++l<r;)37===t.charCodeAt(l)&&(o.push(t.slice(s,l)),null!=(a=ls[n=t.charAt(++l)])&&(n=t.charAt(++l)),(i=L[n])&&(n=i(e,null==a?"e"===n?" ":"0":a)),o.push(n),s=l+1);return o.push(t.slice(s,l)),o.join("")}var r=t.length;return e.parse=function(e){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},a=n(r,t,e,0);if(a!=e.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var i=null!=r.Z&&is!==Oe,o=new(i?Oe:is);return"j"in r?o.setFullYear(r.y,0,r.j):"w"in r&&("W"in r||"U"in r)?(o.setFullYear(r.y,0,1),o.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(o.getDay()+5)%7:r.w+7*r.U-(o.getDay()+6)%7)):o.setFullYear(r.y,r.m,r.d),o.setHours(r.H+(0|r.Z/100),r.M+r.Z%100,r.S,r.L),i?o._:o},e.toString=function(){return t},e}function n(t,e,n,r){for(var a,i,o,l=0,s=e.length,u=n.length;s>l;){if(r>=u)return-1;if(a=e.charCodeAt(l++),37===a){if(o=e.charAt(l++),i=_[o in ls?e.charAt(l++):o],!i||(r=i(t,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}function r(t,e,n){A.lastIndex=0;var r=A.exec(e.slice(n));return r?(t.w=M.get(r[0].toLowerCase()),n+r[0].length):-1}function a(t,e,n){b.lastIndex=0;var r=b.exec(e.slice(n));return r?(t.w=k.get(r[0].toLowerCase()),n+r[0].length):-1}function i(t,e,n){S.lastIndex=0;var r=S.exec(e.slice(n));return r?(t.m=T.get(r[0].toLowerCase()),n+r[0].length):-1}function o(t,e,n){w.lastIndex=0;var r=w.exec(e.slice(n));return r?(t.m=C.get(r[0].toLowerCase()),n+r[0].length):-1}function l(t,e,r){return n(t,L.c.toString(),e,r)}function s(t,e,r){return n(t,L.x.toString(),e,r)}function u(t,e,r){return n(t,L.X.toString(),e,r)}function c(t,e,n){var r=x.get(e.slice(n,n+=2).toLowerCase());return null==r?-1:(t.p=r,n)}var d=t.dateTime,f=t.date,h=t.time,p=t.periods,g=t.days,y=t.shortDays,v=t.months,m=t.shortMonths;e.utc=function(t){function n(t){try{is=Oe;var e=new is;return e._=t,r(e)}finally{is=Date}}var r=e(t);return n.parse=function(t){try{is=Oe;var e=r.parse(t);return e&&e._}finally{is=Date}},n.toString=r.toString,n},e.multi=e.utc.multi=sn;var x=$o.map(),b=Ge(g),k=je(g),A=Ge(y),M=je(y),w=Ge(v),C=je(v),S=Ge(m),T=je(m);p.forEach(function(t,e){x.set(t.toLowerCase(),e)});var L={a:function(t){return y[t.getDay()]},A:function(t){return g[t.getDay()]},b:function(t){return m[t.getMonth()]},B:function(t){return v[t.getMonth()]},c:e(d),d:function(t,e){return qe(t.getDate(),e,2)},e:function(t,e){return qe(t.getDate(),e,2)},H:function(t,e){return qe(t.getHours(),e,2)},I:function(t,e){return qe(t.getHours()%12||12,e,2)},j:function(t,e){return qe(1+as.dayOfYear(t),e,3)},L:function(t,e){return qe(t.getMilliseconds(),e,3)},m:function(t,e){return qe(t.getMonth()+1,e,2)},M:function(t,e){return qe(t.getMinutes(),e,2)},p:function(t){return p[+(t.getHours()>=12)]},S:function(t,e){return qe(t.getSeconds(),e,2)},U:function(t,e){return qe(as.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return qe(as.mondayOfYear(t),e,2)},x:e(f),X:e(h),y:function(t,e){return qe(t.getFullYear()%100,e,2)},Y:function(t,e){return qe(t.getFullYear()%1e4,e,4)},Z:on,"%":function(){return"%"}},_={a:r,A:a,b:i,B:o,c:l,d:Qe,e:Qe,H:en,I:en,j:tn,L:an,m:Ke,M:nn,p:c,S:rn,U:He,w:Ue,W:Xe,x:s,X:u,y:$e,Y:We,Z:Je,"%":ln};return e}function qe(t,e,n){var r=0>t?"-":"",a=(r?-t:t)+"",i=a.length;return r+(n>i?new Array(n-i+1).join(e)+a:a)}function Ge(t){return new RegExp("^(?:"+t.map($o.requote).join("|")+")","i")}function je(t){for(var e=new l,n=-1,r=t.length;++n<r;)e.set(t[n].toLowerCase(),n);return e}function Ue(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function He(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n));return r?(t.U=+r[0],n+r[0].length):-1}function Xe(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n));return r?(t.W=+r[0],n+r[0].length):-1}function We(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function $e(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+2));return r?(t.y=Ze(+r[0]),n+r[0].length):-1}function Je(t,e,n){return/^[+-]\d{4}$/.test(e=e.slice(n,n+5))?(t.Z=-e,n+5):-1}function Ze(t){return t+(t>68?1900:2e3)}function Ke(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Qe(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function tn(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+3));return r?(t.j=+r[0],n+r[0].length):-1}function en(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function nn(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function rn(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function an(t,e,n){ss.lastIndex=0;var r=ss.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function on(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",r=0|ul(e)/60,a=ul(e)%60;return n+qe(r,"0",2)+qe(a,"0",2)}function ln(t,e,n){us.lastIndex=0;var r=us.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function sn(t){for(var e=t.length,n=-1;++n<e;)t[n][0]=this(t[n][0]);return function(e){for(var n=0,r=t[n];!r[1](e);)r=t[++n];return r[0](e)}}function un(){}function cn(t,e,n){var r=n.s=t+e,a=r-t,i=r-a;n.t=t-i+(e-a)}function dn(t,e){t&&hs.hasOwnProperty(t.type)&&hs[t.type](t,e)}function fn(t,e,n){var r,a=-1,i=t.length-n;for(e.lineStart();++a<i;)r=t[a],e.point(r[0],r[1],r[2]);e.lineEnd()}function hn(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)fn(t[n],e,1);e.polygonEnd()}function pn(){function t(t,e){t*=Fl,e=e*Fl/2+Tl/4;var n=t-r,o=n>=0?1:-1,l=o*n,s=Math.cos(e),u=Math.sin(e),c=i*u,d=a*s+c*Math.cos(l),f=c*o*Math.sin(l);gs.add(Math.atan2(f,d)),r=t,a=s,i=u}var e,n,r,a,i;ys.point=function(o,l){ys.point=t,r=(e=o)*Fl,a=Math.cos(l=(n=l)*Fl/2+Tl/4),i=Math.sin(l)},ys.lineEnd=function(){t(e,n)}}function gn(t){var e=t[0],n=t[1],r=Math.cos(n);return[r*Math.cos(e),r*Math.sin(e),Math.sin(n)]}function yn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function vn(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function mn(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function xn(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function bn(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function kn(t){return[Math.atan2(t[1],t[0]),te(t[2])]}function An(t,e){return ul(t[0]-e[0])<Nl&&ul(t[1]-e[1])<Nl}function Mn(t,e){t*=Fl;var n=Math.cos(e*=Fl);wn(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function wn(t,e,n){++vs,xs+=(t-xs)/vs,bs+=(e-bs)/vs,ks+=(n-ks)/vs}function Cn(){function t(t,a){t*=Fl;var i=Math.cos(a*=Fl),o=i*Math.cos(t),l=i*Math.sin(t),s=Math.sin(a),u=Math.atan2(Math.sqrt((u=n*s-r*l)*u+(u=r*o-e*s)*u+(u=e*l-n*o)*u),e*o+n*l+r*s);ms+=u,As+=u*(e+(e=o)),Ms+=u*(n+(n=l)),ws+=u*(r+(r=s)),wn(e,n,r)}var e,n,r;Ls.point=function(a,i){a*=Fl;var o=Math.cos(i*=Fl);e=o*Math.cos(a),n=o*Math.sin(a),r=Math.sin(i),Ls.point=t,wn(e,n,r)}}function Sn(){Ls.point=Mn}function Tn(){function t(t,e){t*=Fl;var n=Math.cos(e*=Fl),o=n*Math.cos(t),l=n*Math.sin(t),s=Math.sin(e),u=a*s-i*l,c=i*o-r*s,d=r*l-a*o,f=Math.sqrt(u*u+c*c+d*d),h=r*o+a*l+i*s,p=f&&-Q(h)/f,g=Math.atan2(f,h);Cs+=p*u,Ss+=p*c,Ts+=p*d,ms+=g,As+=g*(r+(r=o)),Ms+=g*(a+(a=l)),ws+=g*(i+(i=s)),wn(r,a,i)}var e,n,r,a,i;Ls.point=function(o,l){e=o,n=l,Ls.point=t,o*=Fl;var s=Math.cos(l*=Fl);r=s*Math.cos(o),a=s*Math.sin(o),i=Math.sin(l),wn(r,a,i)},Ls.lineEnd=function(){t(e,n),Ls.lineEnd=Sn,Ls.point=Mn}}function Ln(){return!0}function _n(t,e,n,r,a){var i=[],o=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],r=t[e];if(An(n,r)){a.lineStart();for(var l=0;e>l;++l)a.point((n=t[l])[0],n[1]);return void a.lineEnd()}var s=new Dn(n,t,null,!0),u=new Dn(n,null,s,!1);s.o=u,i.push(s),o.push(u),s=new Dn(r,t,null,!1),u=new Dn(r,null,s,!0),s.o=u,i.push(s),o.push(u)}}),o.sort(e),Nn(i),Nn(o),i.length){for(var l=0,s=n,u=o.length;u>l;++l)o[l].e=s=!s;for(var c,d,f=i[0];;){for(var h=f,p=!0;h.v;)if((h=h.n)===f)return;c=h.z,a.lineStart();do{if(h.v=h.o.v=!0,h.e){if(p)for(var l=0,u=c.length;u>l;++l)a.point((d=c[l])[0],d[1]);else r(h.x,h.n.x,1,a);h=h.n}else{if(p){c=h.p.z;for(var l=c.length-1;l>=0;--l)a.point((d=c[l])[0],d[1])}else r(h.x,h.p.x,-1,a);h=h.p}h=h.o,c=h.z,p=!p}while(!h.v);a.lineEnd()}}}function Nn(t){if(e=t.length){for(var e,n,r=0,a=t[0];++r<e;)a.n=n=t[r],n.p=a,a=n;a.n=n=t[0],n.p=a}}function Dn(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Fn(t,e,n,r){return function(a,i){function o(e,n){var r=a(e,n);t(e=r[0],n=r[1])&&i.point(e,n)}function l(t,e){var n=a(t,e);y.point(n[0],n[1])}function s(){m.point=l,y.lineStart()}function u(){m.point=o,y.lineEnd()}function c(t,e){g.push([t,e]);var n=a(t,e);b.point(n[0],n[1])}function d(){b.lineStart(),g=[]}function f(){c(g[0][0],g[0][1]),b.lineEnd();var t,e=b.clean(),n=x.buffer(),r=n.length;if(g.pop(),p.push(g),g=null,r)if(1&e){t=n[0];var a,r=t.length-1,o=-1;if(r>0){for(k||(i.polygonStart(),k=!0),i.lineStart();++o<r;)i.point((a=t[o])[0],a[1]);i.lineEnd()}}else r>1&&2&e&&n.push(n.pop().concat(n.shift())),h.push(n.filter(Vn))}var h,p,g,y=e(i),v=a.invert(r[0],r[1]),m={point:o,lineStart:s,lineEnd:u,polygonStart:function(){m.point=c,m.lineStart=d,m.lineEnd=f,h=[],p=[]},polygonEnd:function(){m.point=o,m.lineStart=s,m.lineEnd=u,h=$o.merge(h);var t=Rn(v,p);h.length?(k||(i.polygonStart(),k=!0),_n(h,Pn,t,n,i)):t&&(k||(i.polygonStart(),k=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),k&&(i.polygonEnd(),k=!1),h=p=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}},x=In(),b=e(x),k=!1;return m}}function Vn(t){return t.length>1}function In(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:m,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function Pn(t,e){return((t=t.x)[0]<0?t[1]-_l-Nl:_l-t[1])-((e=e.x)[0]<0?e[1]-_l-Nl:_l-e[1])}function zn(t){var e,n=0/0,r=0/0,a=0/0;return{lineStart:function(){t.lineStart(),e=1},point:function(i,o){var l=i>0?Tl:-Tl,s=ul(i-n);ul(s-Tl)<Nl?(t.point(n,r=(r+o)/2>0?_l:-_l),t.point(a,r),t.lineEnd(),t.lineStart(),t.point(l,r),t.point(i,r),e=0):a!==l&&s>=Tl&&(ul(n-a)<Nl&&(n-=a*Nl),ul(i-l)<Nl&&(i-=l*Nl),r=En(n,r,i,o),t.point(a,r),t.lineEnd(),t.lineStart(),t.point(l,r),e=0),t.point(n=i,r=o),a=l},lineEnd:function(){t.lineEnd(),n=r=0/0},clean:function(){return 2-e}}}function En(t,e,n,r){var a,i,o=Math.sin(t-n);return ul(o)>Nl?Math.atan((Math.sin(e)*(i=Math.cos(r))*Math.sin(n)-Math.sin(r)*(a=Math.cos(e))*Math.sin(t))/(a*i*o)):(e+r)/2}function On(t,e,n,r){var a;if(null==t)a=n*_l,r.point(-Tl,a),r.point(0,a),r.point(Tl,a),r.point(Tl,0),r.point(Tl,-a),r.point(0,-a),r.point(-Tl,-a),r.point(-Tl,0),r.point(-Tl,a);else if(ul(t[0]-e[0])>Nl){var i=t[0]<e[0]?Tl:-Tl;a=n*i/2,r.point(-i,a),r.point(0,a),r.point(i,a)}else r.point(e[0],e[1])}function Rn(t,e){var n=t[0],r=t[1],a=[Math.sin(n),-Math.cos(n),0],i=0,o=0;gs.reset();for(var l=0,s=e.length;s>l;++l){var u=e[l],c=u.length;if(c)for(var d=u[0],f=d[0],h=d[1]/2+Tl/4,p=Math.sin(h),g=Math.cos(h),y=1;;){y===c&&(y=0),t=u[y];var v=t[0],m=t[1]/2+Tl/4,x=Math.sin(m),b=Math.cos(m),k=v-f,A=k>=0?1:-1,M=A*k,w=M>Tl,C=p*x;if(gs.add(Math.atan2(C*A*Math.sin(M),g*b+C*Math.cos(M))),i+=w?k+A*Ll:k,w^f>=n^v>=n){var S=vn(gn(d),gn(t));bn(S);var T=vn(a,S);bn(T);var L=(w^k>=0?-1:1)*te(T[2]);(r>L||r===L&&(S[0]||S[1]))&&(o+=w^k>=0?1:-1)}if(!y++)break;f=v,p=x,g=b,d=t}}return(-Nl>i||Nl>i&&0>gs)^1&o}function Bn(t){function e(t,e){return Math.cos(t)*Math.cos(e)>i}function n(t){var n,i,s,u,c;return{lineStart:function(){u=s=!1,c=1},point:function(d,f){var h,p=[d,f],g=e(d,f),y=o?g?0:a(d,f):g?a(d+(0>d?Tl:-Tl),f):0;if(!n&&(u=s=g)&&t.lineStart(),g!==s&&(h=r(n,p),(An(n,h)||An(p,h))&&(p[0]+=Nl,p[1]+=Nl,g=e(p[0],p[1]))),g!==s)c=0,g?(t.lineStart(),h=r(p,n),t.point(h[0],h[1])):(h=r(n,p),t.point(h[0],h[1]),t.lineEnd()),n=h;else if(l&&n&&o^g){var v;y&i||!(v=r(p,n,!0))||(c=0,o?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1])))}!g||n&&An(n,p)||t.point(p[0],p[1]),n=p,s=g,i=y},lineEnd:function(){s&&t.lineEnd(),n=null},clean:function(){return c|(u&&s)<<1}}}function r(t,e,n){var r=gn(t),a=gn(e),o=[1,0,0],l=vn(r,a),s=yn(l,l),u=l[0],c=s-u*u;if(!c)return!n&&t;var d=i*s/c,f=-i*u/c,h=vn(o,l),p=xn(o,d),g=xn(l,f);mn(p,g);var y=h,v=yn(p,y),m=yn(y,y),x=v*v-m*(yn(p,p)-1);if(!(0>x)){var b=Math.sqrt(x),k=xn(y,(-v-b)/m);if(mn(k,p),k=kn(k),!n)return k;var A,M=t[0],w=e[0],C=t[1],S=e[1];M>w&&(A=M,M=w,w=A);var T=w-M,L=ul(T-Tl)<Nl,_=L||Nl>T;if(!L&&C>S&&(A=C,C=S,S=A),_?L?C+S>0^k[1]<(ul(k[0]-M)<Nl?C:S):C<=k[1]&&k[1]<=S:T>Tl^(M<=k[0]&&k[0]<=w)){var N=xn(y,(-v+b)/m);return mn(N,p),[k,kn(N)]}}}function a(e,n){var r=o?t:Tl-t,a=0;return-r>e?a|=1:e>r&&(a|=2),-r>n?a|=4:n>r&&(a|=8),a}var i=Math.cos(t),o=i>0,l=ul(i)>Nl,s=pr(t,6*Fl);return Fn(e,n,s,o?[0,-t]:[-Tl,t-Tl])}function Yn(t,e,n,r){return function(a){var i,o=a.a,l=a.b,s=o.x,u=o.y,c=l.x,d=l.y,f=0,h=1,p=c-s,g=d-u;if(i=t-s,p||!(i>0)){if(i/=p,0>p){if(f>i)return;h>i&&(h=i)}else if(p>0){if(i>h)return;i>f&&(f=i)}if(i=n-s,p||!(0>i)){if(i/=p,0>p){if(i>h)return;i>f&&(f=i)}else if(p>0){if(f>i)return;h>i&&(h=i)}if(i=e-u,g||!(i>0)){if(i/=g,0>g){if(f>i)return;h>i&&(h=i)}else if(g>0){if(i>h)return;i>f&&(f=i)}if(i=r-u,g||!(0>i)){if(i/=g,0>g){if(i>h)return;i>f&&(f=i)}else if(g>0){if(f>i)return;h>i&&(h=i)}return f>0&&(a.a={x:s+f*p,y:u+f*g}),1>h&&(a.b={x:s+h*p,y:u+h*g}),a}}}}}}function qn(t,e,n,r){function a(r,a){return ul(r[0]-t)<Nl?a>0?0:3:ul(r[0]-n)<Nl?a>0?2:1:ul(r[1]-e)<Nl?a>0?1:0:a>0?3:2}function i(t,e){return o(t.x,e.x)}function o(t,e){var n=a(t,1),r=a(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(l){function s(t){for(var e=0,n=y.length,r=t[1],a=0;n>a;++a)for(var i,o=1,l=y[a],s=l.length,u=l[0];s>o;++o)i=l[o],u[1]<=r?i[1]>r&&K(u,i,t)>0&&++e:i[1]<=r&&K(u,i,t)<0&&--e,u=i;return 0!==e}function u(i,l,s,u){var c=0,d=0;if(null==i||(c=a(i,s))!==(d=a(l,s))||o(i,l)<0^s>0){do u.point(0===c||3===c?t:n,c>1?r:e);while((c=(c+s+4)%4)!==d)}else u.point(l[0],l[1])}function c(a,i){return a>=t&&n>=a&&i>=e&&r>=i}function d(t,e){c(t,e)&&l.point(t,e)}function f(){_.point=p,y&&y.push(v=[]),w=!0,M=!1,k=A=0/0}function h(){g&&(p(m,x),b&&M&&T.rejoin(),g.push(T.buffer())),_.point=d,M&&l.lineEnd()}function p(t,e){t=Math.max(-Ns,Math.min(Ns,t)),e=Math.max(-Ns,Math.min(Ns,e));var n=c(t,e);if(y&&v.push([t,e]),w)m=t,x=e,b=n,w=!1,n&&(l.lineStart(),l.point(t,e));else if(n&&M)l.point(t,e);else{var r={a:{x:k,y:A},b:{x:t,y:e}};L(r)?(M||(l.lineStart(),l.point(r.a.x,r.a.y)),l.point(r.b.x,r.b.y),n||l.lineEnd(),C=!1):n&&(l.lineStart(),l.point(t,e),C=!1)}k=t,A=e,M=n}var g,y,v,m,x,b,k,A,M,w,C,S=l,T=In(),L=Yn(t,e,n,r),_={point:d,lineStart:f,lineEnd:h,polygonStart:function(){l=T,g=[],y=[],C=!0},polygonEnd:function(){l=S,g=$o.merge(g);var e=s([t,r]),n=C&&e,a=g.length;(n||a)&&(l.polygonStart(),n&&(l.lineStart(),u(null,null,1,l),l.lineEnd()),a&&_n(g,i,e,u,l),l.polygonEnd()),g=y=v=null}};return _}}function Gn(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return n=e.invert(n,r),n&&t.invert(n[0],n[1])}),n}function jn(t){var e=0,n=Tl/3,r=or(t),a=r(e,n);return a.parallels=function(t){return arguments.length?r(e=t[0]*Tl/180,n=t[1]*Tl/180):[180*(e/Tl),180*(n/Tl)]},a}function Un(t,e){function n(t,e){var n=Math.sqrt(i-2*a*Math.sin(e))/a;return[n*Math.sin(t*=a),o-n*Math.cos(t)]}var r=Math.sin(t),a=(r+Math.sin(e))/2,i=1+r*(2*a-r),o=Math.sqrt(i)/a;return n.invert=function(t,e){var n=o-e;return[Math.atan2(t,n)/a,te((i-(t*t+n*n)*a*a)/(2*a))]},n}function Hn(){function t(t,e){Fs+=a*t-r*e,r=t,a=e}var e,n,r,a;Es.point=function(i,o){Es.point=t,e=r=i,n=a=o},Es.lineEnd=function(){t(e,n)}}function Xn(t,e){Vs>t&&(Vs=t),t>Ps&&(Ps=t),Is>e&&(Is=e),e>zs&&(zs=e)}function Wn(){function t(t,e){o.push("M",t,",",e,i)}function e(t,e){o.push("M",t,",",e),l.point=n}function n(t,e){o.push("L",t,",",e)}function r(){l.point=t}function a(){o.push("Z")}var i=$n(4.5),o=[],l={point:t,lineStart:function(){l.point=e},lineEnd:r,polygonStart:function(){l.lineEnd=a},polygonEnd:function(){l.lineEnd=r,l.point=t},pointRadius:function(t){return i=$n(t),l},result:function(){if(o.length){var t=o.join("");return o=[],t}}};return l}function $n(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Jn(t,e){xs+=t,bs+=e,++ks}function Zn(){function t(t,r){var a=t-e,i=r-n,o=Math.sqrt(a*a+i*i);As+=o*(e+t)/2,Ms+=o*(n+r)/2,ws+=o,Jn(e=t,n=r)}var e,n;Rs.point=function(r,a){Rs.point=t,Jn(e=r,n=a)}}function Kn(){Rs.point=Jn}function Qn(){function t(t,e){var n=t-r,i=e-a,o=Math.sqrt(n*n+i*i);As+=o*(r+t)/2,Ms+=o*(a+e)/2,ws+=o,o=a*t-r*e,Cs+=o*(r+t),Ss+=o*(a+e),Ts+=3*o,Jn(r=t,a=e)}var e,n,r,a;Rs.point=function(i,o){Rs.point=t,Jn(e=r=i,n=a=o)},Rs.lineEnd=function(){t(e,n)}}function tr(t){function e(e,n){t.moveTo(e,n),t.arc(e,n,o,0,Ll)}function n(e,n){t.moveTo(e,n),l.point=r}function r(e,n){t.lineTo(e,n)}function a(){l.point=e}function i(){t.closePath()}var o=4.5,l={point:e,lineStart:function(){l.point=n},lineEnd:a,polygonStart:function(){l.lineEnd=i},polygonEnd:function(){l.lineEnd=a,l.point=e},pointRadius:function(t){return o=t,l},result:m};return l}function er(t){function e(t){return(l?r:n)(t)}function n(e){return ar(e,function(n,r){n=t(n,r),e.point(n[0],n[1])})}function r(e){function n(n,r){n=t(n,r),e.point(n[0],n[1])
}function r(){x=0/0,w.point=i,e.lineStart()}function i(n,r){var i=gn([n,r]),o=t(n,r);a(x,b,m,k,A,M,x=o[0],b=o[1],m=n,k=i[0],A=i[1],M=i[2],l,e),e.point(x,b)}function o(){w.point=n,e.lineEnd()}function s(){r(),w.point=u,w.lineEnd=c}function u(t,e){i(d=t,f=e),h=x,p=b,g=k,y=A,v=M,w.point=i}function c(){a(x,b,m,k,A,M,h,p,d,g,y,v,l,e),w.lineEnd=o,o()}var d,f,h,p,g,y,v,m,x,b,k,A,M,w={point:n,lineStart:r,lineEnd:o,polygonStart:function(){e.polygonStart(),w.lineStart=s},polygonEnd:function(){e.polygonEnd(),w.lineStart=r}};return w}function a(e,n,r,l,s,u,c,d,f,h,p,g,y,v){var m=c-e,x=d-n,b=m*m+x*x;if(b>4*i&&y--){var k=l+h,A=s+p,M=u+g,w=Math.sqrt(k*k+A*A+M*M),C=Math.asin(M/=w),S=ul(ul(M)-1)<Nl||ul(r-f)<Nl?(r+f)/2:Math.atan2(A,k),T=t(S,C),L=T[0],_=T[1],N=L-e,D=_-n,F=x*N-m*D;(F*F/b>i||ul((m*N+x*D)/b-.5)>.3||o>l*h+s*p+u*g)&&(a(e,n,r,l,s,u,L,_,S,k/=w,A/=w,M,y,v),v.point(L,_),a(L,_,S,k,A,M,c,d,f,h,p,g,y,v))}}var i=.5,o=Math.cos(30*Fl),l=16;return e.precision=function(t){return arguments.length?(l=(i=t*t)>0&&16,e):Math.sqrt(i)},e}function nr(t){var e=er(function(e,n){return t([e*Vl,n*Vl])});return function(t){return lr(e(t))}}function rr(t){this.stream=t}function ar(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function ir(t){return or(function(){return t})()}function or(t){function e(t){return t=l(t[0]*Fl,t[1]*Fl),[t[0]*f+s,u-t[1]*f]}function n(t){return t=l.invert((t[0]-s)/f,(u-t[1])/f),t&&[t[0]*Vl,t[1]*Vl]}function r(){l=Gn(o=cr(v,m,x),i);var t=i(g,y);return s=h-t[0]*f,u=p+t[1]*f,a()}function a(){return c&&(c.valid=!1,c=null),e}var i,o,l,s,u,c,d=er(function(t,e){return t=i(t,e),[t[0]*f+s,u-t[1]*f]}),f=150,h=480,p=250,g=0,y=0,v=0,m=0,x=0,b=_s,k=Se,A=null,M=null;return e.stream=function(t){return c&&(c.valid=!1),c=lr(b(o,d(k(t)))),c.valid=!0,c},e.clipAngle=function(t){return arguments.length?(b=null==t?(A=t,_s):Bn((A=+t)*Fl),a()):A},e.clipExtent=function(t){return arguments.length?(M=t,k=t?qn(t[0][0],t[0][1],t[1][0],t[1][1]):Se,a()):M},e.scale=function(t){return arguments.length?(f=+t,r()):f},e.translate=function(t){return arguments.length?(h=+t[0],p=+t[1],r()):[h,p]},e.center=function(t){return arguments.length?(g=t[0]%360*Fl,y=t[1]%360*Fl,r()):[g*Vl,y*Vl]},e.rotate=function(t){return arguments.length?(v=t[0]%360*Fl,m=t[1]%360*Fl,x=t.length>2?t[2]%360*Fl:0,r()):[v*Vl,m*Vl,x*Vl]},$o.rebind(e,d,"precision"),function(){return i=t.apply(this,arguments),e.invert=i.invert&&n,r()}}function lr(t){return ar(t,function(e,n){t.point(e*Fl,n*Fl)})}function sr(t,e){return[t,e]}function ur(t,e){return[t>Tl?t-Ll:-Tl>t?t+Ll:t,e]}function cr(t,e,n){return t?e||n?Gn(fr(t),hr(e,n)):fr(t):e||n?hr(e,n):ur}function dr(t){return function(e,n){return e+=t,[e>Tl?e-Ll:-Tl>e?e+Ll:e,n]}}function fr(t){var e=dr(t);return e.invert=dr(-t),e}function hr(t,e){function n(t,e){var n=Math.cos(e),l=Math.cos(t)*n,s=Math.sin(t)*n,u=Math.sin(e),c=u*r+l*a;return[Math.atan2(s*i-c*o,l*r-u*a),te(c*i+s*o)]}var r=Math.cos(t),a=Math.sin(t),i=Math.cos(e),o=Math.sin(e);return n.invert=function(t,e){var n=Math.cos(e),l=Math.cos(t)*n,s=Math.sin(t)*n,u=Math.sin(e),c=u*i-s*o;return[Math.atan2(s*i+u*o,l*r+c*a),te(c*r-l*a)]},n}function pr(t,e){var n=Math.cos(t),r=Math.sin(t);return function(a,i,o,l){var s=o*e;null!=a?(a=gr(n,a),i=gr(n,i),(o>0?i>a:a>i)&&(a+=o*Ll)):(a=t+o*Ll,i=t-.5*s);for(var u,c=a;o>0?c>i:i>c;c-=s)l.point((u=kn([n,-r*Math.cos(c),-r*Math.sin(c)]))[0],u[1])}}function gr(t,e){var n=gn(e);n[0]-=t,bn(n);var r=Q(-n[1]);return((-n[2]<0?-r:r)+2*Math.PI-Nl)%(2*Math.PI)}function yr(t,e,n){var r=$o.range(t,e-Nl,n).concat(e);return function(t){return r.map(function(e){return[t,e]})}}function vr(t,e,n){var r=$o.range(t,e-Nl,n).concat(e);return function(t){return r.map(function(e){return[e,t]})}}function mr(t){return t.source}function xr(t){return t.target}function br(t,e,n,r){var a=Math.cos(e),i=Math.sin(e),o=Math.cos(r),l=Math.sin(r),s=a*Math.cos(t),u=a*Math.sin(t),c=o*Math.cos(n),d=o*Math.sin(n),f=2*Math.asin(Math.sqrt(ae(r-e)+a*o*ae(n-t))),h=1/Math.sin(f),p=f?function(t){var e=Math.sin(t*=f)*h,n=Math.sin(f-t)*h,r=n*s+e*c,a=n*u+e*d,o=n*i+e*l;return[Math.atan2(a,r)*Vl,Math.atan2(o,Math.sqrt(r*r+a*a))*Vl]}:function(){return[t*Vl,e*Vl]};return p.distance=f,p}function kr(){function t(t,a){var i=Math.sin(a*=Fl),o=Math.cos(a),l=ul((t*=Fl)-e),s=Math.cos(l);Bs+=Math.atan2(Math.sqrt((l=o*Math.sin(l))*l+(l=r*i-n*o*s)*l),n*i+r*o*s),e=t,n=i,r=o}var e,n,r;Ys.point=function(a,i){e=a*Fl,n=Math.sin(i*=Fl),r=Math.cos(i),Ys.point=t},Ys.lineEnd=function(){Ys.point=Ys.lineEnd=m}}function Ar(t,e){function n(e,n){var r=Math.cos(e),a=Math.cos(n),i=t(r*a);return[i*a*Math.sin(e),i*Math.sin(n)]}return n.invert=function(t,n){var r=Math.sqrt(t*t+n*n),a=e(r),i=Math.sin(a),o=Math.cos(a);return[Math.atan2(t*i,r*o),Math.asin(r&&n*i/r)]},n}function Mr(t,e){function n(t,e){o>0?-_l+Nl>e&&(e=-_l+Nl):e>_l-Nl&&(e=_l-Nl);var n=o/Math.pow(a(e),i);return[n*Math.sin(i*t),o-n*Math.cos(i*t)]}var r=Math.cos(t),a=function(t){return Math.tan(Tl/4+t/2)},i=t===e?Math.sin(t):Math.log(r/Math.cos(e))/Math.log(a(e)/a(t)),o=r*Math.pow(a(t),i)/i;return i?(n.invert=function(t,e){var n=o-e,r=Z(i)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/i,2*Math.atan(Math.pow(o/r,1/i))-_l]},n):Cr}function wr(t,e){function n(t,e){var n=i-e;return[n*Math.sin(a*t),i-n*Math.cos(a*t)]}var r=Math.cos(t),a=t===e?Math.sin(t):(r-Math.cos(e))/(e-t),i=r/a+t;return ul(a)<Nl?sr:(n.invert=function(t,e){var n=i-e;return[Math.atan2(t,n)/a,i-Z(a)*Math.sqrt(t*t+n*n)]},n)}function Cr(t,e){return[t,Math.log(Math.tan(Tl/4+e/2))]}function Sr(t){var e,n=ir(t),r=n.scale,a=n.translate,i=n.clipExtent;return n.scale=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=a.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var o=i.apply(n,arguments);if(o===n){if(e=null==t){var l=Tl*r(),s=a();i([[s[0]-l,s[1]-l],[s[0]+l,s[1]+l]])}}else e&&(o=null);return o},n.clipExtent(null)}function Tr(t,e){return[Math.log(Math.tan(Tl/4+e/2)),-t]}function Lr(t){return t[0]}function _r(t){return t[1]}function Nr(t){for(var e=t.length,n=[0,1],r=2,a=2;e>a;a++){for(;r>1&&K(t[n[r-2]],t[n[r-1]],t[a])<=0;)--r;n[r++]=a}return n.slice(0,r)}function Dr(t,e){return t[0]-e[0]||t[1]-e[1]}function Fr(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function Vr(t,e,n,r){var a=t[0],i=n[0],o=e[0]-a,l=r[0]-i,s=t[1],u=n[1],c=e[1]-s,d=r[1]-u,f=(l*(s-u)-d*(a-i))/(d*o-l*c);return[a+f*o,s+f*c]}function Ir(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}function Pr(){na(this),this.edge=this.site=this.circle=null}function zr(t){var e=Qs.pop()||new Pr;return e.site=t,e}function Er(t){Xr(t),Js.remove(t),Qs.push(t),na(t)}function Or(t){var e=t.circle,n=e.x,r=e.cy,a={x:n,y:r},i=t.P,o=t.N,l=[t];Er(t);for(var s=i;s.circle&&ul(n-s.circle.x)<Nl&&ul(r-s.circle.cy)<Nl;)i=s.P,l.unshift(s),Er(s),s=i;l.unshift(s),Xr(s);for(var u=o;u.circle&&ul(n-u.circle.x)<Nl&&ul(r-u.circle.cy)<Nl;)o=u.N,l.push(u),Er(u),u=o;l.push(u),Xr(u);var c,d=l.length;for(c=1;d>c;++c)u=l[c],s=l[c-1],Qr(u.edge,s.site,u.site,a);s=l[0],u=l[d-1],u.edge=Zr(s.site,u.site,null,a),Hr(s),Hr(u)}function Rr(t){for(var e,n,r,a,i=t.x,o=t.y,l=Js._;l;)if(r=Br(l,o)-i,r>Nl)l=l.L;else{if(a=i-Yr(l,o),!(a>Nl)){r>-Nl?(e=l.P,n=l):a>-Nl?(e=l,n=l.N):e=n=l;break}if(!l.R){e=l;break}l=l.R}var s=zr(t);if(Js.insert(e,s),e||n){if(e===n)return Xr(e),n=zr(e.site),Js.insert(s,n),s.edge=n.edge=Zr(e.site,s.site),Hr(e),void Hr(n);if(!n)return void(s.edge=Zr(e.site,s.site));Xr(e),Xr(n);var u=e.site,c=u.x,d=u.y,f=t.x-c,h=t.y-d,p=n.site,g=p.x-c,y=p.y-d,v=2*(f*y-h*g),m=f*f+h*h,x=g*g+y*y,b={x:(y*m-h*x)/v+c,y:(f*x-g*m)/v+d};Qr(n.edge,u,p,b),s.edge=Zr(u,t,null,b),n.edge=Zr(t,p,null,b),Hr(e),Hr(n)}}function Br(t,e){var n=t.site,r=n.x,a=n.y,i=a-e;if(!i)return r;var o=t.P;if(!o)return-1/0;n=o.site;var l=n.x,s=n.y,u=s-e;if(!u)return l;var c=l-r,d=1/i-1/u,f=c/u;return d?(-f+Math.sqrt(f*f-2*d*(c*c/(-2*u)-s+u/2+a-i/2)))/d+r:(r+l)/2}function Yr(t,e){var n=t.N;if(n)return Br(n,e);var r=t.site;return r.y===e?r.x:1/0}function qr(t){this.site=t,this.edges=[]}function Gr(t){for(var e,n,r,a,i,o,l,s,u,c,d=t[0][0],f=t[1][0],h=t[0][1],p=t[1][1],g=$s,y=g.length;y--;)if(i=g[y],i&&i.prepare())for(l=i.edges,s=l.length,o=0;s>o;)c=l[o].end(),r=c.x,a=c.y,u=l[++o%s].start(),e=u.x,n=u.y,(ul(r-e)>Nl||ul(a-n)>Nl)&&(l.splice(o,0,new ta(Kr(i.site,c,ul(r-d)<Nl&&p-a>Nl?{x:d,y:ul(e-d)<Nl?n:p}:ul(a-p)<Nl&&f-r>Nl?{x:ul(n-p)<Nl?e:f,y:p}:ul(r-f)<Nl&&a-h>Nl?{x:f,y:ul(e-f)<Nl?n:h}:ul(a-h)<Nl&&r-d>Nl?{x:ul(n-h)<Nl?e:d,y:h}:null),i.site,null)),++s)}function jr(t,e){return e.angle-t.angle}function Ur(){na(this),this.x=this.y=this.arc=this.site=this.cy=null}function Hr(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,a=t.site,i=n.site;if(r!==i){var o=a.x,l=a.y,s=r.x-o,u=r.y-l,c=i.x-o,d=i.y-l,f=2*(s*d-u*c);if(!(f>=-Dl)){var h=s*s+u*u,p=c*c+d*d,g=(d*h-u*p)/f,y=(s*p-c*h)/f,d=y+l,v=tu.pop()||new Ur;v.arc=t,v.site=a,v.x=g+o,v.y=d+Math.sqrt(g*g+y*y),v.cy=d,t.circle=v;for(var m=null,x=Ks._;x;)if(v.y<x.y||v.y===x.y&&v.x<=x.x){if(!x.L){m=x.P;break}x=x.L}else{if(!x.R){m=x;break}x=x.R}Ks.insert(m,v),m||(Zs=v)}}}}function Xr(t){var e=t.circle;e&&(e.P||(Zs=e.N),Ks.remove(e),tu.push(e),na(e),t.circle=null)}function Wr(t){for(var e,n=Ws,r=Yn(t[0][0],t[0][1],t[1][0],t[1][1]),a=n.length;a--;)e=n[a],(!$r(e,t)||!r(e)||ul(e.a.x-e.b.x)<Nl&&ul(e.a.y-e.b.y)<Nl)&&(e.a=e.b=null,n.splice(a,1))}function $r(t,e){var n=t.b;if(n)return!0;var r,a,i=t.a,o=e[0][0],l=e[1][0],s=e[0][1],u=e[1][1],c=t.l,d=t.r,f=c.x,h=c.y,p=d.x,g=d.y,y=(f+p)/2,v=(h+g)/2;if(g===h){if(o>y||y>=l)return;if(f>p){if(i){if(i.y>=u)return}else i={x:y,y:s};n={x:y,y:u}}else{if(i){if(i.y<s)return}else i={x:y,y:u};n={x:y,y:s}}}else if(r=(f-p)/(g-h),a=v-r*y,-1>r||r>1)if(f>p){if(i){if(i.y>=u)return}else i={x:(s-a)/r,y:s};n={x:(u-a)/r,y:u}}else{if(i){if(i.y<s)return}else i={x:(u-a)/r,y:u};n={x:(s-a)/r,y:s}}else if(g>h){if(i){if(i.x>=l)return}else i={x:o,y:r*o+a};n={x:l,y:r*l+a}}else{if(i){if(i.x<o)return}else i={x:l,y:r*l+a};n={x:o,y:r*o+a}}return t.a=i,t.b=n,!0}function Jr(t,e){this.l=t,this.r=e,this.a=this.b=null}function Zr(t,e,n,r){var a=new Jr(t,e);return Ws.push(a),n&&Qr(a,t,e,n),r&&Qr(a,e,t,r),$s[t.i].edges.push(new ta(a,t,e)),$s[e.i].edges.push(new ta(a,e,t)),a}function Kr(t,e,n){var r=new Jr(t,null);return r.a=e,r.b=n,Ws.push(r),r}function Qr(t,e,n,r){t.a||t.b?t.l===n?t.b=r:t.a=r:(t.a=r,t.l=e,t.r=n)}function ta(t,e,n){var r=t.a,a=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(a.x-r.x,r.y-a.y):Math.atan2(r.x-a.x,a.y-r.y)}function ea(){this._=null}function na(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function ra(t,e){var n=e,r=e.R,a=n.U;a?a.L===n?a.L=r:a.R=r:t._=r,r.U=a,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function aa(t,e){var n=e,r=e.L,a=n.U;a?a.L===n?a.L=r:a.R=r:t._=r,r.U=a,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function ia(t){for(;t.L;)t=t.L;return t}function oa(t,e){var n,r,a,i=t.sort(la).pop();for(Ws=[],$s=new Array(t.length),Js=new ea,Ks=new ea;;)if(a=Zs,i&&(!a||i.y<a.y||i.y===a.y&&i.x<a.x))(i.x!==n||i.y!==r)&&($s[i.i]=new qr(i),Rr(i),n=i.x,r=i.y),i=t.pop();else{if(!a)break;Or(a.arc)}e&&(Wr(e),Gr(e));var o={cells:$s,edges:Ws};return Js=Ks=Ws=$s=null,o}function la(t,e){return e.y-t.y||e.x-t.x}function sa(t,e,n){return(t.x-n.x)*(e.y-t.y)-(t.x-e.x)*(n.y-t.y)}function ua(t){return t.x}function ca(t){return t.y}function da(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function fa(t,e,n,r,a,i){if(!t(e,n,r,a,i)){var o=.5*(n+a),l=.5*(r+i),s=e.nodes;s[0]&&fa(t,s[0],n,r,o,l),s[1]&&fa(t,s[1],o,r,a,l),s[2]&&fa(t,s[2],n,l,o,i),s[3]&&fa(t,s[3],o,l,a,i)}}function ha(t,e){t=$o.rgb(t),e=$o.rgb(e);var n=t.r,r=t.g,a=t.b,i=e.r-n,o=e.g-r,l=e.b-a;return function(t){return"#"+xe(Math.round(n+i*t))+xe(Math.round(r+o*t))+xe(Math.round(a+l*t))}}function pa(t,e){var n,r={},a={};for(n in t)n in e?r[n]=va(t[n],e[n]):a[n]=t[n];for(n in e)n in t||(a[n]=e[n]);return function(t){for(n in r)a[n]=r[n](t);return a}}function ga(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function ya(t,e){var n,r,a,i=nu.lastIndex=ru.lastIndex=0,o=-1,l=[],s=[];for(t+="",e+="";(n=nu.exec(t))&&(r=ru.exec(e));)(a=r.index)>i&&(a=e.slice(i,a),l[o]?l[o]+=a:l[++o]=a),(n=n[0])===(r=r[0])?l[o]?l[o]+=r:l[++o]=r:(l[++o]=null,s.push({i:o,x:ga(n,r)})),i=ru.lastIndex;return i<e.length&&(a=e.slice(i),l[o]?l[o]+=a:l[++o]=a),l.length<2?s[0]?(e=s[0].x,function(t){return e(t)+""}):function(){return e}:(e=s.length,function(t){for(var n,r=0;e>r;++r)l[(n=s[r]).i]=n.x(t);return l.join("")})}function va(t,e){for(var n,r=$o.interpolators.length;--r>=0&&!(n=$o.interpolators[r](t,e)););return n}function ma(t,e){var n,r=[],a=[],i=t.length,o=e.length,l=Math.min(t.length,e.length);for(n=0;l>n;++n)r.push(va(t[n],e[n]));for(;i>n;++n)a[n]=t[n];for(;o>n;++n)a[n]=e[n];return function(t){for(n=0;l>n;++n)a[n]=r[n](t);return a}}function xa(t){return function(e){return 0>=e?0:e>=1?1:t(e)}}function ba(t){return function(e){return 1-t(1-e)}}function ka(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}}function Aa(t){return t*t}function Ma(t){return t*t*t}function wa(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(.5>t?n:3*(t-e)+n-.75)}function Ca(t){return function(e){return Math.pow(e,t)}}function Sa(t){return 1-Math.cos(t*_l)}function Ta(t){return Math.pow(2,10*(t-1))}function La(t){return 1-Math.sqrt(1-t*t)}function _a(t,e){var n;return arguments.length<2&&(e=.45),arguments.length?n=e/Ll*Math.asin(1/t):(t=1,n=e/4),function(r){return 1+t*Math.pow(2,-10*r)*Math.sin((r-n)*Ll/e)}}function Na(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function Da(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function Fa(t,e){t=$o.hcl(t),e=$o.hcl(e);var n=t.h,r=t.c,a=t.l,i=e.h-n,o=e.c-r,l=e.l-a;return isNaN(o)&&(o=0,r=isNaN(r)?e.c:r),isNaN(i)?(i=0,n=isNaN(n)?e.h:n):i>180?i-=360:-180>i&&(i+=360),function(t){return ue(n+i*t,r+o*t,a+l*t)+""}}function Va(t,e){t=$o.hsl(t),e=$o.hsl(e);var n=t.h,r=t.s,a=t.l,i=e.h-n,o=e.s-r,l=e.l-a;return isNaN(o)&&(o=0,r=isNaN(r)?e.s:r),isNaN(i)?(i=0,n=isNaN(n)?e.h:n):i>180?i-=360:-180>i&&(i+=360),function(t){return le(n+i*t,r+o*t,a+l*t)+""}}function Ia(t,e){t=$o.lab(t),e=$o.lab(e);var n=t.l,r=t.a,a=t.b,i=e.l-n,o=e.a-r,l=e.b-a;return function(t){return de(n+i*t,r+o*t,a+l*t)+""}}function Pa(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function za(t){var e=[t.a,t.b],n=[t.c,t.d],r=Oa(e),a=Ea(e,n),i=Oa(Ra(n,e,-a))||0;e[0]*n[1]<n[0]*e[1]&&(e[0]*=-1,e[1]*=-1,r*=-1,a*=-1),this.rotate=(r?Math.atan2(e[1],e[0]):Math.atan2(-n[0],n[1]))*Vl,this.translate=[t.e,t.f],this.scale=[r,i],this.skew=i?Math.atan2(a,i)*Vl:0}function Ea(t,e){return t[0]*e[0]+t[1]*e[1]}function Oa(t){var e=Math.sqrt(Ea(t,t));return e&&(t[0]/=e,t[1]/=e),e}function Ra(t,e,n){return t[0]+=n*e[0],t[1]+=n*e[1],t}function Ba(t,e){var n,r=[],a=[],i=$o.transform(t),o=$o.transform(e),l=i.translate,s=o.translate,u=i.rotate,c=o.rotate,d=i.skew,f=o.skew,h=i.scale,p=o.scale;return l[0]!=s[0]||l[1]!=s[1]?(r.push("translate(",null,",",null,")"),a.push({i:1,x:ga(l[0],s[0])},{i:3,x:ga(l[1],s[1])})):r.push(s[0]||s[1]?"translate("+s+")":""),u!=c?(u-c>180?c+=360:c-u>180&&(u+=360),a.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:ga(u,c)})):c&&r.push(r.pop()+"rotate("+c+")"),d!=f?a.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:ga(d,f)}):f&&r.push(r.pop()+"skewX("+f+")"),h[0]!=p[0]||h[1]!=p[1]?(n=r.push(r.pop()+"scale(",null,",",null,")"),a.push({i:n-4,x:ga(h[0],p[0])},{i:n-2,x:ga(h[1],p[1])})):(1!=p[0]||1!=p[1])&&r.push(r.pop()+"scale("+p+")"),n=a.length,function(t){for(var e,i=-1;++i<n;)r[(e=a[i]).i]=e.x(t);return r.join("")}}function Ya(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function qa(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function Ga(t){for(var e=t.source,n=t.target,r=Ua(e,n),a=[e];e!==r;)e=e.parent,a.push(e);for(var i=a.length;n!==r;)a.splice(i,0,n),n=n.parent;return a}function ja(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function Ua(t,e){if(t===e)return t;for(var n=ja(t),r=ja(e),a=n.pop(),i=r.pop(),o=null;a===i;)o=a,a=n.pop(),i=r.pop();return o}function Ha(t){t.fixed|=2}function Xa(t){t.fixed&=-7}function Wa(t){t.fixed|=4,t.px=t.x,t.py=t.y}function $a(t){t.fixed&=-5}function Ja(t,e,n){var r=0,a=0;if(t.charge=0,!t.leaf)for(var i,o=t.nodes,l=o.length,s=-1;++s<l;)i=o[s],null!=i&&(Ja(i,e,n),t.charge+=i.charge,r+=i.charge*i.cx,a+=i.charge*i.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var u=e*n[t.point.index];t.charge+=t.pointCharge=u,r+=u*t.point.x,a+=u*t.point.y}t.cx=r/t.charge,t.cy=a/t.charge}function Za(t,e){return $o.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=ri,t}function Ka(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(a=t.children)&&(r=a.length))for(var r,a;--r>=0;)n.push(a[r])}function Qa(t,e){for(var n=[t],r=[];null!=(t=n.pop());)if(r.push(t),(i=t.children)&&(a=i.length))for(var a,i,o=-1;++o<a;)n.push(i[o]);for(;null!=(t=r.pop());)e(t)}function ti(t){return t.children}function ei(t){return t.value}function ni(t,e){return e.value-t.value}function ri(t){return $o.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function ai(t){return t.x}function ii(t){return t.y}function oi(t,e,n){t.y0=e,t.y=n}function li(t){return $o.range(t.length)}function si(t){for(var e=-1,n=t[0].length,r=[];++e<n;)r[e]=0;return r}function ui(t){for(var e,n=1,r=0,a=t[0][1],i=t.length;i>n;++n)(e=t[n][1])>a&&(r=n,a=e);return r}function ci(t){return t.reduce(di,0)}function di(t,e){return t+e[1]}function fi(t,e){return hi(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function hi(t,e){for(var n=-1,r=+t[0],a=(t[1]-r)/e,i=[];++n<=e;)i[n]=a*n+r;return i}function pi(t){return[$o.min(t),$o.max(t)]}function gi(t,e){return t.value-e.value}function yi(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function vi(t,e){t._pack_next=e,e._pack_prev=t}function mi(t,e){var n=e.x-t.x,r=e.y-t.y,a=t.r+e.r;return.999*a*a>n*n+r*r}function xi(t){function e(t){c=Math.min(t.x-t.r,c),d=Math.max(t.x+t.r,d),f=Math.min(t.y-t.r,f),h=Math.max(t.y+t.r,h)}if((n=t.children)&&(u=n.length)){var n,r,a,i,o,l,s,u,c=1/0,d=-1/0,f=1/0,h=-1/0;if(n.forEach(bi),r=n[0],r.x=-r.r,r.y=0,e(r),u>1&&(a=n[1],a.x=a.r,a.y=0,e(a),u>2))for(i=n[2],Mi(r,a,i),e(i),yi(r,i),r._pack_prev=i,yi(i,a),a=r._pack_next,o=3;u>o;o++){Mi(r,a,i=n[o]);var p=0,g=1,y=1;for(l=a._pack_next;l!==a;l=l._pack_next,g++)if(mi(l,i)){p=1;break}if(1==p)for(s=r._pack_prev;s!==l._pack_prev&&!mi(s,i);s=s._pack_prev,y++);p?(y>g||g==y&&a.r<r.r?vi(r,a=l):vi(r=s,a),o--):(yi(r,i),a=i,e(i))}var v=(c+d)/2,m=(f+h)/2,x=0;for(o=0;u>o;o++)i=n[o],i.x-=v,i.y-=m,x=Math.max(x,i.r+Math.sqrt(i.x*i.x+i.y*i.y));t.r=x,n.forEach(ki)}}function bi(t){t._pack_next=t._pack_prev=t}function ki(t){delete t._pack_next,delete t._pack_prev}function Ai(t,e,n,r){var a=t.children;if(t.x=e+=r*t.x,t.y=n+=r*t.y,t.r*=r,a)for(var i=-1,o=a.length;++i<o;)Ai(a[i],e,n,r)}function Mi(t,e,n){var r=t.r+n.r,a=e.x-t.x,i=e.y-t.y;if(r&&(a||i)){var o=e.r+n.r,l=a*a+i*i;o*=o,r*=r;var s=.5+(r-o)/(2*l),u=Math.sqrt(Math.max(0,2*o*(r+l)-(r-=l)*r-o*o))/(2*l);n.x=t.x+s*a+u*i,n.y=t.y+s*i-u*a}else n.x=t.x+r,n.y=t.y}function wi(t,e){return t.parent==e.parent?1:2}function Ci(t){var e=t.children;return e.length?e[0]:t.t}function Si(t){var e,n=t.children;return(e=n.length)?n[e-1]:t.t}function Ti(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function Li(t){for(var e,n=0,r=0,a=t.children,i=a.length;--i>=0;)e=a[i],e.z+=n,e.m+=n,n+=e.s+(r+=e.c)}function _i(t,e,n){return t.a.parent===e.parent?t.a:n}function Ni(t){return 1+$o.max(t,function(t){return t.y})}function Di(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function Fi(t){var e=t.children;return e&&e.length?Fi(e[0]):t}function Vi(t){var e,n=t.children;return n&&(e=n.length)?Vi(n[e-1]):t}function Ii(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Pi(t,e){var n=t.x+e[3],r=t.y+e[0],a=t.dx-e[1]-e[3],i=t.dy-e[0]-e[2];return 0>a&&(n+=a/2,a=0),0>i&&(r+=i/2,i=0),{x:n,y:r,dx:a,dy:i}}function zi(t){var e=t[0],n=t[t.length-1];return n>e?[e,n]:[n,e]}function Ei(t){return t.rangeExtent?t.rangeExtent():zi(t.range())}function Oi(t,e,n,r){var a=n(t[0],t[1]),i=r(e[0],e[1]);return function(t){return i(a(t))}}function Ri(t,e){var n,r=0,a=t.length-1,i=t[r],o=t[a];return i>o&&(n=r,r=a,a=n,n=i,i=o,o=n),t[r]=e.floor(i),t[a]=e.ceil(o),t}function Bi(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:pu}function Yi(t,e,n,r){var a=[],i=[],o=0,l=Math.min(t.length,e.length)-1;for(t[l]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<=l;)a.push(n(t[o-1],t[o])),i.push(r(e[o-1],e[o]));return function(e){var n=$o.bisect(t,e,1,l)-1;return i[n](a[n](e))}}function qi(t,e,n,r){function a(){var a=Math.min(t.length,e.length)>2?Yi:Oi,s=r?qa:Ya;return o=a(t,e,s,n),l=a(e,t,s,va),i}function i(t){return o(t)}var o,l;return i.invert=function(t){return l(t)},i.domain=function(e){return arguments.length?(t=e.map(Number),a()):t},i.range=function(t){return arguments.length?(e=t,a()):e},i.rangeRound=function(t){return i.range(t).interpolate(Pa)},i.clamp=function(t){return arguments.length?(r=t,a()):r},i.interpolate=function(t){return arguments.length?(n=t,a()):n},i.ticks=function(e){return Hi(t,e)},i.tickFormat=function(e,n){return Xi(t,e,n)},i.nice=function(e){return ji(t,e),a()},i.copy=function(){return qi(t,e,n,r)},a()}function Gi(t,e){return $o.rebind(t,e,"range","rangeRound","interpolate","clamp")}function ji(t,e){return Ri(t,Bi(Ui(t,e)[2]))}function Ui(t,e){null==e&&(e=10);var n=zi(t),r=n[1]-n[0],a=Math.pow(10,Math.floor(Math.log(r/e)/Math.LN10)),i=e/r*a;return.15>=i?a*=10:.35>=i?a*=5:.75>=i&&(a*=2),n[0]=Math.ceil(n[0]/a)*a,n[1]=Math.floor(n[1]/a)*a+.5*a,n[2]=a,n}function Hi(t,e){return $o.range.apply($o,Ui(t,e))}function Xi(t,e,n){var r=Ui(t,e);if(n){var a=ns.exec(n);if(a.shift(),"s"===a[8]){var i=$o.formatPrefix(Math.max(ul(r[0]),ul(r[1])));return a[7]||(a[7]="."+Wi(i.scale(r[2]))),a[8]="f",n=$o.format(a.join("")),function(t){return n(i.scale(t))+i.symbol}}a[7]||(a[7]="."+$i(a[8],r)),n=a.join("")}else n=",."+Wi(r[2])+"f";return $o.format(n)}function Wi(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function $i(t,e){var n=Wi(e[2]);return t in gu?Math.abs(n-Wi(Math.max(ul(e[0]),ul(e[1]))))+ +("e"!==t):n-2*("%"===t)}function Ji(t,e,n,r){function a(t){return(n?Math.log(0>t?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function i(t){return n?Math.pow(e,t):-Math.pow(e,-t)}function o(e){return t(a(e))}return o.invert=function(e){return i(t.invert(e))},o.domain=function(e){return arguments.length?(n=e[0]>=0,t.domain((r=e.map(Number)).map(a)),o):r},o.base=function(n){return arguments.length?(e=+n,t.domain(r.map(a)),o):e},o.nice=function(){var e=Ri(r.map(a),n?Math:vu);return t.domain(e),r=e.map(i),o},o.ticks=function(){var t=zi(r),o=[],l=t[0],s=t[1],u=Math.floor(a(l)),c=Math.ceil(a(s)),d=e%1?2:e;if(isFinite(c-u)){if(n){for(;c>u;u++)for(var f=1;d>f;f++)o.push(i(u)*f);o.push(i(u))}else for(o.push(i(u));u++<c;)for(var f=d-1;f>0;f--)o.push(i(u)*f);for(u=0;o[u]<l;u++);for(c=o.length;o[c-1]>s;c--);o=o.slice(u,c)}return o},o.tickFormat=function(t,e){if(!arguments.length)return yu;arguments.length<2?e=yu:"function"!=typeof e&&(e=$o.format(e));var r,l=Math.max(.1,t/o.ticks().length),s=n?(r=1e-12,Math.ceil):(r=-1e-12,Math.floor);return function(t){return t/i(s(a(t)+r))<=l?e(t):""}},o.copy=function(){return Ji(t.copy(),e,n,r)},Gi(o,t)}function Zi(t,e,n){function r(e){return t(a(e))}var a=Ki(e),i=Ki(1/e);return r.invert=function(e){return i(t.invert(e))},r.domain=function(e){return arguments.length?(t.domain((n=e.map(Number)).map(a)),r):n},r.ticks=function(t){return Hi(n,t)},r.tickFormat=function(t,e){return Xi(n,t,e)},r.nice=function(t){return r.domain(ji(n,t))},r.exponent=function(o){return arguments.length?(a=Ki(e=o),i=Ki(1/e),t.domain(n.map(a)),r):e},r.copy=function(){return Zi(t.copy(),e,n)},Gi(r,t)}function Ki(t){return function(e){return 0>e?-Math.pow(-e,t):Math.pow(e,t)}}function Qi(t,e){function n(n){return i[((a.get(n)||("range"===e.t?a.set(n,t.push(n)):0/0))-1)%i.length]}function r(e,n){return $o.range(t.length).map(function(t){return e+n*t})}var a,i,o;return n.domain=function(r){if(!arguments.length)return t;t=[],a=new l;for(var i,o=-1,s=r.length;++o<s;)a.has(i=r[o])||a.set(i,t.push(i));return n[e.t].apply(n,e.a)},n.range=function(t){return arguments.length?(i=t,o=0,e={t:"range",a:arguments},n):i},n.rangePoints=function(a,l){arguments.length<2&&(l=0);var s=a[0],u=a[1],c=(u-s)/(Math.max(1,t.length-1)+l);return i=r(t.length<2?(s+u)/2:s+c*l/2,c),o=0,e={t:"rangePoints",a:arguments},n},n.rangeBands=function(a,l,s){arguments.length<2&&(l=0),arguments.length<3&&(s=l);var u=a[1]<a[0],c=a[u-0],d=a[1-u],f=(d-c)/(t.length-l+2*s);return i=r(c+f*s,f),u&&i.reverse(),o=f*(1-l),e={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(a,l,s){arguments.length<2&&(l=0),arguments.length<3&&(s=l);var u=a[1]<a[0],c=a[u-0],d=a[1-u],f=Math.floor((d-c)/(t.length-l+2*s)),h=d-c-(t.length-l)*f;return i=r(c+Math.round(h/2),f),u&&i.reverse(),o=Math.round(f*(1-l)),e={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return o},n.rangeExtent=function(){return zi(e.a[0])},n.copy=function(){return Qi(t,e)},n.domain(t)}function to(r,a){function i(){var t=0,e=a.length;for(l=[];++t<e;)l[t-1]=$o.quantile(r,t/e);return o}function o(t){return isNaN(t=+t)?void 0:a[$o.bisect(l,t)]}var l;return o.domain=function(a){return arguments.length?(r=a.map(e).filter(n).sort(t),i()):r},o.range=function(t){return arguments.length?(a=t,i()):a},o.quantiles=function(){return l},o.invertExtent=function(t){return t=a.indexOf(t),0>t?[0/0,0/0]:[t>0?l[t-1]:r[0],t<l.length?l[t]:r[r.length-1]]},o.copy=function(){return to(r,a)},i()}function eo(t,e,n){function r(e){return n[Math.max(0,Math.min(o,Math.floor(i*(e-t))))]}function a(){return i=n.length/(e-t),o=n.length-1,r}var i,o;return r.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],a()):[t,e]},r.range=function(t){return arguments.length?(n=t,a()):n},r.invertExtent=function(e){return e=n.indexOf(e),e=0>e?0/0:e/i+t,[e,e+1/i]},r.copy=function(){return eo(t,e,n)},a()}function no(t,e){function n(n){return n>=n?e[$o.bisect(t,n)]:void 0}return n.domain=function(e){return arguments.length?(t=e,n):t},n.range=function(t){return arguments.length?(e=t,n):e},n.invertExtent=function(n){return n=e.indexOf(n),[t[n-1],t[n]]},n.copy=function(){return no(t,e)},n}function ro(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=n.map(e),e):t},e.ticks=function(e){return Hi(t,e)},e.tickFormat=function(e,n){return Xi(t,e,n)},e.copy=function(){return ro(t)},e}function ao(t){return t.innerRadius}function io(t){return t.outerRadius}function oo(t){return t.startAngle}function lo(t){return t.endAngle}function so(t){function e(e){function o(){u.push("M",i(t(c),l))}for(var s,u=[],c=[],d=-1,f=e.length,h=Ce(n),p=Ce(r);++d<f;)a.call(this,s=e[d],d)?c.push([+h.call(this,s,d),+p.call(this,s,d)]):c.length&&(o(),c=[]);return c.length&&o(),u.length?u.join(""):null}var n=Lr,r=_r,a=Ln,i=uo,o=i.key,l=.7;return e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(r=t,e):r},e.defined=function(t){return arguments.length?(a=t,e):a},e.interpolate=function(t){return arguments.length?(o="function"==typeof t?i=t:(i=wu.get(t)||uo).key,e):o},e.tension=function(t){return arguments.length?(l=t,e):l},e}function uo(t){return t.join("L")}function co(t){return uo(t)+"Z"}function fo(t){for(var e=0,n=t.length,r=t[0],a=[r[0],",",r[1]];++e<n;)a.push("H",(r[0]+(r=t[e])[0])/2,"V",r[1]);return n>1&&a.push("H",r[0]),a.join("")}function ho(t){for(var e=0,n=t.length,r=t[0],a=[r[0],",",r[1]];++e<n;)a.push("V",(r=t[e])[1],"H",r[0]);return a.join("")}function po(t){for(var e=0,n=t.length,r=t[0],a=[r[0],",",r[1]];++e<n;)a.push("H",(r=t[e])[0],"V",r[1]);return a.join("")}function go(t,e){return t.length<4?uo(t):t[1]+mo(t.slice(1,t.length-1),xo(t,e))}function yo(t,e){return t.length<3?uo(t):t[0]+mo((t.push(t[0]),t),xo([t[t.length-2]].concat(t,[t[1]]),e))}function vo(t,e){return t.length<3?uo(t):t[0]+mo(t,xo(t,e))}function mo(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return uo(t);var n=t.length!=e.length,r="",a=t[0],i=t[1],o=e[0],l=o,s=1;if(n&&(r+="Q"+(i[0]-2*o[0]/3)+","+(i[1]-2*o[1]/3)+","+i[0]+","+i[1],a=t[1],s=2),e.length>1){l=e[1],i=t[s],s++,r+="C"+(a[0]+o[0])+","+(a[1]+o[1])+","+(i[0]-l[0])+","+(i[1]-l[1])+","+i[0]+","+i[1];for(var u=2;u<e.length;u++,s++)i=t[s],l=e[u],r+="S"+(i[0]-l[0])+","+(i[1]-l[1])+","+i[0]+","+i[1]}if(n){var c=t[s];r+="Q"+(i[0]+2*l[0]/3)+","+(i[1]+2*l[1]/3)+","+c[0]+","+c[1]}return r}function xo(t,e){for(var n,r=[],a=(1-e)/2,i=t[0],o=t[1],l=1,s=t.length;++l<s;)n=i,i=o,o=t[l],r.push([a*(o[0]-n[0]),a*(o[1]-n[1])]);return r}function bo(t){if(t.length<3)return uo(t);var e=1,n=t.length,r=t[0],a=r[0],i=r[1],o=[a,a,a,(r=t[1])[0]],l=[i,i,i,r[1]],s=[a,",",i,"L",wo(Tu,o),",",wo(Tu,l)];for(t.push(t[n-1]);++e<=n;)r=t[e],o.shift(),o.push(r[0]),l.shift(),l.push(r[1]),Co(s,o,l);return t.pop(),s.push("L",r),s.join("")}function ko(t){if(t.length<4)return uo(t);for(var e,n=[],r=-1,a=t.length,i=[0],o=[0];++r<3;)e=t[r],i.push(e[0]),o.push(e[1]);for(n.push(wo(Tu,i)+","+wo(Tu,o)),--r;++r<a;)e=t[r],i.shift(),i.push(e[0]),o.shift(),o.push(e[1]),Co(n,i,o);return n.join("")}function Ao(t){for(var e,n,r=-1,a=t.length,i=a+4,o=[],l=[];++r<4;)n=t[r%a],o.push(n[0]),l.push(n[1]);for(e=[wo(Tu,o),",",wo(Tu,l)],--r;++r<i;)n=t[r%a],o.shift(),o.push(n[0]),l.shift(),l.push(n[1]),Co(e,o,l);return e.join("")}function Mo(t,e){var n=t.length-1;if(n)for(var r,a,i=t[0][0],o=t[0][1],l=t[n][0]-i,s=t[n][1]-o,u=-1;++u<=n;)r=t[u],a=u/n,r[0]=e*r[0]+(1-e)*(i+a*l),r[1]=e*r[1]+(1-e)*(o+a*s);return bo(t)}function wo(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Co(t,e,n){t.push("C",wo(Cu,e),",",wo(Cu,n),",",wo(Su,e),",",wo(Su,n),",",wo(Tu,e),",",wo(Tu,n))}function So(t,e){return(e[1]-t[1])/(e[0]-t[0])}function To(t){for(var e=0,n=t.length-1,r=[],a=t[0],i=t[1],o=r[0]=So(a,i);++e<n;)r[e]=(o+(o=So(a=i,i=t[e+1])))/2;return r[e]=o,r}function Lo(t){for(var e,n,r,a,i=[],o=To(t),l=-1,s=t.length-1;++l<s;)e=So(t[l],t[l+1]),ul(e)<Nl?o[l]=o[l+1]=0:(n=o[l]/e,r=o[l+1]/e,a=n*n+r*r,a>9&&(a=3*e/Math.sqrt(a),o[l]=a*n,o[l+1]=a*r));for(l=-1;++l<=s;)a=(t[Math.min(s,l+1)][0]-t[Math.max(0,l-1)][0])/(6*(1+o[l]*o[l])),i.push([a||0,o[l]*a||0]);return i}function _o(t){return t.length<3?uo(t):t[0]+mo(t,Lo(t))}function No(t){for(var e,n,r,a=-1,i=t.length;++a<i;)e=t[a],n=e[0],r=e[1]+Au,e[0]=n*Math.cos(r),e[1]=n*Math.sin(r);return t}function Do(t){function e(e){function s(){g.push("M",l(t(v),d),c,u(t(y.reverse()),d),"Z")}for(var f,h,p,g=[],y=[],v=[],m=-1,x=e.length,b=Ce(n),k=Ce(a),A=n===r?function(){return h}:Ce(r),M=a===i?function(){return p}:Ce(i);++m<x;)o.call(this,f=e[m],m)?(y.push([h=+b.call(this,f,m),p=+k.call(this,f,m)]),v.push([+A.call(this,f,m),+M.call(this,f,m)])):y.length&&(s(),y=[],v=[]);return y.length&&s(),g.length?g.join(""):null}var n=Lr,r=Lr,a=0,i=_r,o=Ln,l=uo,s=l.key,u=l,c="L",d=.7;return e.x=function(t){return arguments.length?(n=r=t,e):r},e.x0=function(t){return arguments.length?(n=t,e):n},e.x1=function(t){return arguments.length?(r=t,e):r},e.y=function(t){return arguments.length?(a=i=t,e):i},e.y0=function(t){return arguments.length?(a=t,e):a},e.y1=function(t){return arguments.length?(i=t,e):i},e.defined=function(t){return arguments.length?(o=t,e):o},e.interpolate=function(t){return arguments.length?(s="function"==typeof t?l=t:(l=wu.get(t)||uo).key,u=l.reverse||l,c=l.closed?"M":"L",e):s},e.tension=function(t){return arguments.length?(d=t,e):d},e}function Fo(t){return t.radius}function Vo(t){return[t.x,t.y]}function Io(t){return function(){var e=t.apply(this,arguments),n=e[0],r=e[1]+Au;return[n*Math.cos(r),n*Math.sin(r)]}}function Po(){return 64
}function zo(){return"circle"}function Eo(t){var e=Math.sqrt(t/Tl);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function Oo(t,e){return pl(t,Vu),t.id=e,t}function Ro(t,e,n,r){var a=t.id;return R(t,"function"==typeof n?function(t,i,o){t.__transition__[a].tween.set(e,r(n.call(t,t.__data__,i,o)))}:(n=r(n),function(t){t.__transition__[a].tween.set(e,n)}))}function Bo(t){return null==t&&(t=""),function(){this.textContent=t}}function Yo(t,e,n,r){var a=t.__transition__||(t.__transition__={active:0,count:0}),i=a[n];if(!i){var o=r.time;i=a[n]={tween:new l,time:o,ease:r.ease,delay:r.delay,duration:r.duration},++a.count,$o.timer(function(r){function l(r){return a.active>n?u():(a.active=n,i.event&&i.event.start.call(t,c,e),i.tween.forEach(function(n,r){(r=r.call(t,c,e))&&g.push(r)}),void $o.timer(function(){return p.c=s(r||1)?Ln:s,1},0,o))}function s(r){if(a.active!==n)return u();for(var o=r/h,l=d(o),s=g.length;s>0;)g[--s].call(t,l);return o>=1?(i.event&&i.event.end.call(t,c,e),u()):void 0}function u(){return--a.count?delete a[n]:delete t.__transition__,1}var c=t.__data__,d=i.ease,f=i.delay,h=i.duration,p=Ql,g=[];return p.t=f+o,r>=f?l(r-f):void(p.c=l)},0,o)}}function qo(t,e,n){t.attr("transform",function(t){var r=e(t);return"translate("+(isFinite(r)?r:n(t))+",0)"})}function Go(t,e,n){t.attr("transform",function(t){var r=e(t);return"translate(0,"+(isFinite(r)?r:n(t))+")"})}function jo(t){return t.toISOString()}function Uo(t,e,n){function r(e){return t(e)}function a(t,n){var r=t[1]-t[0],a=r/n,i=$o.bisect(qu,a);return i==qu.length?[e.year,Ui(t.map(function(t){return t/31536e6}),n)[2]]:i?e[a/qu[i-1]<qu[i]/a?i-1:i]:[Uu,Ui(t,n)[2]]}return r.invert=function(e){return Ho(t.invert(e))},r.domain=function(e){return arguments.length?(t.domain(e),r):t.domain().map(Ho)},r.nice=function(t,e){function n(n){return!isNaN(n)&&!t.range(n,Ho(+n+1),e).length}var i=r.domain(),o=zi(i),l=null==t?a(o,10):"number"==typeof t&&a(o,t);return l&&(t=l[0],e=l[1]),r.domain(Ri(i,e>1?{floor:function(e){for(;n(e=t.floor(e));)e=Ho(e-1);return e},ceil:function(e){for(;n(e=t.ceil(e));)e=Ho(+e+1);return e}}:t))},r.ticks=function(t,e){var n=zi(r.domain()),i=null==t?a(n,10):"number"==typeof t?a(n,t):!t.range&&[{range:t},e];return i&&(t=i[0],e=i[1]),t.range(n[0],Ho(+n[1]+1),1>e?1:e)},r.tickFormat=function(){return n},r.copy=function(){return Uo(t.copy(),e,n)},Gi(r,t)}function Ho(t){return new Date(t)}function Xo(t){return JSON.parse(t.responseText)}function Wo(t){var e=Ko.createRange();return e.selectNode(Ko.body),e.createContextualFragment(t.responseText)}var $o={version:"3.4.13"};Date.now||(Date.now=function(){return+new Date});var Jo=[].slice,Zo=function(t){return Jo.call(t)},Ko=document,Qo=Ko.documentElement,tl=window;try{Zo(Qo.childNodes)[0].nodeType}catch(el){Zo=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}try{Ko.createElement("div").style.setProperty("opacity",0,"")}catch(nl){var rl=tl.Element.prototype,al=rl.setAttribute,il=rl.setAttributeNS,ol=tl.CSSStyleDeclaration.prototype,ll=ol.setProperty;rl.setAttribute=function(t,e){al.call(this,t,e+"")},rl.setAttributeNS=function(t,e,n){il.call(this,t,e,n+"")},ol.setProperty=function(t,e,n){ll.call(this,t,e+"",n)}}$o.ascending=t,$o.descending=function(t,e){return t>e?-1:e>t?1:e>=t?0:0/0},$o.min=function(t,e){var n,r,a=-1,i=t.length;if(1===arguments.length){for(;++a<i&&!(null!=(n=t[a])&&n>=n);)n=void 0;for(;++a<i;)null!=(r=t[a])&&n>r&&(n=r)}else{for(;++a<i&&!(null!=(n=e.call(t,t[a],a))&&n>=n);)n=void 0;for(;++a<i;)null!=(r=e.call(t,t[a],a))&&n>r&&(n=r)}return n},$o.max=function(t,e){var n,r,a=-1,i=t.length;if(1===arguments.length){for(;++a<i&&!(null!=(n=t[a])&&n>=n);)n=void 0;for(;++a<i;)null!=(r=t[a])&&r>n&&(n=r)}else{for(;++a<i&&!(null!=(n=e.call(t,t[a],a))&&n>=n);)n=void 0;for(;++a<i;)null!=(r=e.call(t,t[a],a))&&r>n&&(n=r)}return n},$o.extent=function(t,e){var n,r,a,i=-1,o=t.length;if(1===arguments.length){for(;++i<o&&!(null!=(n=a=t[i])&&n>=n);)n=a=void 0;for(;++i<o;)null!=(r=t[i])&&(n>r&&(n=r),r>a&&(a=r))}else{for(;++i<o&&!(null!=(n=a=e.call(t,t[i],i))&&n>=n);)n=void 0;for(;++i<o;)null!=(r=e.call(t,t[i],i))&&(n>r&&(n=r),r>a&&(a=r))}return[n,a]},$o.sum=function(t,e){var r,a=0,i=t.length,o=-1;if(1===arguments.length)for(;++o<i;)n(r=+t[o])&&(a+=r);else for(;++o<i;)n(r=+e.call(t,t[o],o))&&(a+=r);return a},$o.mean=function(t,r){var a,i=0,o=t.length,l=-1,s=o;if(1===arguments.length)for(;++l<o;)n(a=e(t[l]))?i+=a:--s;else for(;++l<o;)n(a=e(r.call(t,t[l],l)))?i+=a:--s;return s?i/s:void 0},$o.quantile=function(t,e){var n=(t.length-1)*e+1,r=Math.floor(n),a=+t[r-1],i=n-r;return i?a+i*(t[r]-a):a},$o.median=function(r,a){var i,o=[],l=r.length,s=-1;if(1===arguments.length)for(;++s<l;)n(i=e(r[s]))&&o.push(i);else for(;++s<l;)n(i=e(a.call(r,r[s],s)))&&o.push(i);return o.length?$o.quantile(o.sort(t),.5):void 0};var sl=r(t);$o.bisectLeft=sl.left,$o.bisect=$o.bisectRight=sl.right,$o.bisector=function(e){return r(1===e.length?function(n,r){return t(e(n),r)}:e)},$o.shuffle=function(t){for(var e,n,r=t.length;r;)n=0|Math.random()*r--,e=t[r],t[r]=t[n],t[n]=e;return t},$o.permute=function(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r},$o.pairs=function(t){for(var e,n=0,r=t.length-1,a=t[0],i=new Array(0>r?0:r);r>n;)i[n]=[e=a,a=t[++n]];return i},$o.zip=function(){if(!(r=arguments.length))return[];for(var t=-1,e=$o.min(arguments,a),n=new Array(e);++t<e;)for(var r,i=-1,o=n[t]=new Array(r);++i<r;)o[i]=arguments[i][t];return n},$o.transpose=function(t){return $o.zip.apply($o,t)},$o.keys=function(t){var e=[];for(var n in t)e.push(n);return e},$o.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},$o.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},$o.merge=function(t){for(var e,n,r,a=t.length,i=-1,o=0;++i<a;)o+=t[i].length;for(n=new Array(o);--a>=0;)for(r=t[a],e=r.length;--e>=0;)n[--o]=r[e];return n};var ul=Math.abs;$o.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),1/0===(e-t)/n)throw new Error("infinite range");var r,a=[],o=i(ul(n)),l=-1;if(t*=o,e*=o,n*=o,0>n)for(;(r=t+n*++l)>e;)a.push(r/o);else for(;(r=t+n*++l)<e;)a.push(r/o);return a},$o.map=function(t){var e=new l;if(t instanceof l)t.forEach(function(t,n){e.set(t,n)});else for(var n in t)e.set(n,t[n]);return e};var cl="__proto__",dl="\x00";o(l,{has:c,get:function(t){return this._[s(t)]},set:function(t,e){return this._[s(t)]=e},remove:d,keys:f,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:u(e),value:this._[e]});return t},size:h,empty:p,forEach:function(t){for(var e in this._)t.call(this,u(e),this._[e])}}),$o.nest=function(){function t(e,o,s){if(s>=i.length)return r?r.call(a,o):n?o.sort(n):o;for(var u,c,d,f,h=-1,p=o.length,g=i[s++],y=new l;++h<p;)(f=y.get(u=g(c=o[h])))?f.push(c):y.set(u,[c]);return e?(c=e(),d=function(n,r){c.set(n,t(e,r,s))}):(c={},d=function(n,r){c[n]=t(e,r,s)}),y.forEach(d),c}function e(t,n){if(n>=i.length)return t;var r=[],a=o[n++];return t.forEach(function(t,a){r.push({key:t,values:e(a,n)})}),a?r.sort(function(t,e){return a(t.key,e.key)}):r}var n,r,a={},i=[],o=[];return a.map=function(e,n){return t(n,e,0)},a.entries=function(n){return e(t($o.map,n,0),0)},a.key=function(t){return i.push(t),a},a.sortKeys=function(t){return o[i.length-1]=t,a},a.sortValues=function(t){return n=t,a},a.rollup=function(t){return r=t,a},a},$o.set=function(t){var e=new g;if(t)for(var n=0,r=t.length;r>n;++n)e.add(t[n]);return e},o(g,{has:c,add:function(t){return this._[s(t+="")]=!0,t},remove:d,values:f,size:h,empty:p,forEach:function(t){for(var e in this._)t.call(this,u(e))}}),$o.behavior={},$o.rebind=function(t,e){for(var n,r=1,a=arguments.length;++r<a;)t[n=arguments[r]]=y(t,e,e[n]);return t};var fl=["webkit","ms","moz","Moz","o","O"];$o.dispatch=function(){for(var t=new x,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=b(t);return t},x.prototype.on=function(t,e){var n=t.indexOf("."),r="";if(n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),t)return arguments.length<2?this[t].on(r):this[t].on(r,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(r,null);return this}},$o.event=null,$o.requote=function(t){return t.replace(hl,"\\$&")};var hl=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,pl={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]},gl=function(t,e){return e.querySelector(t)},yl=function(t,e){return e.querySelectorAll(t)},vl=Qo.matches||Qo[v(Qo,"matchesSelector")],ml=function(t,e){return vl.call(t,e)};"function"==typeof Sizzle&&(gl=function(t,e){return Sizzle(t,e)[0]||null},yl=Sizzle,ml=Sizzle.matchesSelector),$o.selection=function(){return Al};var xl=$o.selection.prototype=[];xl.select=function(t){var e,n,r,a,i=[];t=C(t);for(var o=-1,l=this.length;++o<l;){i.push(e=[]),e.parentNode=(r=this[o]).parentNode;for(var s=-1,u=r.length;++s<u;)(a=r[s])?(e.push(n=t.call(a,a.__data__,s,o)),n&&"__data__"in a&&(n.__data__=a.__data__)):e.push(null)}return w(i)},xl.selectAll=function(t){var e,n,r=[];t=S(t);for(var a=-1,i=this.length;++a<i;)for(var o=this[a],l=-1,s=o.length;++l<s;)(n=o[l])&&(r.push(e=Zo(t.call(n,n.__data__,l,a))),e.parentNode=n);return w(r)};var bl={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};$o.ns={prefix:bl,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&(n=t.slice(0,e),t=t.slice(e+1)),bl.hasOwnProperty(n)?{space:bl[n],local:t}:t}},xl.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return t=$o.ns.qualify(t),t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(T(e,t[e]));return this}return this.each(T(t,e))},xl.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),r=(t=N(t)).length,a=-1;if(e=n.classList){for(;++a<r;)if(!e.contains(t[a]))return!1}else for(e=n.getAttribute("class");++a<r;)if(!_(t[a]).test(e))return!1;return!0}for(e in t)this.each(D(e,t[e]));return this}return this.each(D(t,e))},xl.style=function(t,e,n){var r=arguments.length;if(3>r){if("string"!=typeof t){2>r&&(e="");for(n in t)this.each(V(n,t[n],e));return this}if(2>r)return tl.getComputedStyle(this.node(),null).getPropertyValue(t);n=""}return this.each(V(t,e,n))},xl.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(I(e,t[e]));return this}return this.each(I(t,e))},xl.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},xl.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},xl.append=function(t){return t=P(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},xl.insert=function(t,e){return t=P(t),e=C(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},xl.remove=function(){return this.each(function(){var t=this.parentNode;t&&t.removeChild(this)})},xl.data=function(t,e){function n(t,n){var r,a,i,o=t.length,d=n.length,f=Math.min(o,d),h=new Array(d),p=new Array(d),g=new Array(o);if(e){var y,v=new l,m=new Array(o);for(r=-1;++r<o;)v.has(y=e.call(a=t[r],a.__data__,r))?g[r]=a:v.set(y,a),m[r]=y;for(r=-1;++r<d;)(a=v.get(y=e.call(n,i=n[r],r)))?a!==!0&&(h[r]=a,a.__data__=i):p[r]=z(i),v.set(y,!0);for(r=-1;++r<o;)v.get(m[r])!==!0&&(g[r]=t[r])}else{for(r=-1;++r<f;)a=t[r],i=n[r],a?(a.__data__=i,h[r]=a):p[r]=z(i);for(;d>r;++r)p[r]=z(n[r]);for(;o>r;++r)g[r]=t[r]}p.update=h,p.parentNode=h.parentNode=g.parentNode=t.parentNode,s.push(p),u.push(h),c.push(g)}var r,a,i=-1,o=this.length;if(!arguments.length){for(t=new Array(o=(r=this[0]).length);++i<o;)(a=r[i])&&(t[i]=a.__data__);return t}var s=B([]),u=w([]),c=w([]);if("function"==typeof t)for(;++i<o;)n(r=this[i],t.call(r,r.parentNode.__data__,i));else for(;++i<o;)n(r=this[i],t);return u.enter=function(){return s},u.exit=function(){return c},u},xl.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},xl.filter=function(t){var e,n,r,a=[];"function"!=typeof t&&(t=E(t));for(var i=0,o=this.length;o>i;i++){a.push(e=[]),e.parentNode=(n=this[i]).parentNode;for(var l=0,s=n.length;s>l;l++)(r=n[l])&&t.call(r,r.__data__,l,i)&&e.push(r)}return w(a)},xl.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,r=this[t],a=r.length-1,i=r[a];--a>=0;)(n=r[a])&&(i&&i!==n.nextSibling&&i.parentNode.insertBefore(n,i),i=n);return this},xl.sort=function(t){t=O.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},xl.each=function(t){return R(this,function(e,n,r){t.call(e,e.__data__,n,r)})},xl.call=function(t){var e=Zo(arguments);return t.apply(e[0]=this,e),this},xl.empty=function(){return!this.node()},xl.node=function(){for(var t=0,e=this.length;e>t;t++)for(var n=this[t],r=0,a=n.length;a>r;r++){var i=n[r];if(i)return i}return null},xl.size=function(){var t=0;return R(this,function(){++t}),t};var kl=[];$o.selection.enter=B,$o.selection.enter.prototype=kl,kl.append=xl.append,kl.empty=xl.empty,kl.node=xl.node,kl.call=xl.call,kl.size=xl.size,kl.select=function(t){for(var e,n,r,a,i,o=[],l=-1,s=this.length;++l<s;){r=(a=this[l]).update,o.push(e=[]),e.parentNode=a.parentNode;for(var u=-1,c=a.length;++u<c;)(i=a[u])?(e.push(r[u]=n=t.call(a.parentNode,i.__data__,u,l)),n.__data__=i.__data__):e.push(null)}return w(o)},kl.insert=function(t,e){return arguments.length<2&&(e=Y(this)),xl.insert.call(this,t,e)},xl.transition=function(){for(var t,e,n=_u||++Iu,r=[],a=Nu||{time:Date.now(),ease:wa,delay:0,duration:250},i=-1,o=this.length;++i<o;){r.push(t=[]);for(var l=this[i],s=-1,u=l.length;++s<u;)(e=l[s])&&Yo(e,s,n,a),t.push(e)}return Oo(r,n)},xl.interrupt=function(){return this.each(q)},$o.select=function(t){var e=["string"==typeof t?gl(t,Ko):t];return e.parentNode=Qo,w([e])},$o.selectAll=function(t){var e=Zo("string"==typeof t?yl(t,Ko):t);return e.parentNode=Qo,w([e])};var Al=$o.select(Qo);xl.on=function(t,e,n){var r=arguments.length;if(3>r){if("string"!=typeof t){2>r&&(e=!1);for(n in t)this.each(G(n,t[n],e));return this}if(2>r)return(r=this.node()["__on"+t])&&r._;n=!1}return this.each(G(t,e,n))};var Ml=$o.map({mouseenter:"mouseover",mouseleave:"mouseout"});Ml.forEach(function(t){"on"+t in Ko&&Ml.remove(t)});var wl="onselectstart"in Ko?null:v(Qo.style,"userSelect"),Cl=0;$o.mouse=function(t){return X(t,A())};var Sl=/WebKit/.test(tl.navigator.userAgent)?-1:0;$o.touch=function(t,e,n){if(arguments.length<3&&(n=e,e=A().changedTouches),e)for(var r,a=0,i=e.length;i>a;++a)if((r=e[a]).identifier===n)return X(t,r)},$o.behavior.drag=function(){function t(){this.on("mousedown.drag",a).on("touchstart.drag",i)}function e(t,e,a,i,o){return function(){function l(){var t,n,r=e(f,g);r&&(t=r[0]-x[0],n=r[1]-x[1],p|=t|n,x=r,h({type:"drag",x:r[0]+u[0],y:r[1]+u[1],dx:t,dy:n}))}function s(){e(f,g)&&(v.on(i+y,null).on(o+y,null),m(p&&$o.event.target===d),h({type:"dragend"}))}var u,c=this,d=$o.event.target,f=c.parentNode,h=n.of(c,arguments),p=0,g=t(),y=".drag"+(null==g?"":"-"+g),v=$o.select(a()).on(i+y,l).on(o+y,s),m=H(),x=e(f,g);r?(u=r.apply(c,arguments),u=[u.x-x[0],u.y-x[1]]):u=[0,0],h({type:"dragstart"})}}var n=M(t,"drag","dragstart","dragend"),r=null,a=e(m,$o.mouse,J,"mousemove","mouseup"),i=e(W,$o.touch,$,"touchmove","touchend");return t.origin=function(e){return arguments.length?(r=e,t):r},$o.rebind(t,n,"on")},$o.touches=function(t,e){return arguments.length<2&&(e=A().touches),e?Zo(e).map(function(e){var n=X(t,e);return n.identifier=e.identifier,n}):[]};var Tl=Math.PI,Ll=2*Tl,_l=Tl/2,Nl=1e-6,Dl=Nl*Nl,Fl=Tl/180,Vl=180/Tl,Il=Math.SQRT2,Pl=2,zl=4;$o.interpolateZoom=function(t,e){function n(t){var e=t*m;if(v){var n=ne(g),o=i/(Pl*f)*(n*re(Il*e+g)-ee(g));return[r+o*u,a+o*c,i*n/ne(Il*e+g)]}return[r+t*u,a+t*c,i*Math.exp(Il*e)]}var r=t[0],a=t[1],i=t[2],o=e[0],l=e[1],s=e[2],u=o-r,c=l-a,d=u*u+c*c,f=Math.sqrt(d),h=(s*s-i*i+zl*d)/(2*i*Pl*f),p=(s*s-i*i-zl*d)/(2*s*Pl*f),g=Math.log(Math.sqrt(h*h+1)-h),y=Math.log(Math.sqrt(p*p+1)-p),v=y-g,m=(v||Math.log(s/i))/Il;return n.duration=1e3*m,n},$o.behavior.zoom=function(){function t(t){t.on(T,u).on(Rl+".zoom",d).on("dblclick.zoom",f).on(N,c)}function e(t){return[(t[0]-w.x)/w.k,(t[1]-w.y)/w.k]}function n(t){return[t[0]*w.k+w.x,t[1]*w.k+w.y]}function r(t){w.k=Math.max(S[0],Math.min(S[1],t))}function a(t,e){e=n(e),w.x+=t[0]-e[0],w.y+=t[1]-e[1]}function i(){x&&x.domain(m.range().map(function(t){return(t-w.x)/w.k}).map(m.invert)),A&&A.domain(b.range().map(function(t){return(t-w.y)/w.k}).map(b.invert))}function o(t){t({type:"zoomstart"})}function l(t){i(),t({type:"zoom",scale:w.k,translate:[w.x,w.y]})}function s(t){t({type:"zoomend"})}function u(){function t(){c=1,a($o.mouse(r),f),l(u)}function n(){d.on(L,null).on(_,null),h(c&&$o.event.target===i),s(u)}var r=this,i=$o.event.target,u=D.of(r,arguments),c=0,d=$o.select(tl).on(L,t).on(_,n),f=e($o.mouse(r)),h=H();q.call(r),o(u)}function c(){function t(){var t=$o.touches(h);return f=w.k,t.forEach(function(t){t.identifier in g&&(g[t.identifier]=e(t))}),t}function n(){var e=$o.event.target;$o.select(e).on(x,i).on(b,d),A.push(e);for(var n=$o.event.changedTouches,o=0,s=n.length;s>o;++o)g[n[o].identifier]=null;var u=t(),c=Date.now();if(1===u.length){if(500>c-v){var f=u[0],h=g[f.identifier];r(2*w.k),a(f,h),k(),l(p)}v=c}else if(u.length>1){var f=u[0],m=u[1],M=f[0]-m[0],C=f[1]-m[1];y=M*M+C*C}}function i(){for(var t,e,n,i,o=$o.touches(h),s=0,u=o.length;u>s;++s,i=null)if(n=o[s],i=g[n.identifier]){if(e)break;t=n,e=i}if(i){var c=(c=n[0]-t[0])*c+(c=n[1]-t[1])*c,d=y&&Math.sqrt(c/y);t=[(t[0]+n[0])/2,(t[1]+n[1])/2],e=[(e[0]+i[0])/2,(e[1]+i[1])/2],r(d*f)}v=null,a(t,e),l(p)}function d(){if($o.event.touches.length){for(var e=$o.event.changedTouches,n=0,r=e.length;r>n;++n)delete g[e[n].identifier];for(var a in g)return void t()}$o.selectAll(A).on(m,null),M.on(T,u).on(N,c),C(),s(p)}var f,h=this,p=D.of(h,arguments),g={},y=0,m=".zoom-"+$o.event.changedTouches[0].identifier,x="touchmove"+m,b="touchend"+m,A=[],M=$o.select(h),C=H();q.call(h),n(),o(p),M.on(T,null).on(N,n)}function d(){var t=D.of(this,arguments);y?clearTimeout(y):(h=e(p=g||$o.mouse(this)),q.call(this),o(t)),y=setTimeout(function(){y=null,s(t)},50),k(),r(Math.pow(2,.002*El())*w.k),a(p,h),l(t)}function f(){var t=D.of(this,arguments),n=$o.mouse(this),i=e(n),u=Math.log(w.k)/Math.LN2;o(t),r(Math.pow(2,$o.event.shiftKey?Math.ceil(u)-1:Math.floor(u)+1)),a(n,i),l(t),s(t)}var h,p,g,y,v,m,x,b,A,w={x:0,y:0,k:1},C=[960,500],S=Ol,T="mousedown.zoom",L="mousemove.zoom",_="mouseup.zoom",N="touchstart.zoom",D=M(t,"zoomstart","zoom","zoomend");return t.event=function(t){t.each(function(){var t=D.of(this,arguments),e=w;_u?$o.select(this).transition().each("start.zoom",function(){w=this.__chart__||{x:0,y:0,k:1},o(t)}).tween("zoom:zoom",function(){var n=C[0],r=C[1],a=n/2,i=r/2,o=$o.interpolateZoom([(a-w.x)/w.k,(i-w.y)/w.k,n/w.k],[(a-e.x)/e.k,(i-e.y)/e.k,n/e.k]);return function(e){var r=o(e),s=n/r[2];this.__chart__=w={x:a-r[0]*s,y:i-r[1]*s,k:s},l(t)}}).each("end.zoom",function(){s(t)}):(this.__chart__=w,o(t),l(t),s(t))})},t.translate=function(e){return arguments.length?(w={x:+e[0],y:+e[1],k:w.k},i(),t):[w.x,w.y]},t.scale=function(e){return arguments.length?(w={x:w.x,y:w.y,k:+e},i(),t):w.k},t.scaleExtent=function(e){return arguments.length?(S=null==e?Ol:[+e[0],+e[1]],t):S},t.center=function(e){return arguments.length?(g=e&&[+e[0],+e[1]],t):g},t.size=function(e){return arguments.length?(C=e&&[+e[0],+e[1]],t):C},t.x=function(e){return arguments.length?(x=e,m=e.copy(),w={x:0,y:0,k:1},t):x},t.y=function(e){return arguments.length?(A=e,b=e.copy(),w={x:0,y:0,k:1},t):A},$o.rebind(t,D,"on")};var El,Ol=[0,1/0],Rl="onwheel"in Ko?(El=function(){return-$o.event.deltaY*($o.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Ko?(El=function(){return $o.event.wheelDelta},"mousewheel"):(El=function(){return-$o.event.detail},"MozMousePixelScroll");$o.color=ie,ie.prototype.toString=function(){return this.rgb()+""},$o.hsl=oe;var Bl=oe.prototype=new ie;Bl.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new oe(this.h,this.s,this.l/t)},Bl.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new oe(this.h,this.s,t*this.l)},Bl.rgb=function(){return le(this.h,this.s,this.l)},$o.hcl=se;var Yl=se.prototype=new ie;Yl.brighter=function(t){return new se(this.h,this.c,Math.min(100,this.l+ql*(arguments.length?t:1)))},Yl.darker=function(t){return new se(this.h,this.c,Math.max(0,this.l-ql*(arguments.length?t:1)))},Yl.rgb=function(){return ue(this.h,this.c,this.l).rgb()},$o.lab=ce;var ql=18,Gl=.95047,jl=1,Ul=1.08883,Hl=ce.prototype=new ie;Hl.brighter=function(t){return new ce(Math.min(100,this.l+ql*(arguments.length?t:1)),this.a,this.b)},Hl.darker=function(t){return new ce(Math.max(0,this.l-ql*(arguments.length?t:1)),this.a,this.b)},Hl.rgb=function(){return de(this.l,this.a,this.b)},$o.rgb=ye;var Xl=ye.prototype=new ie;Xl.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,r=this.b,a=30;return e||n||r?(e&&a>e&&(e=a),n&&a>n&&(n=a),r&&a>r&&(r=a),new ye(Math.min(255,e/t),Math.min(255,n/t),Math.min(255,r/t))):new ye(a,a,a)},Xl.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new ye(t*this.r,t*this.g,t*this.b)},Xl.hsl=function(){return ke(this.r,this.g,this.b)},Xl.toString=function(){return"#"+xe(this.r)+xe(this.g)+xe(this.b)};var Wl=$o.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Wl.forEach(function(t,e){Wl.set(t,ve(e))}),$o.functor=Ce,$o.xhr=Te(Se),$o.dsv=function(t,e){function n(t,n,i){arguments.length<3&&(i=n,n=null);var o=Le(t,e,null==n?r:a(n),i);return o.row=function(t){return arguments.length?o.response(null==(n=t)?r:a(t)):n},o}function r(t){return n.parse(t.responseText)}function a(t){return function(e){return n.parse(e.responseText,t)}}function i(e){return e.map(o).join(t)}function o(t){return l.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var l=new RegExp('["'+t+"\n]"),s=t.charCodeAt(0);return n.parse=function(t,e){var r;return n.parseRows(t,function(t,n){if(r)return r(t,n-1);var a=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");r=e?function(t,n){return e(a(t),n)}:a})},n.parseRows=function(t,e){function n(){if(c>=u)return o;if(a)return a=!1,i;var e=c;if(34===t.charCodeAt(e)){for(var n=e;n++<u;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}c=n+2;var r=t.charCodeAt(n+1);return 13===r?(a=!0,10===t.charCodeAt(n+2)&&++c):10===r&&(a=!0),t.slice(e+1,n).replace(/""/g,'"')}for(;u>c;){var r=t.charCodeAt(c++),l=1;if(10===r)a=!0;else if(13===r)a=!0,10===t.charCodeAt(c)&&(++c,++l);else if(r!==s)continue;return t.slice(e,c-l)}return t.slice(e)}for(var r,a,i={},o={},l=[],u=t.length,c=0,d=0;(r=n())!==o;){for(var f=[];r!==i&&r!==o;)f.push(r),r=n();e&&null==(f=e(f,d++))||l.push(f)}return l},n.format=function(e){if(Array.isArray(e[0]))return n.formatRows(e);var r=new g,a=[];return e.forEach(function(t){for(var e in t)r.has(e)||a.push(r.add(e))}),[a.map(o).join(t)].concat(e.map(function(e){return a.map(function(t){return o(e[t])}).join(t)})).join("\n")},n.formatRows=function(t){return t.map(i).join("\n")},n},$o.csv=$o.dsv(",","text/csv"),$o.tsv=$o.dsv("	","text/tab-separated-values");var $l,Jl,Zl,Kl,Ql,ts=tl[v(tl,"requestAnimationFrame")]||function(t){setTimeout(t,17)};$o.timer=function(t,e,n){var r=arguments.length;2>r&&(e=0),3>r&&(n=Date.now());var a=n+e,i={c:t,t:a,f:!1,n:null};Jl?Jl.n=i:$l=i,Jl=i,Zl||(Kl=clearTimeout(Kl),Zl=1,ts(De))},$o.timer.flush=function(){Fe(),Ve()},$o.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var es=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(Pe);$o.formatPrefix=function(t,e){var n=0;return t&&(0>t&&(t*=-1),e&&(t=$o.round(t,Ie(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),es[8+n/3]};var ns=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,rs=$o.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=$o.round(t,Ie(t,e))).toFixed(Math.max(0,Math.min(20,Ie(t*(1+1e-15),e))))}}),as=$o.time={},is=Date;Oe.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){os.setUTCDate.apply(this._,arguments)},setDay:function(){os.setUTCDay.apply(this._,arguments)},setFullYear:function(){os.setUTCFullYear.apply(this._,arguments)},setHours:function(){os.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){os.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){os.setUTCMinutes.apply(this._,arguments)},setMonth:function(){os.setUTCMonth.apply(this._,arguments)},setSeconds:function(){os.setUTCSeconds.apply(this._,arguments)},setTime:function(){os.setTime.apply(this._,arguments)}};var os=Date.prototype;as.year=Re(function(t){return t=as.day(t),t.setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),as.years=as.year.range,as.years.utc=as.year.utc.range,as.day=Re(function(t){var e=new is(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),as.days=as.day.range,as.days.utc=as.day.utc.range,as.dayOfYear=function(t){var e=as.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var n=as[t]=Re(function(t){return(t=as.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var n=as.year(t).getDay();return Math.floor((as.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});as[t+"s"]=n.range,as[t+"s"].utc=n.utc.range,as[t+"OfYear"]=function(t){var n=as.year(t).getDay();return Math.floor((as.dayOfYear(t)+(n+e)%7)/7)}}),as.week=as.sunday,as.weeks=as.sunday.range,as.weeks.utc=as.sunday.utc.range,as.weekOfYear=as.sundayOfYear;var ls={"-":"",_:" ",0:"0"},ss=/^\s*\d+/,us=/^%/;$o.locale=function(t){return{numberFormat:ze(t),timeFormat:Ye(t)}};var cs=$o.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});$o.format=cs.numberFormat,$o.geo={},un.prototype={s:0,t:0,add:function(t){cn(t,this.t,ds),cn(ds.s,this.s,this),this.s?this.t+=ds.t:this.s=ds.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ds=new un;$o.geo.stream=function(t,e){t&&fs.hasOwnProperty(t.type)?fs[t.type](t,e):dn(t,e)};var fs={Feature:function(t,e){dn(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,a=n.length;++r<a;)dn(n[r].geometry,e)}},hs={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){fn(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)fn(n[r],e,0)},Polygon:function(t,e){hn(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)hn(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,a=n.length;++r<a;)dn(n[r],e)}};$o.geo.area=function(t){return ps=0,$o.geo.stream(t,ys),ps};var ps,gs=new un,ys={sphere:function(){ps+=4*Tl},point:m,lineStart:m,lineEnd:m,polygonStart:function(){gs.reset(),ys.lineStart=pn},polygonEnd:function(){var t=2*gs;ps+=0>t?4*Tl+t:t,ys.lineStart=ys.lineEnd=ys.point=m}};$o.geo.bounds=function(){function t(t,e){x.push(b=[c=t,f=t]),d>e&&(d=e),e>h&&(h=e)}function e(e,n){var r=gn([e*Fl,n*Fl]);if(v){var a=vn(v,r),i=[a[1],-a[0],0],o=vn(i,a);bn(o),o=kn(o);var s=e-p,u=s>0?1:-1,g=o[0]*Vl*u,y=ul(s)>180;if(y^(g>u*p&&u*e>g)){var m=o[1]*Vl;m>h&&(h=m)}else if(g=(g+360)%360-180,y^(g>u*p&&u*e>g)){var m=-o[1]*Vl;d>m&&(d=m)}else d>n&&(d=n),n>h&&(h=n);y?p>e?l(c,e)>l(c,f)&&(f=e):l(e,f)>l(c,f)&&(c=e):f>=c?(c>e&&(c=e),e>f&&(f=e)):e>p?l(c,e)>l(c,f)&&(f=e):l(e,f)>l(c,f)&&(c=e)
}else t(e,n);v=r,p=e}function n(){k.point=e}function r(){b[0]=c,b[1]=f,k.point=t,v=null}function a(t,n){if(v){var r=t-p;m+=ul(r)>180?r+(r>0?360:-360):r}else g=t,y=n;ys.point(t,n),e(t,n)}function i(){ys.lineStart()}function o(){a(g,y),ys.lineEnd(),ul(m)>Nl&&(c=-(f=180)),b[0]=c,b[1]=f,v=null}function l(t,e){return(e-=t)<0?e+360:e}function s(t,e){return t[0]-e[0]}function u(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var c,d,f,h,p,g,y,v,m,x,b,k={point:t,lineStart:n,lineEnd:r,polygonStart:function(){k.point=a,k.lineStart=i,k.lineEnd=o,m=0,ys.polygonStart()},polygonEnd:function(){ys.polygonEnd(),k.point=t,k.lineStart=n,k.lineEnd=r,0>gs?(c=-(f=180),d=-(h=90)):m>Nl?h=90:-Nl>m&&(d=-90),b[0]=c,b[1]=f}};return function(t){h=f=-(c=d=1/0),x=[],$o.geo.stream(t,k);var e=x.length;if(e){x.sort(s);for(var n,r=1,a=x[0],i=[a];e>r;++r)n=x[r],u(n[0],a)||u(n[1],a)?(l(a[0],n[1])>l(a[0],a[1])&&(a[1]=n[1]),l(n[0],a[1])>l(a[0],a[1])&&(a[0]=n[0])):i.push(a=n);for(var o,n,p=-1/0,e=i.length-1,r=0,a=i[e];e>=r;a=n,++r)n=i[r],(o=l(a[1],n[0]))>p&&(p=o,c=n[0],f=a[1])}return x=b=null,1/0===c||1/0===d?[[0/0,0/0],[0/0,0/0]]:[[c,d],[f,h]]}}(),$o.geo.centroid=function(t){vs=ms=xs=bs=ks=As=Ms=ws=Cs=Ss=Ts=0,$o.geo.stream(t,Ls);var e=Cs,n=Ss,r=Ts,a=e*e+n*n+r*r;return Dl>a&&(e=As,n=Ms,r=ws,Nl>ms&&(e=xs,n=bs,r=ks),a=e*e+n*n+r*r,Dl>a)?[0/0,0/0]:[Math.atan2(n,e)*Vl,te(r/Math.sqrt(a))*Vl]};var vs,ms,xs,bs,ks,As,Ms,ws,Cs,Ss,Ts,Ls={sphere:m,point:Mn,lineStart:Cn,lineEnd:Sn,polygonStart:function(){Ls.lineStart=Tn},polygonEnd:function(){Ls.lineStart=Cn}},_s=Fn(Ln,zn,On,[-Tl,-Tl/2]),Ns=1e9;$o.geo.clipExtent=function(){var t,e,n,r,a,i,o={stream:function(t){return a&&(a.valid=!1),a=i(t),a.valid=!0,a},extent:function(l){return arguments.length?(i=qn(t=+l[0][0],e=+l[0][1],n=+l[1][0],r=+l[1][1]),a&&(a.valid=!1,a=null),o):[[t,e],[n,r]]}};return o.extent([[0,0],[960,500]])},($o.geo.conicEqualArea=function(){return jn(Un)}).raw=Un,$o.geo.albers=function(){return $o.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},$o.geo.albersUsa=function(){function t(t){var i=t[0],o=t[1];return e=null,n(i,o),e||(r(i,o),e)||a(i,o),e}var e,n,r,a,i=$o.geo.albers(),o=$o.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=$o.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s={point:function(t,n){e=[t,n]}};return t.invert=function(t){var e=i.scale(),n=i.translate(),r=(t[0]-n[0])/e,a=(t[1]-n[1])/e;return(a>=.12&&.234>a&&r>=-.425&&-.214>r?o:a>=.166&&.234>a&&r>=-.214&&-.115>r?l:i).invert(t)},t.stream=function(t){var e=i.stream(t),n=o.stream(t),r=l.stream(t);return{point:function(t,a){e.point(t,a),n.point(t,a),r.point(t,a)},sphere:function(){e.sphere(),n.sphere(),r.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),r.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),r.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),r.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),r.polygonEnd()}}},t.precision=function(e){return arguments.length?(i.precision(e),o.precision(e),l.precision(e),t):i.precision()},t.scale=function(e){return arguments.length?(i.scale(e),o.scale(.35*e),l.scale(e),t.translate(i.translate())):i.scale()},t.translate=function(e){if(!arguments.length)return i.translate();var u=i.scale(),c=+e[0],d=+e[1];return n=i.translate(e).clipExtent([[c-.455*u,d-.238*u],[c+.455*u,d+.238*u]]).stream(s).point,r=o.translate([c-.307*u,d+.201*u]).clipExtent([[c-.425*u+Nl,d+.12*u+Nl],[c-.214*u-Nl,d+.234*u-Nl]]).stream(s).point,a=l.translate([c-.205*u,d+.212*u]).clipExtent([[c-.214*u+Nl,d+.166*u+Nl],[c-.115*u-Nl,d+.234*u-Nl]]).stream(s).point,t},t.scale(1070)};var Ds,Fs,Vs,Is,Ps,zs,Es={point:m,lineStart:m,lineEnd:m,polygonStart:function(){Fs=0,Es.lineStart=Hn},polygonEnd:function(){Es.lineStart=Es.lineEnd=Es.point=m,Ds+=ul(Fs/2)}},Os={point:Xn,lineStart:m,lineEnd:m,polygonStart:m,polygonEnd:m},Rs={point:Jn,lineStart:Zn,lineEnd:Kn,polygonStart:function(){Rs.lineStart=Qn},polygonEnd:function(){Rs.point=Jn,Rs.lineStart=Zn,Rs.lineEnd=Kn}};$o.geo.path=function(){function t(t){return t&&("function"==typeof l&&i.pointRadius(+l.apply(this,arguments)),o&&o.valid||(o=a(i)),$o.geo.stream(t,o)),i.result()}function e(){return o=null,t}var n,r,a,i,o,l=4.5;return t.area=function(t){return Ds=0,$o.geo.stream(t,a(Es)),Ds},t.centroid=function(t){return xs=bs=ks=As=Ms=ws=Cs=Ss=Ts=0,$o.geo.stream(t,a(Rs)),Ts?[Cs/Ts,Ss/Ts]:ws?[As/ws,Ms/ws]:ks?[xs/ks,bs/ks]:[0/0,0/0]},t.bounds=function(t){return Ps=zs=-(Vs=Is=1/0),$o.geo.stream(t,a(Os)),[[Vs,Is],[Ps,zs]]},t.projection=function(t){return arguments.length?(a=(n=t)?t.stream||nr(t):Se,e()):n},t.context=function(t){return arguments.length?(i=null==(r=t)?new Wn:new tr(t),"function"!=typeof l&&i.pointRadius(l),e()):r},t.pointRadius=function(e){return arguments.length?(l="function"==typeof e?e:(i.pointRadius(+e),+e),t):l},t.projection($o.geo.albersUsa()).context(null)},$o.geo.transform=function(t){return{stream:function(e){var n=new rr(e);for(var r in t)n[r]=t[r];return n}}},rr.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},$o.geo.projection=ir,$o.geo.projectionMutator=or,($o.geo.equirectangular=function(){return ir(sr)}).raw=sr.invert=sr,$o.geo.rotation=function(t){function e(e){return e=t(e[0]*Fl,e[1]*Fl),e[0]*=Vl,e[1]*=Vl,e}return t=cr(t[0]%360*Fl,t[1]*Fl,t.length>2?t[2]*Fl:0),e.invert=function(e){return e=t.invert(e[0]*Fl,e[1]*Fl),e[0]*=Vl,e[1]*=Vl,e},e},ur.invert=sr,$o.geo.circle=function(){function t(){var t="function"==typeof r?r.apply(this,arguments):r,e=cr(-t[0]*Fl,-t[1]*Fl,0).invert,a=[];return n(null,null,1,{point:function(t,n){a.push(t=e(t,n)),t[0]*=Vl,t[1]*=Vl}}),{type:"Polygon",coordinates:[a]}}var e,n,r=[0,0],a=6;return t.origin=function(e){return arguments.length?(r=e,t):r},t.angle=function(r){return arguments.length?(n=pr((e=+r)*Fl,a*Fl),t):e},t.precision=function(r){return arguments.length?(n=pr(e*Fl,(a=+r)*Fl),t):a},t.angle(90)},$o.geo.distance=function(t,e){var n,r=(e[0]-t[0])*Fl,a=t[1]*Fl,i=e[1]*Fl,o=Math.sin(r),l=Math.cos(r),s=Math.sin(a),u=Math.cos(a),c=Math.sin(i),d=Math.cos(i);return Math.atan2(Math.sqrt((n=d*o)*n+(n=u*c-s*d*l)*n),s*c+u*d*l)},$o.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return $o.range(Math.ceil(i/y)*y,a,y).map(f).concat($o.range(Math.ceil(u/v)*v,s,v).map(h)).concat($o.range(Math.ceil(r/p)*p,n,p).filter(function(t){return ul(t%y)>Nl}).map(c)).concat($o.range(Math.ceil(l/g)*g,o,g).filter(function(t){return ul(t%v)>Nl}).map(d))}var n,r,a,i,o,l,s,u,c,d,f,h,p=10,g=p,y=90,v=360,m=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[f(i).concat(h(s).slice(1),f(a).reverse().slice(1),h(u).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.majorExtent(e).minorExtent(e):t.minorExtent()},t.majorExtent=function(e){return arguments.length?(i=+e[0][0],a=+e[1][0],u=+e[0][1],s=+e[1][1],i>a&&(e=i,i=a,a=e),u>s&&(e=u,u=s,s=e),t.precision(m)):[[i,u],[a,s]]},t.minorExtent=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],l=+e[0][1],o=+e[1][1],r>n&&(e=r,r=n,n=e),l>o&&(e=l,l=o,o=e),t.precision(m)):[[r,l],[n,o]]},t.step=function(e){return arguments.length?t.majorStep(e).minorStep(e):t.minorStep()},t.majorStep=function(e){return arguments.length?(y=+e[0],v=+e[1],t):[y,v]},t.minorStep=function(e){return arguments.length?(p=+e[0],g=+e[1],t):[p,g]},t.precision=function(e){return arguments.length?(m=+e,c=yr(l,o,90),d=vr(r,n,m),f=yr(u,s,90),h=vr(i,a,m),t):m},t.majorExtent([[-180,-90+Nl],[180,90-Nl]]).minorExtent([[-180,-80-Nl],[180,80+Nl]])},$o.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||r.apply(this,arguments),n||a.apply(this,arguments)]}}var e,n,r=mr,a=xr;return t.distance=function(){return $o.geo.distance(e||r.apply(this,arguments),n||a.apply(this,arguments))},t.source=function(n){return arguments.length?(r=n,e="function"==typeof n?null:n,t):r},t.target=function(e){return arguments.length?(a=e,n="function"==typeof e?null:e,t):a},t.precision=function(){return arguments.length?t:0},t},$o.geo.interpolate=function(t,e){return br(t[0]*Fl,t[1]*Fl,e[0]*Fl,e[1]*Fl)},$o.geo.length=function(t){return Bs=0,$o.geo.stream(t,Ys),Bs};var Bs,Ys={sphere:m,point:m,lineStart:kr,lineEnd:m,polygonStart:m,polygonEnd:m},qs=Ar(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});($o.geo.azimuthalEqualArea=function(){return ir(qs)}).raw=qs;var Gs=Ar(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},Se);($o.geo.azimuthalEquidistant=function(){return ir(Gs)}).raw=Gs,($o.geo.conicConformal=function(){return jn(Mr)}).raw=Mr,($o.geo.conicEquidistant=function(){return jn(wr)}).raw=wr;var js=Ar(function(t){return 1/t},Math.atan);($o.geo.gnomonic=function(){return ir(js)}).raw=js,Cr.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-_l]},($o.geo.mercator=function(){return Sr(Cr)}).raw=Cr;var Us=Ar(function(){return 1},Math.asin);($o.geo.orthographic=function(){return ir(Us)}).raw=Us;var Hs=Ar(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});($o.geo.stereographic=function(){return ir(Hs)}).raw=Hs,Tr.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-_l]},($o.geo.transverseMercator=function(){var t=Sr(Tr),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return t?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])},n([0,0,90])}).raw=Tr,$o.geom={},$o.geom.hull=function(t){function e(t){if(t.length<3)return[];var e,a=Ce(n),i=Ce(r),o=t.length,l=[],s=[];for(e=0;o>e;e++)l.push([+a.call(this,t[e],e),+i.call(this,t[e],e),e]);for(l.sort(Dr),e=0;o>e;e++)s.push([l[e][0],-l[e][1]]);var u=Nr(l),c=Nr(s),d=c[0]===u[0],f=c[c.length-1]===u[u.length-1],h=[];for(e=u.length-1;e>=0;--e)h.push(t[l[u[e]][2]]);for(e=+d;e<c.length-f;++e)h.push(t[l[c[e]][2]]);return h}var n=Lr,r=_r;return arguments.length?e(t):(e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(r=t,e):r},e)},$o.geom.polygon=function(t){return pl(t,Xs),t};var Xs=$o.geom.polygon.prototype=[];Xs.area=function(){for(var t,e=-1,n=this.length,r=this[n-1],a=0;++e<n;)t=r,r=this[e],a+=t[1]*r[0]-t[0]*r[1];return.5*a},Xs.centroid=function(t){var e,n,r=-1,a=this.length,i=0,o=0,l=this[a-1];for(arguments.length||(t=-1/(6*this.area()));++r<a;)e=l,l=this[r],n=e[0]*l[1]-l[0]*e[1],i+=(e[0]+l[0])*n,o+=(e[1]+l[1])*n;return[i*t,o*t]},Xs.clip=function(t){for(var e,n,r,a,i,o,l=Ir(t),s=-1,u=this.length-Ir(this),c=this[u-1];++s<u;){for(e=t.slice(),t.length=0,a=this[s],i=e[(r=e.length-l)-1],n=-1;++n<r;)o=e[n],Fr(o,c,a)?(Fr(i,c,a)||t.push(Vr(i,o,c,a)),t.push(o)):Fr(i,c,a)&&t.push(Vr(i,o,c,a)),i=o;l&&t.push(t[0]),c=a}return t};var Ws,$s,Js,Zs,Ks,Qs=[],tu=[];qr.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)t=e[n].edge,t.b&&t.a||e.splice(n,1);return e.sort(jr),e.length},ta.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},ea.prototype={insert:function(t,e){var n,r,a;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=ia(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)r=n.U,n===r.L?(a=r.R,a&&a.C?(n.C=a.C=!1,r.C=!0,t=r):(t===n.R&&(ra(this,n),t=n,n=t.U),n.C=!1,r.C=!0,aa(this,r))):(a=r.L,a&&a.C?(n.C=a.C=!1,r.C=!0,t=r):(t===n.L&&(aa(this,n),t=n,n=t.U),n.C=!1,r.C=!0,ra(this,r))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,a=t.U,i=t.L,o=t.R;if(n=i?o?ia(o):i:o,a?a.L===t?a.L=n:a.R=n:this._=n,i&&o?(r=n.C,n.C=t.C,n.L=i,i.U=n,n!==o?(a=n.U,n.U=t.U,t=n.R,a.L=t,n.R=o,o.U=n):(n.U=a,a=n,t=n.R)):(r=t.C,t=n),t&&(t.U=a),!r){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===a.L){if(e=a.R,e.C&&(e.C=!1,a.C=!0,ra(this,a),e=a.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,aa(this,e),e=a.R),e.C=a.C,a.C=e.R.C=!1,ra(this,a),t=this._;break}}else if(e=a.L,e.C&&(e.C=!1,a.C=!0,aa(this,a),e=a.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,ra(this,e),e=a.L),e.C=a.C,a.C=e.L.C=!1,aa(this,a),t=this._;break}e.C=!0,t=a,a=a.U}while(!t.C);t&&(t.C=!1)}}},$o.geom.voronoi=function(t){function e(t){var e=new Array(t.length),r=l[0][0],a=l[0][1],i=l[1][0],o=l[1][1];return oa(n(t),l).cells.forEach(function(n,l){var s=n.edges,u=n.site,c=e[l]=s.length?s.map(function(t){var e=t.start();return[e.x,e.y]}):u.x>=r&&u.x<=i&&u.y>=a&&u.y<=o?[[r,o],[i,o],[i,a],[r,a]]:[];c.point=t[l]}),e}function n(t){return t.map(function(t,e){return{x:Math.round(i(t,e)/Nl)*Nl,y:Math.round(o(t,e)/Nl)*Nl,i:e}})}var r=Lr,a=_r,i=r,o=a,l=eu;return t?e(t):(e.links=function(t){return oa(n(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},e.triangles=function(t){var e=[];return oa(n(t)).cells.forEach(function(n,r){for(var a,i,o=n.site,l=n.edges.sort(jr),s=-1,u=l.length,c=l[u-1].edge,d=c.l===o?c.r:c.l;++s<u;)a=c,i=d,c=l[s].edge,d=c.l===o?c.r:c.l,r<i.i&&r<d.i&&sa(o,i,d)<0&&e.push([t[r],t[i.i],t[d.i]])}),e},e.x=function(t){return arguments.length?(i=Ce(r=t),e):r},e.y=function(t){return arguments.length?(o=Ce(a=t),e):a},e.clipExtent=function(t){return arguments.length?(l=null==t?eu:t,e):l===eu?null:l},e.size=function(t){return arguments.length?e.clipExtent(t&&[[0,0],t]):l===eu?null:l&&l[1]},e)};var eu=[[-1e6,-1e6],[1e6,1e6]];$o.geom.delaunay=function(t){return $o.geom.voronoi().triangles(t)},$o.geom.quadtree=function(t,e,n,r,a){function i(t){function i(t,e,n,r,a,i,o,l){if(!isNaN(n)&&!isNaN(r))if(t.leaf){var s=t.x,c=t.y;if(null!=s)if(ul(s-n)+ul(c-r)<.01)u(t,e,n,r,a,i,o,l);else{var d=t.point;t.x=t.y=t.point=null,u(t,d,s,c,a,i,o,l),u(t,e,n,r,a,i,o,l)}else t.x=n,t.y=r,t.point=e}else u(t,e,n,r,a,i,o,l)}function u(t,e,n,r,a,o,l,s){var u=.5*(a+l),c=.5*(o+s),d=n>=u,f=r>=c,h=(f<<1)+d;t.leaf=!1,t=t.nodes[h]||(t.nodes[h]=da()),d?a=u:l=u,f?o=c:s=c,i(t,e,n,r,a,o,l,s)}var c,d,f,h,p,g,y,v,m,x=Ce(l),b=Ce(s);if(null!=e)g=e,y=n,v=r,m=a;else if(v=m=-(g=y=1/0),d=[],f=[],p=t.length,o)for(h=0;p>h;++h)c=t[h],c.x<g&&(g=c.x),c.y<y&&(y=c.y),c.x>v&&(v=c.x),c.y>m&&(m=c.y),d.push(c.x),f.push(c.y);else for(h=0;p>h;++h){var k=+x(c=t[h],h),A=+b(c,h);g>k&&(g=k),y>A&&(y=A),k>v&&(v=k),A>m&&(m=A),d.push(k),f.push(A)}var M=v-g,w=m-y;M>w?m=y+M:v=g+w;var C=da();if(C.add=function(t){i(C,t,+x(t,++h),+b(t,h),g,y,v,m)},C.visit=function(t){fa(t,C,g,y,v,m)},h=-1,null==e){for(;++h<p;)i(C,t[h],d[h],f[h],g,y,v,m);--h}else t.forEach(C.add);return d=f=t=c=null,C}var o,l=Lr,s=_r;return(o=arguments.length)?(l=ua,s=ca,3===o&&(a=n,r=e,n=e=0),i(t)):(i.x=function(t){return arguments.length?(l=t,i):l},i.y=function(t){return arguments.length?(s=t,i):s},i.extent=function(t){return arguments.length?(null==t?e=n=r=a=null:(e=+t[0][0],n=+t[0][1],r=+t[1][0],a=+t[1][1]),i):null==e?null:[[e,n],[r,a]]},i.size=function(t){return arguments.length?(null==t?e=n=r=a=null:(e=n=0,r=+t[0],a=+t[1]),i):null==e?null:[r-e,a-n]},i)},$o.interpolateRgb=ha,$o.interpolateObject=pa,$o.interpolateNumber=ga,$o.interpolateString=ya;var nu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ru=new RegExp(nu.source,"g");$o.interpolate=va,$o.interpolators=[function(t,e){var n=typeof e;return("string"===n?Wl.has(e)||/^(#|rgb\(|hsl\()/.test(e)?ha:ya:e instanceof ie?ha:Array.isArray(e)?ma:"object"===n&&isNaN(e)?pa:ga)(t,e)}],$o.interpolateArray=ma;var au=function(){return Se},iu=$o.map({linear:au,poly:Ca,quad:function(){return Aa},cubic:function(){return Ma},sin:function(){return Sa},exp:function(){return Ta},circle:function(){return La},elastic:_a,back:Na,bounce:function(){return Da}}),ou=$o.map({"in":Se,out:ba,"in-out":ka,"out-in":function(t){return ka(ba(t))}});$o.ease=function(t){var e=t.indexOf("-"),n=e>=0?t.slice(0,e):t,r=e>=0?t.slice(e+1):"in";return n=iu.get(n)||au,r=ou.get(r)||Se,xa(r(n.apply(null,Jo.call(arguments,1))))},$o.interpolateHcl=Fa,$o.interpolateHsl=Va,$o.interpolateLab=Ia,$o.interpolateRound=Pa,$o.transform=function(t){var e=Ko.createElementNS($o.ns.prefix.svg,"g");return($o.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new za(n?n.matrix:lu)})(t)},za.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var lu={a:1,b:0,c:0,d:1,e:0,f:0};$o.interpolateTransform=Ba,$o.layout={},$o.layout.bundle=function(){return function(t){for(var e=[],n=-1,r=t.length;++n<r;)e.push(Ga(t[n]));return e}},$o.layout.chord=function(){function t(){var t,u,d,f,h,p={},g=[],y=$o.range(i),v=[];for(n=[],r=[],t=0,f=-1;++f<i;){for(u=0,h=-1;++h<i;)u+=a[f][h];g.push(u),v.push($o.range(i)),t+=u}for(o&&y.sort(function(t,e){return o(g[t],g[e])}),l&&v.forEach(function(t,e){t.sort(function(t,n){return l(a[e][t],a[e][n])})}),t=(Ll-c*i)/t,u=0,f=-1;++f<i;){for(d=u,h=-1;++h<i;){var m=y[f],x=v[m][h],b=a[m][x],k=u,A=u+=b*t;p[m+"-"+x]={index:m,subindex:x,startAngle:k,endAngle:A,value:b}}r[m]={index:m,startAngle:d,endAngle:u,value:(u-d)/t},u+=c}for(f=-1;++f<i;)for(h=f-1;++h<i;){var M=p[f+"-"+h],w=p[h+"-"+f];(M.value||w.value)&&n.push(M.value<w.value?{source:w,target:M}:{source:M,target:w})}s&&e()}function e(){n.sort(function(t,e){return s((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var n,r,a,i,o,l,s,u={},c=0;return u.matrix=function(t){return arguments.length?(i=(a=t)&&a.length,n=r=null,u):a},u.padding=function(t){return arguments.length?(c=t,n=r=null,u):c},u.sortGroups=function(t){return arguments.length?(o=t,n=r=null,u):o},u.sortSubgroups=function(t){return arguments.length?(l=t,n=null,u):l},u.sortChords=function(t){return arguments.length?(s=t,n&&e(),u):s},u.chords=function(){return n||t(),n},u.groups=function(){return r||t(),r},u},$o.layout.force=function(){function t(t){return function(e,n,r,a){if(e.point!==t){var i=e.cx-t.x,o=e.cy-t.y,l=a-n,s=i*i+o*o;if(s>l*l/y){if(p>s){var u=e.charge/s;t.px-=i*u,t.py-=o*u}return!0}if(e.point&&s&&p>s){var u=e.pointCharge/s;t.px-=i*u,t.py-=o*u}}return!e.charge}}function e(t){t.px=$o.event.x,t.py=$o.event.y,l.resume()}var n,r,a,i,o,l={},s=$o.dispatch("start","tick","end"),u=[1,1],c=.9,d=su,f=uu,h=-30,p=cu,g=.1,y=.64,v=[],m=[];return l.tick=function(){if((r*=.99)<.005)return s.end({type:"end",alpha:r=0}),!0;var e,n,l,d,f,p,y,x,b,k=v.length,A=m.length;for(n=0;A>n;++n)l=m[n],d=l.source,f=l.target,x=f.x-d.x,b=f.y-d.y,(p=x*x+b*b)&&(p=r*i[n]*((p=Math.sqrt(p))-a[n])/p,x*=p,b*=p,f.x-=x*(y=d.weight/(f.weight+d.weight)),f.y-=b*y,d.x+=x*(y=1-y),d.y+=b*y);if((y=r*g)&&(x=u[0]/2,b=u[1]/2,n=-1,y))for(;++n<k;)l=v[n],l.x+=(x-l.x)*y,l.y+=(b-l.y)*y;if(h)for(Ja(e=$o.geom.quadtree(v),r,o),n=-1;++n<k;)(l=v[n]).fixed||e.visit(t(l));for(n=-1;++n<k;)l=v[n],l.fixed?(l.x=l.px,l.y=l.py):(l.x-=(l.px-(l.px=l.x))*c,l.y-=(l.py-(l.py=l.y))*c);s.tick({type:"tick",alpha:r})},l.nodes=function(t){return arguments.length?(v=t,l):v},l.links=function(t){return arguments.length?(m=t,l):m},l.size=function(t){return arguments.length?(u=t,l):u},l.linkDistance=function(t){return arguments.length?(d="function"==typeof t?t:+t,l):d},l.distance=l.linkDistance,l.linkStrength=function(t){return arguments.length?(f="function"==typeof t?t:+t,l):f},l.friction=function(t){return arguments.length?(c=+t,l):c},l.charge=function(t){return arguments.length?(h="function"==typeof t?t:+t,l):h},l.chargeDistance=function(t){return arguments.length?(p=t*t,l):Math.sqrt(p)},l.gravity=function(t){return arguments.length?(g=+t,l):g},l.theta=function(t){return arguments.length?(y=t*t,l):Math.sqrt(y)},l.alpha=function(t){return arguments.length?(t=+t,r?r=t>0?t:0:t>0&&(s.start({type:"start",alpha:r=t}),$o.timer(l.tick)),l):r},l.start=function(){function t(t,r){if(!n){for(n=new Array(s),l=0;s>l;++l)n[l]=[];for(l=0;u>l;++l){var a=m[l];n[a.source.index].push(a.target),n[a.target.index].push(a.source)}}for(var i,o=n[e],l=-1,u=o.length;++l<u;)if(!isNaN(i=o[l][t]))return i;return Math.random()*r}var e,n,r,s=v.length,c=m.length,p=u[0],g=u[1];for(e=0;s>e;++e)(r=v[e]).index=e,r.weight=0;for(e=0;c>e;++e)r=m[e],"number"==typeof r.source&&(r.source=v[r.source]),"number"==typeof r.target&&(r.target=v[r.target]),++r.source.weight,++r.target.weight;for(e=0;s>e;++e)r=v[e],isNaN(r.x)&&(r.x=t("x",p)),isNaN(r.y)&&(r.y=t("y",g)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(a=[],"function"==typeof d)for(e=0;c>e;++e)a[e]=+d.call(this,m[e],e);else for(e=0;c>e;++e)a[e]=d;if(i=[],"function"==typeof f)for(e=0;c>e;++e)i[e]=+f.call(this,m[e],e);else for(e=0;c>e;++e)i[e]=f;if(o=[],"function"==typeof h)for(e=0;s>e;++e)o[e]=+h.call(this,v[e],e);else for(e=0;s>e;++e)o[e]=h;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){return n||(n=$o.behavior.drag().origin(Se).on("dragstart.force",Ha).on("drag.force",e).on("dragend.force",Xa)),arguments.length?void this.on("mouseover.force",Wa).on("mouseout.force",$a).call(n):n},$o.rebind(l,s,"on")};var su=20,uu=1,cu=1/0;$o.layout.hierarchy=function(){function t(a){var i,o=[a],l=[];for(a.depth=0;null!=(i=o.pop());)if(l.push(i),(u=n.call(t,i,i.depth))&&(s=u.length)){for(var s,u,c;--s>=0;)o.push(c=u[s]),c.parent=i,c.depth=i.depth+1;r&&(i.value=0),i.children=u}else r&&(i.value=+r.call(t,i,i.depth)||0),delete i.children;return Qa(a,function(t){var n,a;e&&(n=t.children)&&n.sort(e),r&&(a=t.parent)&&(a.value+=t.value)}),l}var e=ni,n=ti,r=ei;return t.sort=function(n){return arguments.length?(e=n,t):e},t.children=function(e){return arguments.length?(n=e,t):n},t.value=function(e){return arguments.length?(r=e,t):r},t.revalue=function(e){return r&&(Ka(e,function(t){t.children&&(t.value=0)}),Qa(e,function(e){var n;e.children||(e.value=+r.call(t,e,e.depth)||0),(n=e.parent)&&(n.value+=e.value)})),e},t},$o.layout.partition=function(){function t(e,n,r,a){var i=e.children;if(e.x=n,e.y=e.depth*a,e.dx=r,e.dy=a,i&&(o=i.length)){var o,l,s,u=-1;for(r=e.value?r/e.value:0;++u<o;)t(l=i[u],n,s=l.value*r,a),n+=s}}function e(t){var n=t.children,r=0;if(n&&(a=n.length))for(var a,i=-1;++i<a;)r=Math.max(r,e(n[i]));return 1+r}function n(n,i){var o=r.call(this,n,i);return t(o[0],0,a[0],a[1]/e(o[0])),o}var r=$o.layout.hierarchy(),a=[1,1];return n.size=function(t){return arguments.length?(a=t,n):a},Za(n,r)},$o.layout.pie=function(){function t(i){var o=i.map(function(n,r){return+e.call(t,n,r)}),l=+("function"==typeof r?r.apply(this,arguments):r),s=(("function"==typeof a?a.apply(this,arguments):a)-l)/$o.sum(o),u=$o.range(i.length);null!=n&&u.sort(n===du?function(t,e){return o[e]-o[t]}:function(t,e){return n(i[t],i[e])});var c=[];return u.forEach(function(t){var e;c[t]={data:i[t],value:e=o[t],startAngle:l,endAngle:l+=e*s}}),c}var e=Number,n=du,r=0,a=Ll;return t.value=function(n){return arguments.length?(e=n,t):e},t.sort=function(e){return arguments.length?(n=e,t):n},t.startAngle=function(e){return arguments.length?(r=e,t):r},t.endAngle=function(e){return arguments.length?(a=e,t):a},t};var du={};$o.layout.stack=function(){function t(l,s){if(!(f=l.length))return l;var u=l.map(function(n,r){return e.call(t,n,r)}),c=u.map(function(e){return e.map(function(e,n){return[i.call(t,e,n),o.call(t,e,n)]})}),d=n.call(t,c,s);u=$o.permute(u,d),c=$o.permute(c,d);var f,h,p,g,y=r.call(t,c,s),v=u[0].length;for(p=0;v>p;++p)for(a.call(t,u[0][p],g=y[p],c[0][p][1]),h=1;f>h;++h)a.call(t,u[h][p],g+=c[h-1][p][1],c[h][p][1]);return l}var e=Se,n=li,r=si,a=oi,i=ai,o=ii;return t.values=function(n){return arguments.length?(e=n,t):e},t.order=function(e){return arguments.length?(n="function"==typeof e?e:fu.get(e)||li,t):n},t.offset=function(e){return arguments.length?(r="function"==typeof e?e:hu.get(e)||si,t):r},t.x=function(e){return arguments.length?(i=e,t):i},t.y=function(e){return arguments.length?(o=e,t):o},t.out=function(e){return arguments.length?(a=e,t):a},t};var fu=$o.map({"inside-out":function(t){var e,n,r=t.length,a=t.map(ui),i=t.map(ci),o=$o.range(r).sort(function(t,e){return a[t]-a[e]}),l=0,s=0,u=[],c=[];for(e=0;r>e;++e)n=o[e],s>l?(l+=i[n],u.push(n)):(s+=i[n],c.push(n));return c.reverse().concat(u)},reverse:function(t){return $o.range(t.length).reverse()},"default":li}),hu=$o.map({silhouette:function(t){var e,n,r,a=t.length,i=t[0].length,o=[],l=0,s=[];for(n=0;i>n;++n){for(e=0,r=0;a>e;e++)r+=t[e][n][1];r>l&&(l=r),o.push(r)}for(n=0;i>n;++n)s[n]=(l-o[n])/2;return s},wiggle:function(t){var e,n,r,a,i,o,l,s,u,c=t.length,d=t[0],f=d.length,h=[];for(h[0]=s=u=0,n=1;f>n;++n){for(e=0,a=0;c>e;++e)a+=t[e][n][1];for(e=0,i=0,l=d[n][0]-d[n-1][0];c>e;++e){for(r=0,o=(t[e][n][1]-t[e][n-1][1])/(2*l);e>r;++r)o+=(t[r][n][1]-t[r][n-1][1])/l;i+=o*t[e][n][1]}h[n]=s-=a?i/a*l:0,u>s&&(u=s)}for(n=0;f>n;++n)h[n]-=u;return h},expand:function(t){var e,n,r,a=t.length,i=t[0].length,o=1/a,l=[];for(n=0;i>n;++n){for(e=0,r=0;a>e;e++)r+=t[e][n][1];if(r)for(e=0;a>e;e++)t[e][n][1]/=r;else for(e=0;a>e;e++)t[e][n][1]=o}for(n=0;i>n;++n)l[n]=0;return l},zero:si});$o.layout.histogram=function(){function t(t,i){for(var o,l,s=[],u=t.map(n,this),c=r.call(this,u,i),d=a.call(this,c,u,i),i=-1,f=u.length,h=d.length-1,p=e?1:1/f;++i<h;)o=s[i]=[],o.dx=d[i+1]-(o.x=d[i]),o.y=0;if(h>0)for(i=-1;++i<f;)l=u[i],l>=c[0]&&l<=c[1]&&(o=s[$o.bisect(d,l,1,h)-1],o.y+=p,o.push(t[i]));return s}var e=!0,n=Number,r=pi,a=fi;return t.value=function(e){return arguments.length?(n=e,t):n},t.range=function(e){return arguments.length?(r=Ce(e),t):r},t.bins=function(e){return arguments.length?(a="number"==typeof e?function(t){return hi(t,e)}:Ce(e),t):a},t.frequency=function(n){return arguments.length?(e=!!n,t):e},t},$o.layout.pack=function(){function t(t,i){var o=n.call(this,t,i),l=o[0],s=a[0],u=a[1],c=null==e?Math.sqrt:"function"==typeof e?e:function(){return e};if(l.x=l.y=0,Qa(l,function(t){t.r=+c(t.value)}),Qa(l,xi),r){var d=r*(e?1:Math.max(2*l.r/s,2*l.r/u))/2;Qa(l,function(t){t.r+=d}),Qa(l,xi),Qa(l,function(t){t.r-=d})}return Ai(l,s/2,u/2,e?1:1/Math.max(2*l.r/s,2*l.r/u)),o}var e,n=$o.layout.hierarchy().sort(gi),r=0,a=[1,1];return t.size=function(e){return arguments.length?(a=e,t):a},t.radius=function(n){return arguments.length?(e=null==n||"function"==typeof n?n:+n,t):e},t.padding=function(e){return arguments.length?(r=+e,t):r},Za(t,n)},$o.layout.tree=function(){function t(t,a){var c=o.call(this,t,a),d=c[0],f=e(d);if(Qa(f,n),f.parent.m=-f.z,Ka(f,r),u)Ka(d,i);else{var h=d,p=d,g=d;Ka(d,function(t){t.x<h.x&&(h=t),t.x>p.x&&(p=t),t.depth>g.depth&&(g=t)});var y=l(h,p)/2-h.x,v=s[0]/(p.x+l(p,h)/2+y),m=s[1]/(g.depth||1);Ka(d,function(t){t.x=(t.x+y)*v,t.y=t.depth*m})}return c}function e(t){for(var e,n={A:null,children:[t]},r=[n];null!=(e=r.pop());)for(var a,i=e.children,o=0,l=i.length;l>o;++o)r.push((i[o]=a={_:i[o],parent:e,children:(a=i[o].children)&&a.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=a);return n.children[0]}function n(t){var e=t.children,n=t.parent.children,r=t.i?n[t.i-1]:null;if(e.length){Li(t);var i=(e[0].z+e[e.length-1].z)/2;r?(t.z=r.z+l(t._,r._),t.m=t.z-i):t.z=i}else r&&(t.z=r.z+l(t._,r._));t.parent.A=a(t,r,t.parent.A||n[0])}function r(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function a(t,e,n){if(e){for(var r,a=t,i=t,o=e,s=a.parent.children[0],u=a.m,c=i.m,d=o.m,f=s.m;o=Si(o),a=Ci(a),o&&a;)s=Ci(s),i=Si(i),i.a=t,r=o.z+d-a.z-u+l(o._,a._),r>0&&(Ti(_i(o,t,n),t,r),u+=r,c+=r),d+=o.m,u+=a.m,f+=s.m,c+=i.m;o&&!Si(i)&&(i.t=o,i.m+=d-c),a&&!Ci(s)&&(s.t=a,s.m+=u-f,n=t)}return n}function i(t){t.x*=s[0],t.y=t.depth*s[1]}var o=$o.layout.hierarchy().sort(null).value(null),l=wi,s=[1,1],u=null;return t.separation=function(e){return arguments.length?(l=e,t):l},t.size=function(e){return arguments.length?(u=null==(s=e)?i:null,t):u?null:s},t.nodeSize=function(e){return arguments.length?(u=null==(s=e)?null:i,t):u?s:null},Za(t,o)},$o.layout.cluster=function(){function t(t,i){var o,l=e.call(this,t,i),s=l[0],u=0;Qa(s,function(t){var e=t.children;e&&e.length?(t.x=Di(e),t.y=Ni(e)):(t.x=o?u+=n(t,o):0,t.y=0,o=t)});var c=Fi(s),d=Vi(s),f=c.x-n(c,d)/2,h=d.x+n(d,c)/2;return Qa(s,a?function(t){t.x=(t.x-s.x)*r[0],t.y=(s.y-t.y)*r[1]}:function(t){t.x=(t.x-f)/(h-f)*r[0],t.y=(1-(s.y?t.y/s.y:1))*r[1]}),l}var e=$o.layout.hierarchy().sort(null).value(null),n=wi,r=[1,1],a=!1;return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(a=null==(r=e),t):a?null:r},t.nodeSize=function(e){return arguments.length?(a=null!=(r=e),t):a?r:null},Za(t,e)},$o.layout.treemap=function(){function t(t,e){for(var n,r,a=-1,i=t.length;++a<i;)r=(n=t[a]).value*(0>e?0:e),n.area=isNaN(r)||0>=r?0:r}function e(n){var i=n.children;if(i&&i.length){var o,l,s,u=d(n),c=[],f=i.slice(),p=1/0,g="slice"===h?u.dx:"dice"===h?u.dy:"slice-dice"===h?1&n.depth?u.dy:u.dx:Math.min(u.dx,u.dy);for(t(f,u.dx*u.dy/n.value),c.area=0;(s=f.length)>0;)c.push(o=f[s-1]),c.area+=o.area,"squarify"!==h||(l=r(c,g))<=p?(f.pop(),p=l):(c.area-=c.pop().area,a(c,g,u,!1),g=Math.min(u.dx,u.dy),c.length=c.area=0,p=1/0);c.length&&(a(c,g,u,!0),c.length=c.area=0),i.forEach(e)}}function n(e){var r=e.children;if(r&&r.length){var i,o=d(e),l=r.slice(),s=[];for(t(l,o.dx*o.dy/e.value),s.area=0;i=l.pop();)s.push(i),s.area+=i.area,null!=i.z&&(a(s,i.z?o.dx:o.dy,o,!l.length),s.length=s.area=0);r.forEach(n)}}function r(t,e){for(var n,r=t.area,a=0,i=1/0,o=-1,l=t.length;++o<l;)(n=t[o].area)&&(i>n&&(i=n),n>a&&(a=n));return r*=r,e*=e,r?Math.max(e*a*p/r,r/(e*i*p)):1/0}function a(t,e,n,r){var a,i=-1,o=t.length,l=n.x,u=n.y,c=e?s(t.area/e):0;if(e==n.dx){for((r||c>n.dy)&&(c=n.dy);++i<o;)a=t[i],a.x=l,a.y=u,a.dy=c,l+=a.dx=Math.min(n.x+n.dx-l,c?s(a.area/c):0);a.z=!0,a.dx+=n.x+n.dx-l,n.y+=c,n.dy-=c}else{for((r||c>n.dx)&&(c=n.dx);++i<o;)a=t[i],a.x=l,a.y=u,a.dx=c,u+=a.dy=Math.min(n.y+n.dy-u,c?s(a.area/c):0);a.z=!1,a.dy+=n.y+n.dy-u,n.x+=c,n.dx-=c}}function i(r){var a=o||l(r),i=a[0];return i.x=0,i.y=0,i.dx=u[0],i.dy=u[1],o&&l.revalue(i),t([i],i.dx*i.dy/i.value),(o?n:e)(i),f&&(o=a),a}var o,l=$o.layout.hierarchy(),s=Math.round,u=[1,1],c=null,d=Ii,f=!1,h="squarify",p=.5*(1+Math.sqrt(5));return i.size=function(t){return arguments.length?(u=t,i):u},i.padding=function(t){function e(e){var n=t.call(i,e,e.depth);return null==n?Ii(e):Pi(e,"number"==typeof n?[n,n,n,n]:n)}function n(e){return Pi(e,t)}if(!arguments.length)return c;var r;return d=null==(c=t)?Ii:"function"==(r=typeof t)?e:"number"===r?(t=[t,t,t,t],n):n,i},i.round=function(t){return arguments.length?(s=t?Math.round:Number,i):s!=Number},i.sticky=function(t){return arguments.length?(f=t,o=null,i):f},i.ratio=function(t){return arguments.length?(p=t,i):p},i.mode=function(t){return arguments.length?(h=t+"",i):h},Za(i,l)},$o.random={normal:function(t,e){var n=arguments.length;return 2>n&&(e=1),1>n&&(t=0),function(){var n,r,a;do n=2*Math.random()-1,r=2*Math.random()-1,a=n*n+r*r;while(!a||a>1);return t+e*n*Math.sqrt(-2*Math.log(a)/a)}},logNormal:function(){var t=$o.random.normal.apply($o,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=$o.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,n=0;t>n;n++)e+=Math.random();return e}}},$o.scale={};var pu={floor:Se,ceil:Se};$o.scale.linear=function(){return qi([0,1],[0,1],va,!1)};var gu={s:1,g:1,p:1,r:1,e:1};$o.scale.log=function(){return Ji($o.scale.linear().domain([0,1]),10,!0,[1,10])};var yu=$o.format(".0e"),vu={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};$o.scale.pow=function(){return Zi($o.scale.linear(),1,[0,1])},$o.scale.sqrt=function(){return $o.scale.pow().exponent(.5)},$o.scale.ordinal=function(){return Qi([],{t:"range",a:[[]]})},$o.scale.category10=function(){return $o.scale.ordinal().range(mu)},$o.scale.category20=function(){return $o.scale.ordinal().range(xu)},$o.scale.category20b=function(){return $o.scale.ordinal().range(bu)
},$o.scale.category20c=function(){return $o.scale.ordinal().range(ku)};var mu=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(me),xu=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(me),bu=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(me),ku=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(me);$o.scale.quantile=function(){return to([],[])},$o.scale.quantize=function(){return eo(0,1,[0,1])},$o.scale.threshold=function(){return no([.5],[0,1])},$o.scale.identity=function(){return ro([0,1])},$o.svg={},$o.svg.arc=function(){function t(){var t=e.apply(this,arguments),i=n.apply(this,arguments),o=r.apply(this,arguments)+Au,l=a.apply(this,arguments)+Au,s=(o>l&&(s=o,o=l,l=s),l-o),u=Tl>s?"0":"1",c=Math.cos(o),d=Math.sin(o),f=Math.cos(l),h=Math.sin(l);return s>=Mu?t?"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"M0,"+t+"A"+t+","+t+" 0 1,0 0,"+-t+"A"+t+","+t+" 0 1,0 0,"+t+"Z":"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"Z":t?"M"+i*c+","+i*d+"A"+i+","+i+" 0 "+u+",1 "+i*f+","+i*h+"L"+t*f+","+t*h+"A"+t+","+t+" 0 "+u+",0 "+t*c+","+t*d+"Z":"M"+i*c+","+i*d+"A"+i+","+i+" 0 "+u+",1 "+i*f+","+i*h+"L0,0Z"}var e=ao,n=io,r=oo,a=lo;return t.innerRadius=function(n){return arguments.length?(e=Ce(n),t):e},t.outerRadius=function(e){return arguments.length?(n=Ce(e),t):n},t.startAngle=function(e){return arguments.length?(r=Ce(e),t):r},t.endAngle=function(e){return arguments.length?(a=Ce(e),t):a},t.centroid=function(){var t=(e.apply(this,arguments)+n.apply(this,arguments))/2,i=(r.apply(this,arguments)+a.apply(this,arguments))/2+Au;return[Math.cos(i)*t,Math.sin(i)*t]},t};var Au=-_l,Mu=Ll-Nl;$o.svg.line=function(){return so(Se)};var wu=$o.map({linear:uo,"linear-closed":co,step:fo,"step-before":ho,"step-after":po,basis:bo,"basis-open":ko,"basis-closed":Ao,bundle:Mo,cardinal:vo,"cardinal-open":go,"cardinal-closed":yo,monotone:_o});wu.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var Cu=[0,2/3,1/3,0],Su=[0,1/3,2/3,0],Tu=[0,1/6,2/3,1/6];$o.svg.line.radial=function(){var t=so(No);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},ho.reverse=po,po.reverse=ho,$o.svg.area=function(){return Do(Se)},$o.svg.area.radial=function(){var t=Do(No);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},$o.svg.chord=function(){function t(t,l){var s=e(this,i,t,l),u=e(this,o,t,l);return"M"+s.p0+r(s.r,s.p1,s.a1-s.a0)+(n(s,u)?a(s.r,s.p1,s.r,s.p0):a(s.r,s.p1,u.r,u.p0)+r(u.r,u.p1,u.a1-u.a0)+a(u.r,u.p1,s.r,s.p0))+"Z"}function e(t,e,n,r){var a=e.call(t,n,r),i=l.call(t,a,r),o=s.call(t,a,r)+Au,c=u.call(t,a,r)+Au;return{r:i,a0:o,a1:c,p0:[i*Math.cos(o),i*Math.sin(o)],p1:[i*Math.cos(c),i*Math.sin(c)]}}function n(t,e){return t.a0==e.a0&&t.a1==e.a1}function r(t,e,n){return"A"+t+","+t+" 0 "+ +(n>Tl)+",1 "+e}function a(t,e,n,r){return"Q 0,0 "+r}var i=mr,o=xr,l=Fo,s=oo,u=lo;return t.radius=function(e){return arguments.length?(l=Ce(e),t):l},t.source=function(e){return arguments.length?(i=Ce(e),t):i},t.target=function(e){return arguments.length?(o=Ce(e),t):o},t.startAngle=function(e){return arguments.length?(s=Ce(e),t):s},t.endAngle=function(e){return arguments.length?(u=Ce(e),t):u},t},$o.svg.diagonal=function(){function t(t,a){var i=e.call(this,t,a),o=n.call(this,t,a),l=(i.y+o.y)/2,s=[i,{x:i.x,y:l},{x:o.x,y:l},o];return s=s.map(r),"M"+s[0]+"C"+s[1]+" "+s[2]+" "+s[3]}var e=mr,n=xr,r=Vo;return t.source=function(n){return arguments.length?(e=Ce(n),t):e},t.target=function(e){return arguments.length?(n=Ce(e),t):n},t.projection=function(e){return arguments.length?(r=e,t):r},t},$o.svg.diagonal.radial=function(){var t=$o.svg.diagonal(),e=Vo,n=t.projection;return t.projection=function(t){return arguments.length?n(Io(e=t)):e},t},$o.svg.symbol=function(){function t(t,r){return(Lu.get(e.call(this,t,r))||Eo)(n.call(this,t,r))}var e=zo,n=Po;return t.type=function(n){return arguments.length?(e=Ce(n),t):e},t.size=function(e){return arguments.length?(n=Ce(e),t):n},t};var Lu=$o.map({circle:Eo,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*Fu)),n=e*Fu;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/Du),n=e*Du/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/Du),n=e*Du/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});$o.svg.symbolTypes=Lu.keys();var _u,Nu,Du=Math.sqrt(3),Fu=Math.tan(30*Fl),Vu=[],Iu=0;Vu.call=xl.call,Vu.empty=xl.empty,Vu.node=xl.node,Vu.size=xl.size,$o.transition=function(t){return arguments.length?_u?t.transition():t:Al.transition()},$o.transition.prototype=Vu,Vu.select=function(t){var e,n,r,a=this.id,i=[];t=C(t);for(var o=-1,l=this.length;++o<l;){i.push(e=[]);for(var s=this[o],u=-1,c=s.length;++u<c;)(r=s[u])&&(n=t.call(r,r.__data__,u,o))?("__data__"in r&&(n.__data__=r.__data__),Yo(n,u,a,r.__transition__[a]),e.push(n)):e.push(null)}return Oo(i,a)},Vu.selectAll=function(t){var e,n,r,a,i,o=this.id,l=[];t=S(t);for(var s=-1,u=this.length;++s<u;)for(var c=this[s],d=-1,f=c.length;++d<f;)if(r=c[d]){i=r.__transition__[o],n=t.call(r,r.__data__,d,s),l.push(e=[]);for(var h=-1,p=n.length;++h<p;)(a=n[h])&&Yo(a,h,o,i),e.push(a)}return Oo(l,o)},Vu.filter=function(t){var e,n,r,a=[];"function"!=typeof t&&(t=E(t));for(var i=0,o=this.length;o>i;i++){a.push(e=[]);for(var n=this[i],l=0,s=n.length;s>l;l++)(r=n[l])&&t.call(r,r.__data__,l,i)&&e.push(r)}return Oo(a,this.id)},Vu.tween=function(t,e){var n=this.id;return arguments.length<2?this.node().__transition__[n].tween.get(t):R(this,null==e?function(e){e.__transition__[n].tween.remove(t)}:function(r){r.__transition__[n].tween.set(t,e)})},Vu.attr=function(t,e){function n(){this.removeAttribute(l)}function r(){this.removeAttributeNS(l.space,l.local)}function a(t){return null==t?n:(t+="",function(){var e,n=this.getAttribute(l);return n!==t&&(e=o(n,t),function(t){this.setAttribute(l,e(t))})})}function i(t){return null==t?r:(t+="",function(){var e,n=this.getAttributeNS(l.space,l.local);return n!==t&&(e=o(n,t),function(t){this.setAttributeNS(l.space,l.local,e(t))})})}if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var o="transform"==t?Ba:va,l=$o.ns.qualify(t);return Ro(this,"attr."+t,e,l.local?i:a)},Vu.attrTween=function(t,e){function n(t,n){var r=e.call(this,t,n,this.getAttribute(a));return r&&function(t){this.setAttribute(a,r(t))}}function r(t,n){var r=e.call(this,t,n,this.getAttributeNS(a.space,a.local));return r&&function(t){this.setAttributeNS(a.space,a.local,r(t))}}var a=$o.ns.qualify(t);return this.tween("attr."+t,a.local?r:n)},Vu.style=function(t,e,n){function r(){this.style.removeProperty(t)}function a(e){return null==e?r:(e+="",function(){var r,a=tl.getComputedStyle(this,null).getPropertyValue(t);return a!==e&&(r=va(a,e),function(e){this.style.setProperty(t,r(e),n)})})}var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e="");for(n in t)this.style(n,t[n],e);return this}n=""}return Ro(this,"style."+t,e,a)},Vu.styleTween=function(t,e,n){function r(r,a){var i=e.call(this,r,a,tl.getComputedStyle(this,null).getPropertyValue(t));return i&&function(e){this.style.setProperty(t,i(e),n)}}return arguments.length<3&&(n=""),this.tween("style."+t,r)},Vu.text=function(t){return Ro(this,"text",t,Bo)},Vu.remove=function(){return this.each("end.transition",function(){var t;this.__transition__.count<2&&(t=this.parentNode)&&t.removeChild(this)})},Vu.ease=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].ease:("function"!=typeof t&&(t=$o.ease.apply($o,arguments)),R(this,function(n){n.__transition__[e].ease=t}))},Vu.delay=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].delay:R(this,"function"==typeof t?function(n,r,a){n.__transition__[e].delay=+t.call(n,n.__data__,r,a)}:(t=+t,function(n){n.__transition__[e].delay=t}))},Vu.duration=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].duration:R(this,"function"==typeof t?function(n,r,a){n.__transition__[e].duration=Math.max(1,t.call(n,n.__data__,r,a))}:(t=Math.max(1,t),function(n){n.__transition__[e].duration=t}))},Vu.each=function(t,e){var n=this.id;if(arguments.length<2){var r=Nu,a=_u;_u=n,R(this,function(e,r,a){Nu=e.__transition__[n],t.call(e,e.__data__,r,a)}),Nu=r,_u=a}else R(this,function(r){var a=r.__transition__[n];(a.event||(a.event=$o.dispatch("start","end"))).on(t,e)});return this},Vu.transition=function(){for(var t,e,n,r,a=this.id,i=++Iu,o=[],l=0,s=this.length;s>l;l++){o.push(t=[]);for(var e=this[l],u=0,c=e.length;c>u;u++)(n=e[u])&&(r=Object.create(n.__transition__[a]),r.delay+=r.duration,Yo(n,u,i,r)),t.push(n)}return Oo(o,i)},$o.svg.axis=function(){function t(t){t.each(function(){var t,u=$o.select(this),c=this.__chart__||n,d=this.__chart__=n.copy(),f=null==s?d.ticks?d.ticks.apply(d,l):d.domain():s,h=null==e?d.tickFormat?d.tickFormat.apply(d,l):Se:e,p=u.selectAll(".tick").data(f,d),g=p.enter().insert("g",".domain").attr("class","tick").style("opacity",Nl),y=$o.transition(p.exit()).style("opacity",Nl).remove(),v=$o.transition(p.order()).style("opacity",1),m=Math.max(a,0)+o,x=Ei(d),b=u.selectAll(".domain").data([0]),k=(b.enter().append("path").attr("class","domain"),$o.transition(b));g.append("line"),g.append("text");var A,M,w,C,S=g.select("line"),T=v.select("line"),L=p.select("text").text(h),_=g.select("text"),N=v.select("text"),D="top"===r||"left"===r?-1:1;if("bottom"===r||"top"===r?(t=qo,A="x",w="y",M="x2",C="y2",L.attr("dy",0>D?"0em":".71em").style("text-anchor","middle"),k.attr("d","M"+x[0]+","+D*i+"V0H"+x[1]+"V"+D*i)):(t=Go,A="y",w="x",M="y2",C="x2",L.attr("dy",".32em").style("text-anchor",0>D?"end":"start"),k.attr("d","M"+D*i+","+x[0]+"H0V"+x[1]+"H"+D*i)),S.attr(C,D*a),_.attr(w,D*m),T.attr(M,0).attr(C,D*a),N.attr(A,0).attr(w,D*m),d.rangeBand){var F=d,V=F.rangeBand()/2;c=d=function(t){return F(t)+V}}else c.rangeBand?c=d:y.call(t,d,c);g.call(t,c,d),v.call(t,d,d)})}var e,n=$o.scale.linear(),r=Pu,a=6,i=6,o=3,l=[10],s=null;return t.scale=function(e){return arguments.length?(n=e,t):n},t.orient=function(e){return arguments.length?(r=e in zu?e+"":Pu,t):r},t.ticks=function(){return arguments.length?(l=arguments,t):l},t.tickValues=function(e){return arguments.length?(s=e,t):s},t.tickFormat=function(n){return arguments.length?(e=n,t):e},t.tickSize=function(e){var n=arguments.length;return n?(a=+e,i=+arguments[n-1],t):a},t.innerTickSize=function(e){return arguments.length?(a=+e,t):a},t.outerTickSize=function(e){return arguments.length?(i=+e,t):i},t.tickPadding=function(e){return arguments.length?(o=+e,t):o},t.tickSubdivide=function(){return arguments.length&&t},t};var Pu="bottom",zu={top:1,right:1,bottom:1,left:1};$o.svg.brush=function(){function t(i){i.each(function(){var i=$o.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",a).on("touchstart.brush",a),o=i.selectAll(".background").data([0]);o.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),i.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var l=i.selectAll(".resize").data(p,Se);l.exit().remove(),l.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return Eu[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),l.style("display",t.empty()?"none":null);var c,d=$o.transition(i),f=$o.transition(o);s&&(c=Ei(s),f.attr("x",c[0]).attr("width",c[1]-c[0]),n(d)),u&&(c=Ei(u),f.attr("y",c[0]).attr("height",c[1]-c[0]),r(d)),e(d)})}function e(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+c[+/e$/.test(t)]+","+d[+/^s/.test(t)]+")"})}function n(t){t.select(".extent").attr("x",c[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",c[1]-c[0])}function r(t){t.select(".extent").attr("y",d[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",d[1]-d[0])}function a(){function a(){32==$o.event.keyCode&&(L||(m=null,N[0]-=c[1],N[1]-=d[1],L=2),k())}function p(){32==$o.event.keyCode&&2==L&&(N[0]+=c[1],N[1]+=d[1],L=0,k())}function g(){var t=$o.mouse(b),a=!1;x&&(t[0]+=x[0],t[1]+=x[1]),L||($o.event.altKey?(m||(m=[(c[0]+c[1])/2,(d[0]+d[1])/2]),N[0]=c[+(t[0]<m[0])],N[1]=d[+(t[1]<m[1])]):m=null),S&&y(t,s,0)&&(n(w),a=!0),T&&y(t,u,1)&&(r(w),a=!0),a&&(e(w),M({type:"brush",mode:L?"move":"resize"}))}function y(t,e,n){var r,a,l=Ei(e),s=l[0],u=l[1],p=N[n],g=n?d:c,y=g[1]-g[0];return L&&(s-=p,u-=y+p),r=(n?h:f)?Math.max(s,Math.min(u,t[n])):t[n],L?a=(r+=p)+y:(m&&(p=Math.max(s,Math.min(u,2*m[n]-r))),r>p?(a=r,r=p):a=p),g[0]!=r||g[1]!=a?(n?o=null:i=null,g[0]=r,g[1]=a,!0):void 0}function v(){g(),w.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),$o.select("body").style("cursor",null),D.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),_(),M({type:"brushend"})}var m,x,b=this,A=$o.select($o.event.target),M=l.of(b,arguments),w=$o.select(b),C=A.datum(),S=!/^(n|s)$/.test(C)&&s,T=!/^(e|w)$/.test(C)&&u,L=A.classed("extent"),_=H(),N=$o.mouse(b),D=$o.select(tl).on("keydown.brush",a).on("keyup.brush",p);if($o.event.changedTouches?D.on("touchmove.brush",g).on("touchend.brush",v):D.on("mousemove.brush",g).on("mouseup.brush",v),w.interrupt().selectAll("*").interrupt(),L)N[0]=c[0]-N[0],N[1]=d[0]-N[1];else if(C){var F=+/w$/.test(C),V=+/^n/.test(C);x=[c[1-F]-N[0],d[1-V]-N[1]],N[0]=c[F],N[1]=d[V]}else $o.event.altKey&&(m=N.slice());w.style("pointer-events","none").selectAll(".resize").style("display",null),$o.select("body").style("cursor",A.style("cursor")),M({type:"brushstart"}),g()}var i,o,l=M(t,"brushstart","brush","brushend"),s=null,u=null,c=[0,0],d=[0,0],f=!0,h=!0,p=Ou[0];return t.event=function(t){t.each(function(){var t=l.of(this,arguments),e={x:c,y:d,i:i,j:o},n=this.__chart__||e;this.__chart__=e,_u?$o.select(this).transition().each("start.brush",function(){i=n.i,o=n.j,c=n.x,d=n.y,t({type:"brushstart"})}).tween("brush:brush",function(){var n=ma(c,e.x),r=ma(d,e.y);return i=o=null,function(a){c=e.x=n(a),d=e.y=r(a),t({type:"brush",mode:"resize"})}}).each("end.brush",function(){i=e.i,o=e.j,t({type:"brush",mode:"resize"}),t({type:"brushend"})}):(t({type:"brushstart"}),t({type:"brush",mode:"resize"}),t({type:"brushend"}))})},t.x=function(e){return arguments.length?(s=e,p=Ou[!s<<1|!u],t):s},t.y=function(e){return arguments.length?(u=e,p=Ou[!s<<1|!u],t):u},t.clamp=function(e){return arguments.length?(s&&u?(f=!!e[0],h=!!e[1]):s?f=!!e:u&&(h=!!e),t):s&&u?[f,h]:s?f:u?h:null},t.extent=function(e){var n,r,a,l,f;return arguments.length?(s&&(n=e[0],r=e[1],u&&(n=n[0],r=r[0]),i=[n,r],s.invert&&(n=s(n),r=s(r)),n>r&&(f=n,n=r,r=f),(n!=c[0]||r!=c[1])&&(c=[n,r])),u&&(a=e[0],l=e[1],s&&(a=a[1],l=l[1]),o=[a,l],u.invert&&(a=u(a),l=u(l)),a>l&&(f=a,a=l,l=f),(a!=d[0]||l!=d[1])&&(d=[a,l])),t):(s&&(i?(n=i[0],r=i[1]):(n=c[0],r=c[1],s.invert&&(n=s.invert(n),r=s.invert(r)),n>r&&(f=n,n=r,r=f))),u&&(o?(a=o[0],l=o[1]):(a=d[0],l=d[1],u.invert&&(a=u.invert(a),l=u.invert(l)),a>l&&(f=a,a=l,l=f))),s&&u?[[n,a],[r,l]]:s?[n,r]:u&&[a,l])},t.clear=function(){return t.empty()||(c=[0,0],d=[0,0],i=o=null),t},t.empty=function(){return!!s&&c[0]==c[1]||!!u&&d[0]==d[1]},$o.rebind(t,l,"on")};var Eu={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ou=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ru=as.format=cs.timeFormat,Bu=Ru.utc,Yu=Bu("%Y-%m-%dT%H:%M:%S.%LZ");Ru.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?jo:Yu,jo.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},jo.toString=Yu.toString,as.second=Re(function(t){return new is(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),as.seconds=as.second.range,as.seconds.utc=as.second.utc.range,as.minute=Re(function(t){return new is(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),as.minutes=as.minute.range,as.minutes.utc=as.minute.utc.range,as.hour=Re(function(t){var e=t.getTimezoneOffset()/60;return new is(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),as.hours=as.hour.range,as.hours.utc=as.hour.utc.range,as.month=Re(function(t){return t=as.day(t),t.setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),as.months=as.month.range,as.months.utc=as.month.utc.range;var qu=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Gu=[[as.second,1],[as.second,5],[as.second,15],[as.second,30],[as.minute,1],[as.minute,5],[as.minute,15],[as.minute,30],[as.hour,1],[as.hour,3],[as.hour,6],[as.hour,12],[as.day,1],[as.day,2],[as.week,1],[as.month,1],[as.month,3],[as.year,1]],ju=Ru.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",Ln]]),Uu={range:function(t,e,n){return $o.range(Math.ceil(t/n)*n,+e,n).map(Ho)},floor:Se,ceil:Se};Gu.year=as.year,as.scale=function(){return Uo($o.scale.linear(),Gu,ju)};var Hu=Gu.map(function(t){return[t[0].utc,t[1]]}),Xu=Bu.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",Ln]]);Hu.year=as.year.utc,as.scale.utc=function(){return Uo($o.scale.linear(),Hu,Xu)},$o.text=Te(function(t){return t.responseText}),$o.json=function(t,e){return Le(t,"application/json",Xo,e)},$o.html=function(t,e){return Le(t,"text/html",Wo,e)},$o.xml=Te(function(t){return t.responseXML}),"function"==typeof define&&define.amd?define($o):"object"==typeof module&&module.exports&&(module.exports=$o),this.d3=$o}(),function(t){t.fn.stocCharts=function(e){function n(){g=t(f).width(),v=t(f).height(),m=e,F=t(f).attr("id");var n=F+"_svg";p=d3.select("#"+F).append("svg").attr("width","100%").attr("height","100%").attr("id",F+"-svg").attr("class",n).attr("viewBox","0 0 "+Math.max(g,v)+" "+Math.min(g,v)).attr("preserveAspectRatio","xMinYMin"),d3.select("#tooltipChart").empty()&&G.appendToolTip()}function r(t){var e=t.sort(function(t,e){return parseInt(t)<parseInt(e)});return e}function a(t,e,n,r){var a=t*(Math.PI/180),i=e/Math.tan(a)+r;return i}function o(t,e){var n=t*(Math.PI/180),r=e/Math.tan(n);return r}function s(t){var e=50,n=2,r=60,l=200/1.73,s=(t.length*e,0),u=0,c=0,d=0,f=0,h=0,p=0,g=0,y={},v=[];for(y.arrayOfPolygons=v,i=1;i<=t.length;i++){var m,x,b={},k=[];for(b.coordinates=k,j=0;4>j;j++){0==j?(m=a(r,t[i-1],l,f),x=1==i?o(60,t[i-1]):+h+o(r,t[i-1]),s=m,c=x+n):1==j?(m+=l-2*m,x=1==i?o(60,t[i-1]):+g+o(r,t[i-1]),u=m,d=x+n):2==j?1==i?(m=l,x=0):(m=p,x=g):1==i?(m=0,x=0):(m=f,x=h);var A={x:m,y:x};b.coordinates.push(A)}f=s,h=c,p=u,g=d;var M={name:"Polygon-"+i,Percent:t[i-1],points:b.coordinates};y.arrayOfPolygons.push(M)}return y}function u(t){t.selectAll(".axis").select("path").style("display","none"),t.selectAll(".tick line").style("display","none"),t.selectAll("path.domain").style("display","none")}function c(t){var e=m,n=t.selectAll("text");n.style("font-size",e["font-size"],null),n.style("font-family",e["font-family"]),n.style("font-weight",e["font-weight"]),t.selectAll(".tick").selectAll("text").style("fill",e["tick-font-color"],null),t.selectAll(".title").selectAll("text").style("font-size",e.titleFontSize+"px"),t.selectAll(".legend").selectAll("text").style("fill",e.legendTextColor),console.log(e.legendTextColor)}var d={attachWaterMark:function(){f.parent().css("background-image","url(http://www.stocinn.com/stoccharts/img/stoc-chart-logo.png)"),f.parent().css("background-repeat"," no-repeat"),f.parent().css("background-position","bottom right")}},f=t(this),h=t(f).attr("id");d.attachWaterMark(f);var p,g,v,m,b,A,M,C,S,T,L,_,N,D,F,V={left:10,right:35,top:5,bottom:35,scale:5},I=d3.time.format("%Y-%m-%d"),P=(d3.time.format("%b "),50),V={left:10,right:35,top:10,bottom:35,scale:50,areaLeft:60},E={drawYAxis:function(){var e=d3.select(".yaxis").append("svg").attr("width",40).attr("height",t(f).height());e.append("g").attr("class","y axis agnitio").attr("transform","translate(8,"+V.top+")").attr("stroke","black").attr("fill","none").call(b)},drawMulitpleLineChartWithSquare:function(e){for(var n,r,e=t.extend({lineArray:[],squareArray:[]},e),a=e.lineArray,i=e.squareArray,o=0;o<a.length;o++){var l=a[o],s=l.yFieldName,u=d3.extent(l.data,function(t){return t[s]});0==o?(n=u[0],r=u[1]):(n>u[0]&&(n=u[0]),r<u[1]&&(r=u[1]))}M.domain([n,r+3]);for(var o=0;o<a.length;o++){var l=a[o],c={};for(key in l)c[key]=l[key];H.drawLine(c)}for(var o=0;o<i.length;o++){var d=i[o],f={};for(key in d)f[key]=d[key];$.squareChart(f)}}},O={getValueToPercentageArray:function(t){for(var e=[],n=0,r=0;r<t.length;r++)n+=t[r];for(var r=0;r<t.length;r++)e.push(t[r]/n*100);return e}},R={getLegendPositionArray:function(t,e,n){for(var r=6,a=.7*e,i=10,o=.05*n,l=[],s=10,u=0,c=0,d=0;d<t.length;d++){var f=t[d].toString(),h={x:0,y:0,endPos:0},p=0,g=.08*e,y=.05*e;30>g&&(g=30),20>y&&(y=20),p=0==d?g:l[d-1].endPos;var v=p+s+f.length*r+i+y;v>a&&(u++,p=g,v=p+s+f.length*r+i+y,c=u*o),h.x=p,h.y=c,h.endPos=v,h.textPos=p+s+i,l.push(h)}return l},showHorizontalLegend:function(t,e,n,r){for(var a=0,i=0;i<n.length;i++)a<n[i].toString().length&&(a=n[i].toString().length);a=7*a;for(var o=[],l={x:0,y:0,textXPos:0},s=5,u=.1*t,c=Math.round(.8*t/(s+r+a)),i=0;i<n.length;i++){var l={};u=i%c==0?.1*t:u+s+r+a,l.x=u,i%c==0&&0!=i&&(e+=2*r),l.y=e,l.textXPos=u+s+r,o.push(l)}return o}},B={appendLabel:function(t,e,n,r,a,i,o){var l="black",s=300;isNaN(i)&&void 0===i||(l=i),isNaN(o)&&void 0===o||(s=o);var u=a.append("text");u.text(t).attr("transform","translate("+e+","+n+") rotate("+r+")").style("fill",l,"important").style("font-weight",500,"important")}},Y={getTickArray:function(t,e,n){var r=[],a=Math.round((e-t)/(n-1)),i=t;r.push(i),n--;for(var o=1;n>o;o++)i+=a,r.push(i),o==n-1&&r.push(e);return r},getXTickArray:function(t,e,n,r){var a=[],i=13*n,o=Math.round(r/i),l=t;a.push(l);for(var s=(e-t)/o;e>l;)l=Math.floor(l+s),-1==a.indexOf(l)&&e>=l?a.push(l):l++;return a}},q={wrapText:function(t,e){t.each(function(){for(var t,n=d3.select(this),r=n.text().split(/\s+/).reverse(),a=[],i=0,o=1.1,l=n.attr("y"),s=parseFloat(n.attr("dy")),u=n.text(null).append("tspan").attr("x",0).attr("y",l).attr("dy",s+"em");t=r.pop();)a.push(t),u.text(a.join(" ")),u.node().getComputedTextLength()>e&&(a.pop(),u.text(a.join(" ")),a=[t],u=n.append("tspan").attr("x",0).attr("y",l).attr("dy",++i*o+s+"em").text(t))})}},G={appendToolTip:function(){var e='<div id="tooltipChart" style="z-index:999999;float:none;display:none; margin:0px; padding:0px; position:absolute; width:150px;"><div id="textContainer" style="width:150px; background-color:rgba(197,198,197,0.7); border-radius:5px; font-family:calibri; float:left; font-size:11px; padding:10px;">	<div class="xVal" style="text-align:center; font-size:13px;border-bottom:solid 1px #7b7b7b;background:url(http://stocinn.github.io/stocweb/img/tooltip-heading-bg.jpg) repeat-x;border-top-left-radius:5px; margin-top:-10px; margin-left:-10px;  margin-right:-10px;border-top-right-radius:7px; padding:5px 10px;">14 jan</div><div id="y-label" class="y-label label1" style="width:60%;display:none; font-weight:bold; float:left; text-align:left; padding:3px 0;">Auto Loans</div><div  class="yVal label1" style="width:40%; float:right;display:none; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label2" style="width:60%; float:left;display:none;font-weight:bold; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label2" style="width:40%;display:none; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label3" style="width:60%; float:left;font-weight:bold; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label3" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label4" style="width:60%; float:left;font-weight:bold; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label4" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label5" style="width:60%; float:left;font-weight:bold; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label5" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label6" style="width:60%; float:left; font-weight:bold;text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label6" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>	</div>	<div id="handIcon" style="position: relative; bottom:1px; height:31px; width:52px; 	 background:url(http://stocinn.github.io/stocweb/img/toolTips-arrow.png) no-repeat;opacity:0.7; clear:both; float:right; bottom:0px; right:8px;">	 </div></div>';t("body").append(e)},appendToolTipOld:function(){var e="<div id='tooltipChart' style='display:none;position:absolute;background:rgba(0, 0, 0, 0.8); width:120px;  min-height: 40px; z-index:99999999 !important;box-shadow: inset 0 0 40px #222221;float:left; border-radius:5px; font-family: Calibri,Candara,Segoe,Segoe UI,Optima,Arial,sans-serif;  color:white; text-shadow: 1px 0 1px #000;    '><div class='arrow' style='position: absolute;margin-left: -8px;font-size: 24px;color:#272726; text-shadow:none; top: 7px;'><i class='fa fa-caret-left'></i></div><div id='textContainer'><div   style='clear:both;width:100%;padding:2px 5px '><div style='width:50%;float:left;' class='xVal'></div></div><div  class='yContainer1 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label'  style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal' style='width:45%;margin-left:5%;float:left;'></div></div></div></div></div>";t("body").append(e)},showToolTip:function(e,n,r,a,i,o){var l,s=e.pageX;isNaN(o)?l=e.pageY:(console.log("given pageY"),l=o);var u;u=n;var c;c=r,t("#tooltipChart").find(".xVal").html(""),t("#tooltipChart").find(".xVal").html(c),t("#tooltipChart").find(".y-label").html(""),t("#tooltipChart").find(".yVal").html(""),t("#tooltipChart").find(".yVal").hide(),t("#tooltipChart").find(".y-label").hide();for(var d=t("#tooltipChart"),f=0;f<i.length;f++){var h=i[f],p=f+1,g=".y-label.label"+p,y=".yVal.label"+p;t(d).find(g).html(h.headingName),t(d).find(y).html(h.headingVal),t(d).find(y).show(),t(d).find(g).show()}var v=s;if(t(".ps-scrollbar-x-rail"))try{v+=parseInt(t(".ps-scrollbar-x-rail").css("left").replace("px",""))}catch(m){}var x=t("body").find("#tooltipChart"),b=(t(x).find("#textContainer"),l-.98*t("body").find("#tooltipChart").height());v-=.98*t("body").find("#tooltipChart").width(),t("body").find("#tooltipChart").css("left",v),t("body").find("#tooltipChart").css("top",b),t("body").find("#tooltipChart").show()},hideTooTip:function(){t("#tooltipChart").find(".yVal").html(""),d3.select("#tooltipChart").style("display","none")},showToolTipForBarWithMultipleLine:function(e,n,r,a,i,o){{var l,s=e.pageX;e.pageY-t(f).find("svg").offset().top-10}l=r,t("#draggLineToolTip").find(".xVal").html(a?"":l),o?t("#draggLineToolTip").find("#tooltip-dragger").show():t("#draggLineToolTip").find("#tooltip-dragger").hide(),d3.select("#draggLineToolTip").selectAll(".yDiv").style("display","none");var u=1;for(key in n){{t(".yContainer"+u).show()}d3.select("#y-label"+u).html(key+" "),d3.select("#yVal"+u).html(" "+n[key]),u++}var c=s+V.left;if(t(".ps-scrollbar-x-rail"))try{c+=parseInt(t(".ps-scrollbar-x-rail").css("left").replace("px",""))}catch(d){}var h=t("body").find("#draggLineToolTip"),p=t(h).find("#textContainer");t(window).width()-c<t("body").find("#draggLineToolTip").width()?(c-=t(h).width(),t(h).css("-ms-transform","rotate(-180deg) translate(15px)"),t(h).css("-webkit-transform","rotate(-180deg) translate(15px)"),t(h).css("transform","rotate(-180deg) translate(15px)"),t(p).css("-ms-transform"," translateY(10px) rotate(180deg)"),t(p).css("-webkit-transform","translateY(10px)  rotate(180deg)"),t(p).css("transform","translateY(10px) rotate(180deg)")):(t(h).css("-ms-transform",""),t(h).css("-webkit-transform",""),t(h).css("transform",""),t(p).css("-ms-transform",""),t(p).css("-webkit-transform",""),t(p).css("transform",""));var g=e.pageY-t(f).find("#draggLineToolTip").height()/2;null!=i?t("body").find("#draggLineToolTip").css("left",c):t("body").find("#draggLineToolTip").css("left",c-5),t("body").find("#draggLineToolTip").css("top",g-20),t("body").find("#draggLineToolTip").show()},hideMulitpleLineBarToolTip:function(){d3.select("#draggLineToolTip").style("display","none")},appendToolTipForBarWithMultipleLine:function(){var e="<div id='draggLineToolTip' style='display:none;position:absolute;background:rgba(0, 0, 0, 0.8); width:120px;  min-height: 40px; z-index:99999999 !important;box-shadow: inset 0 0 40px #222221;float:left; border-radius:5px; font-family: Calibri,Candara,Segoe,Segoe UI,Optima,Arial,sans-serif;  color:white; text-shadow: 1px 0 1px #000;    '><div  id='tooltip-dragger' style='position: absolute;margin-left: -8px; border-left:solid 1px #000; min-height:250px; top:-100px;'></div><div class='arrow' style='position: absolute;margin-left: -8px;font-size: 24px;color:#272726; text-shadow:none; top: 7px;'><i class='fa fa-caret-left'></i></div><div id='textContainer'><div   style='clear:both;width:100%;padding:2px 5px '><div style='width:50%;float:left;' class='xVal'></div></div><div  class='yContainer1 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label1'  style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal1' style='width:42%;float:left;margin-left:8%;'></div></div><div  class='yContainer2 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label2' style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal2' style='width:42%;float:left;margin-left:8%;'></div></div><div  class='yContainer3 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label3' style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal3' style='width:42%;float:left;margin-left:8%;'></div></div><div  class='yContainer4 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label4' style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal4' style='width:42%;float:left;margin-left:8%;'></div></div><div  class='yContainer5 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label5' style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal5' style='width:42%;float:left;margin-left:8%;'></div></div></div></div></div>";t("body").append(e)}},U={init:function(t,e,n,r,a){var i=Math.ceil(.15*e),o=Math.ceil(.5*e),l=Math.ceil(e/i),s=Math.ceil(n/o);
t.selectAll(".hline").data(d3.range(l)).enter().append("line").attr("y1",function(t){return t*i+6}).attr("y2",function(t){return t*i+6}).attr("x1",function(){return 0}).attr("x2",function(){return n}).style("stroke","#353b37").style("stroke-width",.3).attr("transform","translate("+r+","+a+")"),t.selectAll(".vline").data(d3.range(s)).enter().append("line").attr("x1",function(t){return t*o}).attr("x2",function(t){return t*o}).attr("y1",function(){return 0}).attr("y2",function(){return e}).style("stroke","#353b37").style("stroke-width",.1).attr("transform","translate("+r+","+a+")")}},H={drawLine:function(e){var n,e=t.extend({color:"red",axisColor:"blue",data:[],xFieldName:"",yFieldName:"",showAllTicks:!1,formatDate:"%b %d"},e);n=0==e.data.length?L:e.data;var r,a;if(r=""==e.xFieldName?N:e.xFieldName,a=""==e.yFieldName?D:e.yFieldName,0==t(f).find(".axis").length){var i=d3.time.format(e.formatDate);e.showAllTicks&&A.ticks(d3.time.days,1).tickFormat(i).tickSize(0).tickPadding(8),A.tickFormat(i).tickSize(0).tickPadding(8),p.append("g").attr("class","x axis").attr("transform","translate(0,"+(v-V.scale+10)+")").attr("stroke",e.axisColor).attr("fill","none").call(A).selectAll(".tick").each(function(t){var e=new Date(t);e=convertDateIntoYYMMDD(e),p.append("line").attr("class","horizontalGridLine").attr("x1",function(){return C(I.parse(e))}).attr("x2",function(){return C(I.parse(e))}).attr("y1",0).attr("y2",v-V.scale+10).attr("stroke","#F2F3F3")}),p.append("g").attr("class","y axis").attr("transform","translate("+(g-V.scale+10)+",3)").attr("fill",e.axisColor).call(b)}{var o=d3.svg.line().interpolate("linear").x(function(t){return C(I.parse(t[r]))+5}).y(function(t){return M(t[a])-10}),l=t(f).attr("id")+"_line"+D;p.append("path").attr("d",o(n)).attr("stroke",e.color).attr("class",l).attr("stroke-width","2").attr("fill","none").on("mouseover",function(){attachToolTip.showToolTip(d3.event)}).on("mouseleave",function(){attachToolTip.hideToolTip(d3.event)})}},drawBarWithMultipleLineAndCircle:function(e){function n(t,e){return(X=d3.svg.line().interpolate(t).x(function(t){return C(t.x)}).y(function(t){var e=V[t.name];return e(t.y)}))(e)}var e=t.extend({data:[],xAxis:[],marginLeft:40,marginRight:40,marginTop:60},e),r=e.xAxis.ticks;G.appendToolTipForBarWithMultipleLine();var a=e.data,i=[];i=d3.keys(e.data);var o=d3.scale.ordinal(),l=[],s=[];for(key in a){var u=a[key];l.push(u.color),s.push(u.data)}o.domain(i),o.range(l);for(var c=0,d=o.domain().map(function(t){return{name:t,values:a[t].data.map(function(n,r){return{x:r,y:n,timeIndex:e.xAxis.ticks[r],name:t,indicationLabel:a[t].indicationLabel}}),chartType:a[t].chartType,lineType:a[t].lineType}}),h={},y=0;y<d.length;y++)h[d[y].name]="legend-"+y;for(var x=[],k=0;k<d[0].values.length;k++){for(var u={},w=0;w<i.length;w++)u[i[w]]=d[w].values[k].y+":"+d[w].values[k].indicationLabel;u.x=k,u.timeIndex=e.xAxis.ticks[k],x.push(u)}T=1.4*T,v-=1.5*e.marginTop;for(var L=!1,_=0,N=0,D=40,F=40,V={},y=0;y<i.length;y++){L=!L,L?N=N+e.marginRight+D:_=_+e.marginLeft+D,S=d3.min(a[i[y]].data,function(t){return t}),T=d3.max(a[i[y]].data,function(t){return t}),T=1.5*T,M=d3.scale.linear().domain([S,T]).range([v,0]),V[i[y]]=M;var I=Y.getTickArray(S,T,5),P=p.append("g").attr("class","y axis").attr("transform",function(){return L?(b=d3.svg.axis().scale(M).orient("right").tickValues(I).tickSize(5,0),"translate("+(g-N)+","+e.marginTop+")"):(b=d3.svg.axis().scale(M).orient("left").tickValues(I).tickSize(5,0),"translate("+_+","+e.marginTop+")")}).attr("stroke",e.axisColor).attr("fill","none").call(b);if(P.selectAll("text").text(function(t){return t+" "+a[i[y]].unit}).style("fill",a[i[y]].color),L){var z=v/2+2*a[i[y]].indicationLabel.length;P.append("text").text(function(){return a[i[y]].indicationLabel}).attr("transform","translate("+(D+F)+","+z+") rotate(-90)").style("fill",a[i[y]].color)}else{var z=v/2+2*a[i[y]].indicationLabel.length;P.append("text").text(function(){return a[i[y]].indicationLabel}).attr("transform","translate("+(-D-F/2)+","+z+") rotate(-90)").style("fill",a[i[y]].color)}0==y&&P.selectAll(".tick").each(function(t){p.append("line").attr("class","horizontalGridLine").attr("x1",_).attr("x2",g-N).attr("y1",function(){return M(t)}).attr("y2",function(){return M(t)}).attr("stroke","#F2F3F3")}).style("display",function(){return e.hideAxis?"none":"block"})}g-=_;var E=p.append("g").attr("transform","translate("+(_-40)+","+e.marginTop+")").attr("class","grouping");C=d3.scale.linear().range([_,g-N]);var O=d3.min(d,function(t){return d3.min(t.values,function(t){return t.x})}),R=d3.max(d,function(t){return d3.max(t.values,function(t){return t.x})});C.domain([O,R]);for(var B=0,c=0;c<r.length;c++)B<r[c].toString().length&&(B=r[c].toString().length);A=d3.svg.axis().scale(C).orient("bottom").tickValues(Y.getXTickArray(0,r.length-1,B,g-N-_));var q=p.append("g").attr("class","x axis").attr("transform","translate("+(_-40)+","+(v+e.marginTop)+")").attr("stroke",e.axisColor).attr("fill","none").call(A);q.selectAll("text").text(function(t){return r[t]}).style("fill",m.legendTextColor);var j=d.filter(function(t){return"bar"==t.chartType}),U=g/j[0].values.length;U/=2;var H=E.selectAll(".bar").data(j[0].values).enter().append("rect").attr("class",function(t){return"multichart bar "+h[t.name]+" pos_"+Math.floor(C(t.x))}).attr("width",U).attr("height",function(){return 0}).attr("x",function(){return 0}).attr("y",function(t){var e=V[t.name];return e(t.y)});H.transition().duration(1e3).attr("x",function(t){return C(t.x)-U/2}).attr("height",function(t){var e=V[t.name];return v-e(t.y)}).attr("fill",function(t){return o(t.name)});var X,W=E.selectAll("g.multipleLineGrouping").data(d.filter(function(t){return"bar"!=t.chartType})).enter().append("g").attr("class","multipleLineGrouping"),$=W.append("path").attr("d",function(t){return n(t.lineType,t.values)}).attr("class",function(t){return"multipleLine "+h[t.name]+" pos_"+Math.floor(C(t.x))}).attr("stroke",function(t){return o(t.name)}).attr("fill","none"),J=$.node().getTotalLength();$.attr("stroke-dasharray",function(t){for(var e=3,n=2*e,r=e;J>n;)r+=","+e+","+e,n+=2*e;return dottedLineParam=a[t.name].isDottedLine?r+","+J:J+","+J}).attr("stroke-dashoffset",J).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0),W.selectAll("circle.multipleLineCircle").data(function(t){return t.values}).enter().append("circle").attr("class",function(t){return"multichart  multipleLineCircle "+h[t.name]+" pos_"+Math.floor(C(t.x))}).attr("cx",function(t){return C(t.x)}).attr("cy",function(t){var e=V[t.name];return e(t.y)}).attr("r","3").attr("fill",function(t){return o(t.name)});var Z=(g-N)/o.domain().slice().length;Z=_+Z;var K=E.selectAll(".legend").data(o.domain().slice().reverse()).enter().append("g").attr("transform",function(t,e){return"translate("+Z*(e+1)/2+",0)"}),Q=18,te=10,ee=0,ne=ee+Q+te;K.append("rect").attr("x",ee).attr("width",12).attr("height",12).style("fill",o).attr("class",function(t){return"legend-rect "+h[t]}).on("click",function(e){if(-1!=d3.select(this).attr("class").indexOf("disable")){var n="legend-rect";d3.select(this).attr("class",n),d3.select(this).style("fill",o),d3.select(".legend-text."+h[e]).style("text-decoration","line-through"),t(f).find(".multipleLineCircle."+h[e]).show();var r=p.selectAll(".multipleLine."+h[e]);r.transition().duration(1e3).ease("linear").attr("stroke-dashoffset",0),p.selectAll(".bar."+h[e]).transition().duration(1e3).attr("y",function(t){return M(t.y)}).attr("height",function(t){return v-M(t.y)})}else{t(this).addClass("disable");var n=t(this).attr("class");n+="  disable",d3.select(this).attr("class",n),d3.select(this).style("fill","grey"),d3.select(".legend-text."+h[e]).style("text-decoration","none"),t(f).find(".multipleLineCircle."+h[e]).hide();var r=p.selectAll(".multipleLine."+h[e]);r.transition().duration(1e3).ease("linear").attr("stroke-dashoffset",J),p.selectAll(".bar."+h[e]).transition().duration(1e3).attr("y",M(S)).attr("height",0)}}),K.append("text").attr("x",ne).attr("y",6).attr("dy",".35em").style("text-anchor","start").attr("class",function(t){return"legend-text  "+h[t]}).text(function(t){return t}).style("fill",m.legendTextColor),d3.selectAll(".multichart").on("mouseover",function(){var e=t(this).attr("class").split(" "),n=e[e.length-1];d3.selectAll("."+n).attr("stroke","blue");for(var r,a=d3.selectAll("circle."+n).attr("cx"),o=Math.floor(Math.floor(C.invert(a))),l=0;l<x.length;l++)x[l].x==o&&(r=x[l]);if(void 0!==r){for(var s="",u={},l=0;l<i.length;l++){var c=i[l],d=r[c].split(":")[0],f=r[c].split(":")[1];s+=c+" : "+d+" : "+f+" ",u[f]=d}G.showToolTipForBarWithMultipleLine(d3.event,u,r.timeIndex,!1,a,!0)}else G.hideMulitpleLineBarToolTip()}).on("mouseout",function(){d3.selectAll(".multichart").attr("stroke",""),G.hideMulitpleLineBarToolTip()})}},X={drawBrushing:function(e){function n(){var t=d3.mouse(this);s=l.append("g").attr("transform","translate(0,"+V.top+")").attr("class","brushedArea").append("rect").attr("class","brushedArea").attr("x",t[0]).attr("y",M(T)).attr("width",0).attr("height",function(){return d}).style("fill","rgba(1,1,1,.3)"),p=t[0],l.on("mousemove",i),h=!0}function r(){return o}function a(){if(h=!1,g){g=!1;for(var n=r(),a=0,i=0,o=!1,s=!1,d=0;d<n.length;d++){{n[d]}u==d&&(a=d,console.error("*** matched**"),o=!0),c==d&&(i=d,s=!0,console.error("*** matched ending**"))}o&&s&&(n=n.slice(a,i+1),i>a+3?(t(f).find("svg g").empty(),t(f).find(".brushedArea").remove(),l.on("mousemove",null),l.on("mousedown",null),l.on("mouseup",null),e(n)):(alert("further  zooming is not feasible"),t(f).find(".brushedArea").remove()))}}function i(){if(console.log("Mosuemove"),h){t(f).find("#tooltipChart").hide();var e=d3.mouse(this),n=e[0]-p;s.attr("width",n),u=Math.round(C.invert(e[1])),c=Math.round(C.invert(e[0])),console.log(Math.round(C.invert(e[1]))+":::"+Math.round(C.invert(e[0]))),g=!0}}var o=data,l=d3.select("."+t(f).attr("id")+"_svg");l.on("mousedown",n).on("mouseup",a);var s,u,c,d=v-V.scale,h=!1,p=0,g=!1}},W={barChart:function(e){var n,e=t.extend({color:"red",axisColor:"blue",data:[],hideYAxis:!1,widthOfBar:"",formatDate:"%b %d",showAllTicks:!1,yFieldName:"",textonBar:!1,yFieldName:"",padding:0,attachBrushEvent:!1,xAxisIndicationLabel:"",yAxisIndicationLabel:""},e);n=0==e.data.length?L:e.data;var r;r=""==e.yFieldName?D:e.yFieldName;var a;a=""==e.widthOfBar?Math.floor((g-V.scale)/n.length):e.widthOfBar;var i=t(f).attr("id"),o=i+"_rect_"+r;if(0==t(f).find(".axis").length){var l=d3.time.format(e.formatDate);e.showAllTicks&&A.ticks(d3.time.days,1).tickFormat(l).tickSize(0).tickPadding(8),A.tickFormat(l).tickSize(0).tickPadding(8);var s=p.append("g").attr("class","x axis").attr("transform","translate(0,"+(v-V.scale+10)+")").attr("stroke",e.axisColor).attr("fill","none").call(A);s.selectAll(".tick").each(function(t){var e=new Date(t);e=convertDateIntoYYMMDD(e),p.append("line").attr("class","horizontalGridLine").attr("x1",function(){return C(I.parse(e))}).attr("x2",function(){return C(I.parse(e))}).attr("y1",0).attr("y2",v-V.scale+10).attr("stroke","#F2F3F3")});var u=p.append("g").attr("class","y axis").attr("transform","translate("+(g-V.scale+10)+",3)").attr("stroke",e.axisColor).attr("fill","none").call(b);u.selectAll(".tick").each(function(t){p.append("line").attr("class","horizontalGridLine").attr("x1",0).attr("x2",g-V.scale+10).attr("y1",function(){return M(t)+3}).attr("y2",function(){return M(t)+3}).attr("stroke","#F2F3F3")}).style("display",function(){return e.hideAxis?"none":"block"})}var c=p.selectAll("."+o).data(n).enter().append("rect").attr("class",o).attr("x",function(t){return C(I.parse(t[N]))+e.padding}).attr("y",function(t){return M(t[r])}).attr("width",a).attr("height",function(){return M(T)}).on("mouseover",function(t){var e=t[r];d3.select(this).attr("fill","red");var n=I.parse(t[N]),a=convertDateIntoYYMMDD(n);attachToolTip.showToolTip(d3.event,e,a,void 0)}).on("mouseleave",function(t){t[r];d3.select(this).attr("fill",e.color),attachToolTip.hideTooTip()});c.transition().duration(2e3).attr("height",function(t){return v-V.scale-M(t[r])}).attr("fill",e.color),e.textonBar&&p.selectAll(".barText").data(n).enter().append("text").text(function(t){return parseInt(t[r])}).attr("x",function(t){return C(I.parse(t[N]))+2.5}).attr("y",function(t){return M(t[r])+20}),e.attachBrushEvent&&X.drawBrushing(n)},mulipleBarChart:function(e){for(var n,r,e=t.extend({barChartArray:[]},e),a=e.barChartArray,i=0;i<a.length;i++){var o=a[i],l=o.yFieldName,s=d3.extent(o.data,function(t){return t[l]});0==i?(n=s[0],r=s[1]):(n>s[0]&&(n=s[0]),r<s[1]&&(r=s[1]))}M.domain([n,r+3]);for(var i=0;i<a.length;i++){var o=a[i],u={};for(key in o)u[key]=o[key];this.barChart(u)}},stackedBarChart:function(e){function n(n,a){o=d3.keys(r[0]).filter(function(t){var n;return n=t!=e.xFieldName&&void 0==a[t]&&"groupedData"!=t&&"total"!=t});var s=r;s.forEach(function(t){var e=0;t.groupedData=o.map(function(n){return{x:t[N],y0:e,y1:e+=+t[n],name:n,exactYVal:t[n]}}),t.total=t.groupedData[t.groupedData.length-1].y1}),T=d3.max(s,function(t){return t.total}),S=d3.min(s,function(t){return t.total}),T=1.5*T;var d=d3.scale.linear().domain([0,T]).range([v,0]);b=d3.svg.axis().scale(d).orient("right").ticks(4).tickSize(5,0).tickFormat(d3.format(".2s")),p.select(".y.axis").call(b).selectAll(".tick").each(function(t){p.selectAll(".horizontalGridLine").attr("x1",0).attr("x2",g).attr("y1",function(){return d(t)}).attr("y2",function(){return d(t)}).attr("stroke","#F2F3F3")}).style("display",function(){return e.hideAxis?"none":"block"});var f=p.selectAll("g.stack-grouping").data(s).enter().append("g").attr("class","stack-grouping"),h=f.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(t){return C(t.x)}).attr("y",function(){return d(0)}).attr("class",function(t){return l[t.name]+" bar"}).attr("width",C.rangeBand()).attr("height",function(){return 0}).style("fill",function(t){return i[t.name]}).on("mouseover",function(t){d3.select(this).attr("fill","yellow");var n=[{headingName:e.columnHeadingArray[t.name],headingVal:t.exactYVal}];G.showToolTip(d3.event,"",t.x,!1,n)}).on("mouseleave",function(){var e=d3.select(this);d3.select(this).attr("fill",t(e).parents("g").attr("fill")),G.hideTooTip()});h.transition().duration(2e3).attr("height",function(t){return d(t.y0)-d(t.y1)}).attr("y",function(t){return d(t.y1)}).attr("fill",function(t){return i[t.name]}),u(p),c(p)}var e=t.extend({data:[],xFieldName:"",widthOfBar:"",axisColor:"black",hideAxis:!1,showAllTicks:!1,redrawing:!0,columnHeadingArray:[],xAxisIndicationLabel:"",yAxisIndicationLabel:""},e);g=g-P-V.left,v-=.25*v;var r=e.data;N=e.xFieldName;var a,i=(d3.layout.stack(),e.colorArray);a=""==e.widthOfBar?Math.floor(g/data.length):e.widthOfBar;for(var o=d3.keys(r[0]).filter(function(t){return t!=e.xFieldName}),l={},s=0;s<o.length;s++)l[o[s]]="legend-"+s;var d=r;d.forEach(function(t){var e=0;t.groupedData=o.map(function(n){return{x:t[N],y0:e,y1:e+=+t[n],name:n,exactYVal:t[n]}}),t.total=t.groupedData[t.groupedData.length-1].y1});for(var h=0;h<d.length;h++){d[h].groupedData}T=d3.max(d,function(t){return t.total}),S=d3.min(d,function(t){return t.total}),T=1.5*T,M=d3.scale.linear().domain([0,T]).range([v,0]),p=p.append("g").attr("transform","translate(0,"+V.top+")"),C=d3.scale.ordinal().rangeRoundBands([0,g],.1),C.domain(d.map(function(t){return t[N]})),A=d3.svg.axis().scale(C).orient("bottom"),b=d3.svg.axis().scale(M).orient("right").ticks(4).tickSize(5,0).tickFormat(d3.format(".2s"));var y=p.append("g").attr("class","x axis").attr("transform","translate(0,"+v+")").attr("fill","none").call(A);y.selectAll("text").attr("transform","translate(0,15) rotate(0)"),y.selectAll("text").call(q.wrapText,C.rangeBand());var x=p.append("g").attr("class","y axis").attr("transform","translate("+g+",0)").attr("fill","none").call(b);if(x.selectAll(".tick").each(function(){}).style("display",function(){return e.hideAxis?"none":"block"}),""!=e.xAxisIndicationLabel){var k=20,w=(V.scale-k/3,v+V.scale-k,v+V.scale+k,6),L=e.xAxisIndicationLabel.toString().length*w,_=.2*v,D=g/2-L/2;B.appendLabel(e.xAxisIndicationLabel,D,_,0,y,m.xLabelColor,600)}if(""!=e.yAxisIndicationLabel){var F=40,I=v/2-20,z=I+F,E=(g+V.scale-V.left+10,p.append("g").attr("transform","translate("+(g+P-V.left+5)+","+(z+30)+")"));B.appendLabel(e.yAxisIndicationLabel,0,.4*-(z+30),90,E,m.yLabelColor,600)}var O=p.selectAll("g.stack-grouping").data(d).enter().append("g").attr("class","stack-grouping"),R=O.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(t){return C(t.x)}).attr("y",function(){return M(0)}).attr("class",function(t){return l[t.name]+" bar"}).attr("width",C.rangeBand()).attr("height",function(){return 0}).style("fill",function(t){return i[t.name]}).on("mouseover",function(t){d3.select(this).attr("fill","yellow");var n=[{headingName:e.columnHeadingArray[t.name],headingVal:t.exactYVal}];G.showToolTip(d3.event,"",t.x,!1,n)}).on("mouseleave",function(){var e=d3.select(this);d3.select(this).attr("fill",t(e).parents("g").attr("fill")),G.hideTooTip()});R.transition().duration(1e3).attr("height",function(t){return M(t.y0)-M(t.y1)}).attr("y",function(t){return M(t.y1)});var Y=d3.keys(i),j=p.selectAll(".legend").data(Y).enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate("+V.left+","+(10+20*e)+")"}),U=18,H=10,X=0,W=X+U+H,$={};j.append("rect").attr("x",X).attr("width",18).attr("height",18).style("fill",function(t){return i[t]}).on("click",function(e){var r=!1;t("rect."+l[e]).length>1?(r=!0,$[e]=e,d3.select(this).style("text-decoration","grey"),d3.select(".legend-text."+l[e]).style("text-decoration","line-through")):(r=!1,delete $[e],d3.select(this).style("fill",i[e]),d3.select(".legend-text."+l[e]).style("text-decoration","none")),t(f).find("rect.bar").remove(),t(f).find("g.stack-grouping").remove(),n(e,$)}),j.append("text").attr("x",W).attr("y",9).attr("dy",".35em").style("text-anchor","start").attr("class",function(t){return"legend-text  "+l[t]}).text(function(t){return t}),u(p),c(p)},groupedBarChart:function(e){function n(n,r){l=d3.keys(o[0]).filter(function(t){var n;return n=t!=e.xFieldName&&void 0==r[t]&&"groupedData"!=t&&"timeIndex"!=t});o.forEach(function(t,e){t.groupedData=l.map(function(e){return{xVal:e,yVal:t[e]}}),t.timeIndex=e}),T=d3.max(a,function(t){return d3.max(t.groupedData,function(t){return t.yVal})}),T=1.5*T,M.domain([0,T]),b=d3.svg.axis().scale(M).orient("right").ticks(4).tickSize(5,0),y.domain(l).rangeRoundBands([0,h.rangeBand()]),p.selectAll(".y.axis").call(b);{var i=p.selectAll("g.bar-grouping").data(o).enter().append("g").attr("class","bar-grouping").attr("transform",function(){return"translate("+h(0)+",0)"});i.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(t){return y(t.xVal)}).attr("y",function(t){return M(t.yVal)}).attr("class",function(t){return"groupBar "+s[t.xVal]}).style("fill",function(t){return e.colors[t.xVal]}).attr("width",y.rangeBand()/1.2).attr("height",function(t){return v-M(t.yVal)}).on("mouseover",function(t){d3.select(this).attr("fill","yellow"),G.showToolTip(d3.event,t.yVal,t.xVal,!1,e.yIndicationLabel)}).on("mouseleave",function(){var e=d3.select(this);d3.select(this).attr("fill",t(e).parents("g").attr("fill")),G.hideTooTip()})}i.transition().duration(function(t,e){return 190*e}).attr("transform",function(t){return"translate("+h(t.timeIndex)+",0)"}),u(p),c(p)}var e=t.extend({data:[],xFieldName:"",widthOfBar:"",axisColor:"#a7a7a7",hideAxis:!1,yIndicationLabel:"Value"},e);g=g-P-V.left,v-=P;var r,a=(d3.layout.stack(),[]),i="";i=d3.scale.category20;var o=(e.colors,e.data);N=e.xFieldName,r=""==e.widthOfBar?Math.floor(g/o.length):e.widthOfBar;var l=d3.keys(o[0]).filter(function(t){return t!=e.xFieldName});o.forEach(function(t,e){t.groupedData=l.map(function(n){return{xVal:n,yVal:t[n],timeIndex:e,xFieldVal:t[N]}}),t.timeIndex=e});var s={};v=.8*v;for(var d=0;d<l.length;d++)s[l[d]]="legend-"+d;a=o,C=d3.time.scale().range([0,g],.5),C.domain(d3.extent(o,function(t){return t.timeIndex}));var h=d3.scale.ordinal().rangeRoundBands([0,g],.5),y=d3.scale.ordinal();h.domain(a.map(function(t){return t.timeIndex})),y.domain(l).rangeRoundBands([0,h.rangeBand()]),M=d3.scale.linear().range([v,.08*v]),T=d3.max(a,function(t){return d3.max(t.groupedData,function(t){return t.yVal})}),T=1.5*T,M.domain([0,T]),p=p.append("g").attr("transform","translate("+V.left+","+V.top+")");for(var x=0,k=[],w=0;w<a.length;w++)k[w]=a[w][N],x<k[w].toString().length&&(x=k[w].toString().length);A=d3.svg.axis().scale(h).orient("bottom").tickValues(Y.getXTickArray(0,k.length,x,g)),b=d3.svg.axis().scale(M).orient("right").ticks(4).tickSize(5,0);var S=p.append("g").attr("class","x axis").attr("transform","translate(0,"+v+")").attr("fill",e.axisColor).attr("fill","none").call(A);S.selectAll("text").text(function(t){return k[t]}).attr("fill","black");var L=p.append("g").attr("class","y axis").attr("transform","translate("+g+",0)").attr("fill",e.axisColor).attr("fill","none");L.call(b).selectAll(".tick").each(function(){}).style("display",function(){return e.hideAxis?"none":"block"});var _=v/1.5+e.yAxisfactor.length/2*5,D=1.2*V.right;B.appendLabel(e.yAxisfactor,D,_,-90,L,m.yLabelColor,600);var F=6,I=e.xAxisfactor.length*F,z=g/2-I/2,E=.2*v;B.appendLabel(e.xAxisfactor,z,E,0,S,m.xLabelColor,600);var F=9,O=g/2-e.title.length*F/2,R=p.append("g").attr("class","title");B.appendLabel(e.title,O,.06*v,0,R,m.chartTitleColor,800);var q=p.selectAll("g.bar-grouping").data(a).enter().append("g").attr("class","bar-grouping").attr("transform",function(t){return"translate("+h(t.timeIndex)+",0)"}),j=q.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(){return y(0)}).attr("y",function(){return M(0)}).attr("class",function(t){return"groupBar "+s[t.xVal]}).style("fill",function(t){return e.colors[t.xVal]}).attr("width",y.rangeBand()/1.2).attr("height",function(t){return v-M(t.yVal)}).on("mouseover",function(t){d3.select(this).style("fill","yellow");var n=[{headingName:t.xVal,headingVal:t.yVal}];G.showToolTip(d3.event,t.yVal,e.xAxisfactor+" "+t.xFieldVal,!1,n)}).on("mouseleave",function(){d3.select(this);d3.select(this).style("fill",function(t){return e.colors[t.xVal]}),G.hideTooTip()});j.transition().duration(function(t,e){return 600*e}).attr("x",function(t){return y(t.xVal)}).attr("y",function(t){return M(t.yVal)});var U=p.selectAll(".legend").data(l).enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate(0,"+(10+20*e)+")"}),H=18,X=10,W=0,$=W+H+X,J={};U.append("rect").attr("x",W).attr("width",18).attr("height",18).style("fill",function(t){return e.colors[t]}).attr("index",function(t,e){return e}).on("click",function(r){{var a=!1;parseInt(d3.select(this).attr("index"))}p.selectAll("rect."+s[r]).empty()?(a=!1,delete J[r],d3.select(this).style("fill",function(t){return e.colors[t]}),d3.select(".legend-text."+s[r]).style("text-decoration","none")):(a=!0,J[r]=r,d3.select(this).style("fill","grey"),d3.select(".legend-text."+s[r]).style("text-decoration","line-through")),t(f).find("rect.groupBar").remove(),t(f).find(".bar-grouping").remove(),n(r,J)}),U.append("text").attr("x",$).attr("y",9).attr("dy",".35em").style("text-anchor","start").attr("class",function(t){return"legend-text  "+s[t]}).text(function(t){return t}),u(p),c(p)},groupedBar2DChart:function(e,n){function r(n,r){d=d3.keys(s[0]).filter(function(t){var n;return n=t!=e.xFieldName&&void 0==r[t]&&"groupedData"!=t&&"timeIndex"!=t}),s.forEach(function(t,e){t.groupedData=d.map(function(e){return{xVal:e,yVal:t[e]}}),t.timeIndex=e});var i,o=s,l=d3.max(o,function(t){return d3.max(t.groupedData,function(t){return t.yVal})}),f=d3.min(o,function(t){return d3.min(t.groupedData,function(t){return t.yVal})});i=isNaN(a)?Math.ceil((l+f)/2):a,l=1.9*l,M.domain([f,l]),b=d3.svg.axis().scale(M).orient("right").ticks(4).tickSize(5,0),k.domain(d).rangeRoundBands([0,x.rangeBand()]),p.selectAll(".horizontalGridLine").remove();var g=Y.getTickArray(S,T,5);b.tickValues(g),p.selectAll(".y.axis").call(b).selectAll(".tick").each(function(t){console.log("************* text *******"+t)}).style("display",function(){return e.hideAxis?"none":"block"});{var y=p.selectAll("g.bar-grouping").data(o).enter().append("g").attr("class","bar-grouping").attr("transform",function(){return"translate("+x(0)+",0)"});y.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(t){return k(t.xVal)}).attr("y",function(t){return M(M(t.yVal)>=M(i)?i:t.yVal)}).attr("class",function(t){return"groupBar "+h[t.xVal]}).style("fill",function(t){return e.colors[t.xVal]}).attr("width",k.rangeBand()/1.2).attr("height",function(t){return M(t.yVal)>=M(i)?M(t.yVal)-M(i):M(i)-M(t.yVal)}).on("mouseover",function(t){d3.select(this).attr("fill","yellow"),G.showToolTip(d3.event,t.yVal,t.xVal,!1,e.yIndicationLabel)}).on("mouseleave",function(){var e=d3.select(this);d3.select(this).attr("fill",t(e).parents("g").attr("fill")),G.hideTooTip()})}y.transition().duration(function(t,e){return 190*e}).attr("transform",function(t){return"translate("+x(t.timeIndex)+",0)"}),u(p),c(p)}var a,e=t.extend({data:[],xFieldName:"",widthOfBar:"",axisColor:"#a7a7a7",hideAxis:!1,yIndicationLabel:"Value",midVal:""},e);a=isNaN(n)?"":n,g=g-P-V.left,v-=P,v=.9*v;var i,o=(d3.layout.stack(),[]),l="";l=d3.scale.category20;var s=(e.colors,e.data);N=e.xFieldName,i=""==e.widthOfBar?Math.floor(g/s.length):e.widthOfBar;var d=d3.keys(s[0]).filter(function(t){return t!=e.xFieldName});s.forEach(function(t,e){t.groupedData=d.map(function(e){return{xVal:e,yVal:t[e],xFieldVal:t[N]}}),t.timeIndex=e});for(var h={},y=0;y<d.length;y++)h[d[y]]="legend-"+y;o=s,C=d3.time.scale().range([0,g],.5),C.domain(d3.extent(s,function(t){return t.timeIndex}));var x=d3.scale.ordinal().rangeRoundBands([0,g],.5),k=d3.scale.ordinal();x.domain(o.map(function(t){return t.timeIndex})),k.domain(d).rangeRoundBands([0,x.rangeBand()]),M=d3.scale.linear().range([v,0]),T=d3.max(o,function(t){return d3.max(t.groupedData,function(t){return t.yVal})});var w,S=d3.min(o,function(t){return d3.min(t.groupedData,function(t){return t.yVal})});w=isNaN(a)?Math.ceil((T+S)/2):a,T=1.9*T,M.domain([S,T]),p=p.append("g").attr("transform","translate("+V.left+","+V.top+")");for(var L=0,_=[],D=0;D<o.length;D++)_[D]=o[D][N],L<_[D].toString().length&&(L=_[D].toString().length);A=d3.svg.axis().scale(x).orient("bottom").tickValues(Y.getXTickArray(0,_.length,L,g)),b=d3.svg.axis().scale(M).orient("right").ticks(4).tickSize(5,0);var F=p.append("g").attr("class","x axis").attr("transform","translate(0,"+v+")").attr("fill",e.axisColor).attr("fill","none");F.call(A).selectAll("text").text(function(t){return _[t]}).attr("fill","black");var I=p.append("g").attr("class","y axis").attr("transform","translate("+g+",0)").attr("fill",e.axisColor).attr("fill","none"),z=Y.getTickArray(S,T,5);-1==z.indexOf(w)&&z.push(w),b.tickValues(z),I.call(b).selectAll(".tick").each(function(){}).style("display",function(){return e.hideAxis?"none":"block"});var E=v/1.5+e.yAxisfactor.length/2*5,O=1.2*V.right;B.appendLabel(e.yAxisfactor,O,E,-90,I,m.yLabelColor,600);var R=6,q=e.xAxisfactor.length*R,j=g/2-q/2,U=.15*v;B.appendLabel(e.xAxisfactor,j,U,0,F,m.xLabelColor,600);var R=9,H=g/2-e.title.length*R/2,X=p.append("g").attr("class","title");B.appendLabel(e.title,H,.06*v,0,X,m.chartTitleColor,800);var W=p.selectAll("g.bar-grouping").data(o).enter().append("g").attr("class","bar-grouping").attr("transform",function(t){return"translate("+x(t.timeIndex)+",0)"}),$=W.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(){return k(0)}).attr("y",function(){return M(w)}).attr("class",function(t){return"groupBar "+h[t.xVal]}).style("fill",function(t){return e.colors[t.xVal]}).attr("width",k.rangeBand()/1.2).attr("height",function(t){return M(t.yVal)>M(w)?M(t.yVal)-M(w):M(w)-M(t.yVal)}).on("mouseover",function(t){d3.select(this).style("fill","yellow");var n=[{headingName:e.yAxisfactor,headingVal:t.yVal}];G.showToolTip(d3.event,"",t.xVal+" "+t.xFieldVal,!1,n)}).on("mouseleave",function(){d3.select(this);d3.select(this).style("fill",function(t){return e.colors[t.xVal]}),G.hideTooTip()});$.transition().duration(function(t,e){return 600*e}).attr("x",function(t){return k(t.xVal)}).attr("y",function(t){return M(M(t.yVal)>M(w)?w:t.yVal)});var J=p.selectAll(".legend").data(d).enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate(0,"+(10+20*e)+")"}),Z=18,K=10,Q=0,te=Q+Z+K,ee={};J.append("rect").attr("x",Q).attr("width",18).attr("height",18).style("fill",function(t){return e.colors[t]}).attr("index",function(t,e){return e}).on("click",function(n){{var a=!1;parseInt(d3.select(this).attr("index"))}p.selectAll("rect."+h[n]).empty()?(a=!1,delete ee[n],d3.select(this).style("fill",function(t){return e.colors[t]}),d3.select(".legend-text."+h[n]).style("text-decoration","none")):(a=!0,ee[n]=n,d3.select(this).style("fill","grey"),d3.select(".legend-text."+h[n]).style("text-decoration","line-through")),t(f).find("rect.groupBar").remove(),t(f).find(".bar-grouping").remove(),r(n,ee)}),J.append("text").attr("x",te).attr("y",9).attr("dy",".35em").style("text-anchor","start").attr("class",function(t){return"legend-text  "+h[t]}).text(function(t){return t}),u(p),c(p)},cricketAnalysis:function(t){for(var e={left:.1*g,right:.1*g,bottom:.2*v,top:.2*v,chartSeparator:5,xScalePaddingTop:.1*v,yScalePaddingLeft:.08*g},n=g-e.left-e.right,r=v-e.top-e.bottom,a=r+e.chartSeparator,i=e.bottom/3,o=a+i+e.chartSeparator,l=(e.bottom-i,t.data.tital),s=t.data.titalColor,u=t.data.yData,c=t.data.xData,d=t.data.xDatacolor,f=t.data.specialXData,h=t.data.specialDataLabel,y=t.data.specialData,m=t.data.specialXDataColor,x=t.data.specialXDataLabel,k=t.data.xLabelColor,w=t.data.yLabel,S=t.data.specialDataLabelOfWicket,T=(t.colorArray,t.xFieldName,t.yFieldName,t.axisColor),L=t.data.textColor,_=t.data["font-style"],N=10,D=30,F=50,V=14,I=14,P=14,z=[],E=u.length>c.length?u:c,O=0;O<E.length;O++){var R={};u[O]&&(R.y=u[O]),c[O]&&(R.x=c[O]),f[O]&&(R.specialX=f[O]),R.timeIndex=O,z.push(R)}C=d3.scale.linear().range([0,n]);var B=(d3.min(z,function(t){return t.x}),d3.max(z,function(t){return t.x}));C.domain([0,B]),M=d3.scale.linear().range([r,5.5]);var Y=(d3.min(z,function(t){return t.y}),d3.max(z,function(t){return t.y}));Y=1.5*Y,M.domain([0,Y]),p=p.append("g").attr("transform","translate("+e.left+","+e.top+")"),A=d3.svg.axis().scale(C).orient("bottom").ticks(10),b=d3.svg.axis().scale(M).orient("left").tickValues(d3.range(3,Y,Y/4));var q=d3.select("body").append("div").style("background","rgba(0,0,0,.6)").style("position","absolute").style("visibility","hidden").style("font-family","calibri").style("font-style","normal").style("color","white").style("padding","5px").text("a simple tooltip"),G=(p.append("g").attr("class","GridLineLImage"),p.append("g").attr("class","tital-Group-of-team").attr("transform","translate("+-e.yScalePaddingLeft+","+-e.top/1.5+")")),j=G.append("svg:defs").append("svg:linearGradient").attr("id","gradientTital").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(45)");j.append("stop").attr("offset","0").attr("stop-color","#0e0c1a"),j.append("stop").attr("offset","0.5").attr("stop-color","#414463"),j.append("stop").attr("offset","1").attr("stop-color","#0e0c1a"),G.append("rect").attr("width",n+e.yScalePaddingLeft+15).attr("height",e.top/1.7).attr("fill","url(#gradientTital)"),G.append("text").attr("x",30).attr("y",30).style("font-size","22").style("fill",s).style("font-family",_).text(l[0]+" v "+l[1]);{var U=p.append("g").attr("class","over-axis-grouping");U.append("rect").attr("class","over-axis-heading").attr("x",-e.yScalePaddingLeft).attr("y",a).attr("height",i).attr("width",e.yScalePaddingLeft).attr("fill","#131e4c")}U.append("text").attr("x",-e.yScalePaddingLeft/2).attr("y",a+i/2).attr("dy",".35em").attr("text-anchor","middle").text("OVERS").attr("fill",k).style("font-weight",400).style("font-family","Arial Black");
var H=U.append("g").attr("class","over-scale-group").attr("transform","translate(0,"+a+")"),X=H.append("svg:defs").append("svg:linearGradient").attr("id","gradientOverAxis").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(90)");X.append("stop").attr("offset","0").attr("stop-color","#182051"),X.append("stop").attr("offset","0.5").attr("stop-color","#8289b5"),X.append("stop").attr("offset",".8").attr("stop-color","#182051"),H.append("rect").attr("x",0).attr("y",0).attr("width",n+15).attr("height",i).attr("fill","url(#gradientOverAxis)");var W=H.call(A);d3.select(".over-scale-group").attr("fill","none"),W.selectAll("text").attr("dy",".35em").text(function(t){return 0==parseInt(t)?"":t}).attr("transform","translate(0,"+i/6+")").style("fill","white").style("font-family",_);{var $=p.append("g").attr("class","wicket-axis");$.append("rect").attr("class","wicket-axis-heading").attr("x",-e.yScalePaddingLeft).attr("y",o).attr("height",3*i).attr("width",e.yScalePaddingLeft).attr("fill","#9c9ca6")}$.append("image").attr("x",-e.yScalePaddingLeft/1.5).attr("y",o).attr("width",D).attr("height",F).attr("xlink:href",S);var J=$.append("g").attr("class","wicket-scale-group").attr("transform","translate(0,"+o+")");J.append("rect").attr("class","show-wicket-in-over").attr("x",0).attr("y",0).attr("width",n+15).attr("height",2*i).attr("fill","#9c9ca6");var Z=[],K=[];for(key in y)for(nestedKey in y[key])for(batsman in y[key][nestedKey])K.push(batsman),Z.push(key);J.selectAll("img").data(K).enter().append("image").attr("value",function(t){return t}).attr("x",function(t,e){return C(Z[e])-5}).attr("y",function(t,e){for(var n=0,r=e;r>=0;r--)Z[r]==Z[e]&&n++;return 1.1*n*N-N}).attr("width",N).attr("height",N).attr("fill","red").attr("xlink:href",h).on("mouseover",function(){t:for(key in y)for(nestedKey in y[key])for(batsman in y[key][nestedKey])if(batsman==d3.select(this).attr("value"))break t;q.style("visibility","visible").style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+10+"px").text(d3.select(this).attr("value")+" "+y[key][nestedKey][batsman])}).on("mouseout",function(){q.style("visibility","hidden")});var Q=p.append("g").attr("class","y axis").attr("transform","translate("+-e.yScalePaddingLeft+",0)").attr("stroke",T).attr("fill","none");b.tickSize(0,50);var te=Q.append("svg:defs").append("svg:linearGradient").attr("id","gradientYAxis").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(45)");te.append("stop").attr("offset","0").attr("stop-color","#9c9ca6"),te.append("stop").attr("offset","0.5").attr("stop-color","#ffffff"),te.append("stop").attr("offset","1").attr("stop-color","#9c9ca6"),Q.append("rect").attr("class","run-axis").attr("x",0).attr("y",0).style("stroke","none").attr("height",r).attr("width",e.yScalePaddingLeft).attr("fill","url(#gradientYAxis)");var ee=Q.call(b);ee.selectAll("text").attr("transform","translate("+e.yScalePaddingLeft+",0)").style("fill",L);var ne=p.append("g").attr("class","yaxislabel").attr("transform","translate("+2*-e.yScalePaddingLeft+","+2*e.bottom+")");ne.append("text").attr("x",0).attr("y",r/2.25).text(w).style("font-size","20").attr("transform","rotate(-90)").style("fill",L).style("font-family",_);var re=n/(z.length-1)*.5,ae=p.append("g").attr("class","simple-line").attr("transform","translate(0,0)");ae.append("line").attr("y1",function(){return 0}).attr("y2",function(){return r}).attr("x1",function(){return 0}).attr("x2",function(){return 0}).style("stroke","gray");var ie=p.append("g").attr("class","bar-rectangle").attr("transform","translate(0,0)"),oe=ie.append("svg:defs").append("svg:linearGradient").attr("id","gradientBar").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(45)");oe.append("stop").attr("offset","0").attr("stop-color","#9c9ca6"),oe.append("stop").attr("offset","0.5").attr("stop-color","#ffffff"),oe.append("stop").attr("offset","1").attr("stop-color","#0e0c1a"),ie.append("rect").attr("class","run-bar").attr("x",0).attr("y",0).style("stroke","none").attr("height",r).attr("width",n+15).attr("fill","url(#gradientBar)");var le={init:function(t,e,n,r,a){var i=Math.ceil(.2*e),o=Math.ceil(e/i);t.selectAll(".hline").data(d3.range(o)).enter().append("line").attr("y1",function(t){return t*i+6}).attr("y2",function(t){return t*i+6}).attr("x1",function(){return 0}).attr("x2",function(){return n}).style("stroke","gray").attr("transform","translate("+r+","+a+")")}};le.init(p,r,n,e.xScalePaddingLeft,e.xScalePaddingTop);var se=p.append("g").attr("class","legend-grouping").attr("transform","translate("+e.yScalePaddingLeft/4+",3)");se.append("rect").attr("width",V).attr("height",I).attr("fill",m),se.append("text").attr("x",I+3).attr("y",I/2).style("font-size !important",P).style("fill",L).style("font-family",_).text(x);{var ue=p.append("g").attr("class","bar-grouping").attr("transform","translate(0,0)"),ce=ue.selectAll(".runs-bar").data(z).enter().append("rect").attr("class","runs-bar").attr("x",function(t){return C(t.x)-re/2}).attr("y",function(t){return M(t.y)+re/2-5.5}).attr("width",re).attr("height",function(){return 0}).attr("fill",function(t){return-1==f.indexOf(t.x)?d:m}).style("z-index",51);ue.selectAll("circle").data(z).enter().append("circle").attr("class","runs-bar").attr("cx",function(t){return C(t.x)}).attr("cy",function(t){return M(t.y)+re/2-5.5}).attr("r",re/2).attr("fill",function(t){return-1==f.indexOf(t.x)?d:m}).style("z-index",1)}ce.transition().duration(1e3).attr("height",function(t){return M(0)-M(t.y)}),p.selectAll("text").style("font-weight",500)},bulletBar:function(t){var e,n=0;400>g?(n=80,e=80):(n=.2*g,e=.2*g);for(var r={left:n,right:e,bottom:.1*v,top:.1*v,chartSeparator:2,xScalePaddingTop:.1*v,yScalePaddingLeft:n},a=g-r.left-r.right,i=v-r.top-r.bottom,o=a/2-r.chartSeparator,l=a/2+r.chartSeparator,s=t.data1,d=t.data2,f=t.colorArray,h=t.xFieldName,y=t.yFieldName,x=t.axisColor,k=s[0][h],w=0;w<s.length;w++)s[w].timeIndex=w,s[w].customY=w,k=s[w][h]>d[w][h]?s[w][h]:d[w][h];for(var S=[],w=0;w<s.length;w++)S.push(s[w].customY);C=d3.scale.linear().range([o,0]);s[0].timeIndex;C.domain([0,k]);{var T=d3.scale.linear().range([o,0]);d3.min(s,function(t){return t[h]}),d3.max(s,function(t){return t[h]})}T.domain([0,k]),M=d3.scale.linear().range([i,0]);var L=(d3.min(s,function(t){return t[y]}),d3.max(s,function(t){return t.customY}));L=1.5*L,M.domain([0,L]),p=p.append("g").attr("transform","translate("+r.left+","+-r.top+")"),A=d3.svg.axis().scale(C).orient("bottom").ticks(10).tickSize(5,0),b=d3.svg.axis().scale(M).orient("left");var _=k/5;A.tickValues(d3.range(0,k,_));var N=p.append("g").attr("class","x axis").attr("transform","translate(0,"+(i+r.xScalePaddingTop)+")").attr("fill",x).attr("fill","none").call(A),D=p.append("g").attr("class","y axis").attr("transform","translate("+.05*-r.yScalePaddingLeft+",0)").attr("fill",x).attr("fill","none");b.tickValues(S);var F=D.call(b);F.selectAll(".tick").each(function(t){p.append("line").attr("class","horizontalGridLine").attr("x1",0).attr("x2",a).attr("y1",function(){return M(t)}).attr("y2",function(){return M(t)}).attr("stroke","#a7a7a7").attr("stroke-width",.4)}).style("display",function(){}),F.selectAll("text").text(function(t,e){var n="";return parseInt(s[e].customY)==e&&(n=s[e][y]),n});var I=y+"-1",P=p.append("g").attr("class","bar-grouping"),z=i/(s.length-1)*.3,E=z/2,O=P.selectAll("."+I).data(s).enter().append("rect").attr("class",""+I).attr("x",function(){return C(0)}).attr("y",function(t){return M(t.customY)-E}).attr("height",z).attr("width",function(){return 0}).on("mouseover",function(t,e){var n=[{headingName:h,headingVal:t[h]}];G.showToolTip(d3.event,"",y+" "+s[e][y],!1,n),d3.select(this).style("fill","yellow")}).on("mouseleave",function(){G.hideTooTip(),d3.select(this).style("fill",f[0])});O.transition().duration(1e3).attr("x",function(t){return T(t[h])}).attr("width",function(t){return C(0)-T(t[h])}).attr("fill",function(){return f[0]});for(var w=0;w<d.length;w++)d[w].timeIndex=w,d[w].customY=w;for(var R=[],w=0;w<d.length;w++)R.push(d[w].customY);var Y=d3.scale.linear().range([l,a]),q=(d[0].timeIndex,d3.max(d,function(t){return t[h]}));Y.domain([0,q]);var j=d3.svg.axis().scale(Y).orient("bottom").ticks(10).tickSize(5,0),_=q/5;j.tickValues(d3.range(0,q,_)),p.append("g").attr("class","x axis").attr("transform","translate(0,"+(i+r.xScalePaddingTop)+")").attr("fill",x).attr("fill","none").call(j).selectAll("text").text(function(t,e){var n="";return 0==e?n:t});var U=p.append("g").attr("class","y axis").attr("transform","translate("+(a+.1*r.yScalePaddingLeft)+",0)").attr("fill",x).attr("fill","none"),H=d3.svg.axis().scale(M).orient("right");H.tickValues(R);var X=U.call(H);X.selectAll("text").text(function(t,e){var n="";return parseInt(d[e].customY)==e&&(n=d[e][y]),n});{var W=d3.scale.linear().range([0,a-l]);d3.min(d,function(t){return t[h]}),d3.max(d,function(t){return t[h]})}W.domain([0,k]);var $=p.append("g").attr("class","bar-grouping"),J=y+"-2",Z=z/2,K=$.selectAll("."+J).data(d).enter().append("rect").attr("class",""+J).attr("x",function(){return Y(0)}).attr("y",function(t){return M(t.customY)-Z}).attr("height",z).attr("width",function(){return 0}).on("mouseover",function(t,e){var n=[{headingName:h,headingVal:t[h]}];G.showToolTip(d3.event,"",y+" "+s[e][y],!1,n),d3.select(this).style("fill","yellow")}).on("mouseleave",function(){G.hideTooTip(),d3.select(this).style("fill",f[1])});K.transition().duration(1e3).attr("width",function(t){return W(t[h])}).attr("fill",function(){return f[1]});var Q=F.selectAll("path"),te=Q.node().getTotalLength(),ee=6,ne=t.yLabel.length*ee,re=te/2+ne/2,ae=5.5*-V.left,ie=5.5*V.left;B.appendLabel(t.yLabel,ae,re,-90,F,m.yLabelColor,600),B.appendLabel(t.yLabel,ie,re,-90,X,m.yLabelColor,600);var oe=t.xLabel.length*ee,le=a/2-oe/2,se=.15*i;B.appendLabel(t.xLabel,le,se,0,N,m.xLabelColor,600);var ee=9,ue=a/2-t.title.length*ee/2,ce=p.append("g").attr("class","title");B.appendLabel(t.title,ue,1.5*r.top,0,ce,m.chartTitleColor,800),u(p),c(p)},setYSclae:function(t,e){var n,r,a=d3.extent(data,function(e){return e[t]}),i=d3.extent(data,function(t){return t[e]}),o=a[0],l=a[1],s=i[0],u=i[1];n=o>s?s:o,r=l>u?l:u,S=n,T=r,M.domain([S,T])},barWithLogo:function(e){g=t(f).width(),v=.7*t(f).height(),F=t(f).attr("id"),t("#"+F).empty();var n=F+"_svg";p=d3.select("#"+F).append("svg").attr("width","100%").attr("height",v).attr("class",n).attr("viewBox","0 0 "+Math.max(g,v)+" "+Math.min(g,v)).attr("preserveAspectRatio","xMinYMin");for(var r={left:.1*g,right:.1*g,bottom:.05*v,top:.07*v,chartSeparator:5},a=g-r.left-r.right,i=v-r.top-r.bottom,o=e.data.title,l=(e.data.titalColor,e.data.yData),s=e.data.xData,d=e.data.imagePathArray,y=e.data.xData,x=e.data.color,k=e.data.xIndicationLabel,w=e.data.yIndicationLabel,S=[],T=l.length>s.length?l:s,L=[],_=0;_<T.length;_++){var N={timeIndex:_,x:s[_],y:l[_],imagePath:d[_],name:y[_]};S.push(N),L.push(_)}C=d3.scale.linear().range([0,a-r.right]);var D=(S[0].timeIndex,S[S.length-1].timeIndex);C.domain([0,D]),M=d3.scale.linear().range([i,0]);var V=(d3.min(S,function(t){return t.y}),d3.max(S,function(t){return t.y}));V=1.5*V,M.domain([0,V]);var I=9,P=a/2-o.length*I/2,z=p.append("g").attr("class","title");B.appendLabel(o,P,.06*v,0,z,m.chartTitleColor,800),p=p.append("g").attr("transform","translate("+r.left+","+r.top+")");var I=7,E=w.toString().length*I,O=i/2+E/2,R=-r.left/2;B.appendLabel(w,R,O,-90,p,m.yLabelColor,600),A=d3.svg.axis().scale(C).orient("bottom").ticks(10),b=d3.svg.axis().scale(M).orient("left");var Y=(p.append("g").attr("class","x axis").attr("transform","translate(0,"+i+")"),p.append("g").attr("class","y axis").attr("transform","translate(0,0)"));A.tickValues(L),Y.call(b);var q=a/S.length*.5,j=p.append("g").attr("class","bar-grouping"),U=j.selectAll(".bar").data(S).enter().append("rect").attr("width",q).attr("height",function(){return 0}).attr("x",function(t){return C(t.timeIndex)}).attr("y",function(t){return M(t.y)}).attr("fill",function(){return x}).on("mouseover",function(t){var e=[{headingName:w,headingVal:t.y}];G.showToolTip(d3.event,"",k+" "+t.x,!1,e),d3.select(this).style("fill","yellow")}).on("mouseleave",function(){G.hideTooTip(),d3.select(this).style("fill",x)});U.transition().duration(1e3).attr("height",function(t){return M(0)-M(t.y)});{var H=d3.select("#"+h).append("div").style("left",C(0)).style("width",a).style("height",.4*v),X=H.selectAll(".xScalebar").data(S).enter().append("div").style("width",q).style("height",.2*v).style("left",function(){return 0}).style("position","absolute").style("display","inline-block");X.append("img").style("width",q+"px").style("height",.2*v+"px").attr("src",function(t){return t.imagePath}).on("mouseover",function(t){var e=[{headingName:w,headingVal:t.y}];G.showToolTip(d3.event,"",k+" "+t.x,!1,e)}).on("mouseleave",function(){G.hideTooTip()})}X.transition().duration(1e3).style("left",function(t,e){return 0==e?r.left+4+"px":r.left+4+C(t.timeIndex)+"px"}),X.append("div").style("width",q).style("height",.1*v).style("margin-top",.05*v).style("left",function(t,e){return 0==e?r.left:r.left+C(t.timeIndex)}).style("color","#a7a7a7").html(function(t){return t.name}).style("word-wrap","break-word"),u(p),c(p)}},$={squareChart:function(e){var n,e=t.extend({color:"red",axisColor:"blue",data:[],xFieldName:"",yFieldName:"",widthOfSquare:20},e);n=0==e.data.length?L:e.data;var r,a;r=""==e.xFieldName?N:e.xFieldName,a=""==e.yFieldName?D:e.yFieldName;var i=(Math.floor((g-V.scale)/n.length),t(f).attr("id")),o=i+"_square_"+a,l=e.widthOfSquare,s=35;p.selectAll("."+o).data(n).enter().append("rect").attr("class",o).attr("x",function(t){return C(I.parse(t[r]))-l*s/100+7}).attr("y",function(t){return M(t[a])-3*(l*s/100)}).attr("width",l).attr("height",function(){return l}).attr("fill",e.color).on("mouseover",function(t){t[a];d3.select(this).attr("width",l+5).attr("height",l+5),attachToolTip.showToolTip(d3.event)}).on("mouseleave",function(t){t[a];d3.select(this).attr("width",l).attr("height",l),attachToolTip.hideTooTip()}),0==t(f).find(".axis").length&&(p.append("g").attr("class","x axis").attr("transform","translate(0,"+(v-V.scale+10)+")").attr("stroke",e.axisColor).attr("fill","none").call(A),p.append("g").attr("class","y axis").attr("transform","translate("+(g-V.scale+10)+",3)").attr("stroke",e.axisColor).attr("fill","none").call(b))}},J={circleChart:function(e){var n,e=t.extend({color:"red",axisColor:"blue",r:10,data:[]},e);n=0==e.data.length?L:e.data;var r=(Math.floor((g-V.scale)/n.length),t(f).attr("id")),a=r+"_circle";p.selectAll("."+a).data(n).enter().append("circle").attr("class",a).attr("cx",function(t,n){return C(n)+e.r/2}).attr("cy",function(t){return M(t[D])}).attr("r",e.r).attr("fill",e.color).on("mouseover",function(t){console.log(JSON.stringify(t));var n=[{headingName:_.yAxisIndicationLabel,headingVal:t[D]}];G.showToolTip(d3.event,"",t[N],!1,n);t[D];d3.select(this).attr("r",e.r+5),d3.select(this).attr("stroke","cyan"),d3.select(this).attr("stroke-width","2").style("opacity","0.5")}).on("mouseleave",function(t){t[D];d3.select(this).attr("r",e.r),G.hideTooTip(),d3.select(this).attr("stroke","none"),d3.select(this).attr("stroke-width","0").style("opacity","1")}),0==t(f).find(".axis").length&&(p.append("g").attr("class","x axis").attr("transform","translate(0,"+(v-V.scale+7)+")").attr("stroke",e.axisColor).attr("fill","none").call(A).selectAll("text").text(function(t){return n[t][N]}),p.append("g").attr("class","y axis").attr("transform","translate("+(g-V.scale+5)+",3)").attr("stroke",e.axisColor).attr("fill","none").call(b))}};n();var Z={pieChart:function(e){var n,e=t.extend({data:[]},e);n=0==e.data.length?L:e.data;var r=g/2,a=0,i=d3.svg.arc().innerRadius(a).outerRadius(r),o=d3.svg.arc().outerRadius(r+10),l=d3.layout.pie(),s=d3.scale.category20(),u=p.append("svg").attr("width",g).attr("height",v),c=u.selectAll("g.arc").data(l(n)).enter().append("g").attr("class","slice").attr("stroke","white").attr("stroke-width",3).attr("transform","translate("+r+","+r+")").on("mouseover",function(t){d3.select("#piechartTooltip").style("left",d3.event.pageX+"px").style("top",d3.event.pageY+"px").style("opacity",10).select("#value").text(t.value),d3.select(this).attr("stroke","white").transition().duration(100).attr("d",o).attr("stroke-width",10)}).on("mouseout",function(){d3.select("#piechartTooltip").style("opacity",0),d3.select(this).transition().attr("d",i).attr("stroke","white").attr("stroke-width",3)});c.append("path").attr("fill",function(t,e){return s(e)}).attr("d",i)}},K={drawPyramidChart:function(t,e,n,a){var i=-20,o=200;g-=V.scale,v-=V.scale,scaleX=d3.scale.linear().domain([i,o]).range([0,g]),scaleY=d3.scale.linear().domain([0,80]).range([v,0]),color=d3.scale.category10();var l,u=s(r(t)).arrayOfPolygons;l=n?p.append("g").attr("transform","translate("+(g-g/6)+","+(v+v/4)+") rotate(180)"):p.append("g").attr("transform","translate("+g/6+",0)"),l.selectAll("polygon").data(u).enter().append("polygon").attr("points",function(t){return t.points.map(function(t){return[scaleX(t.x),scaleY(t.y)].join(",")}).join(" ")}).attr("fill",function(t,n){return e[n].color}).attr("stroke-width",0).data(u).on("mouseover",function(t,n){var r=[{headingName:a,headingVal:e[n].amount}];G.showToolTip(d3.event,"",e[n].accountName,!1,r)}).on("mouseout",function(){G.hideTooTip()});var c=p.append("g").attr("class","legend").attr("transform",function(){return"translate("+.01*g+",10)"}),d=20,f=10,h=0,y=h+d+f;c.selectAll(".rect").data(e).enter().append("g").append("rect").attr("class","pyramidLegend").attr("width",d).attr("height",d).attr("y",function(t,e){return 1.5*e*d}).attr("fill",function(t,n){return e[n].color}),c.selectAll(".text").data(e).enter().append("text").attr("x",y).attr("y",function(t,e){return 1.5*e*d+d/2}).attr("dy",".35em").attr("class",function(t){return"legend-text  "+t}).attr("fill","white").text(function(t,n){return e[n].accountName})},draw3DPyramidSliceChart:function(t){function e(){return.6*outFactor*2}function n(){var t=180*Math.atan(outFactor/(.6*outFactor))/Math.PI;return t}function r(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function a(t){for(var e=outFactor,n=[],r=0;r<t.length;r++)n.push(e*t[r]/100),A.push(t[r]);return A.sort(function(t,e){return parseInt(t)<parseInt(e)}),n.sort(function(t,e){return parseInt(t)<parseInt(e)}),n}function i(){return.6*outFactor}function o(t,e,n,a){for(var i=r(e)/Math.sin(t*(Math.PI/180)),o=[],l=0;l<e.length;l++)o.push(i*e[l]/i-a*e[l]/i);return o}function l(t,e){var n=t*Math.cos(e*(Math.PI/180));return n}function s(t,e,n){var a=r(e),i=r(n),o=Math.sin(a/(i-t)),l=180*o/Math.PI;return l}function u(t,e){console.log("  Angle : "+t+" bottomWidth : "+e);var n=t*(Math.PI/180),r=Math.tan(n)*e;return r}function c(t,e,n,r,a,o,c,d,f,h,p,g,v,k,A){var M=t,w=e,C=[];if(1!=k){if(1==a)for(var S=0;5>S;S++){0==S?e-=n:1==S?e+=n:2==S?0==g?(t-=i(),e-=o):(t=y,e=m-v):3==S?(t+=l(d,s(o,h,c)+T,p,n),e-=d,y=t,m=e):4==S&&(t=M,e=w-n);var L=e,_=t;C.push(JSON.parse('{"x":'+_+',"y":'+L+',"value":'+A+"}"))}else if(2==a)for(var S=0;5>S;S++){0==S?e-=n:1==S?e+=n:2==S?0==g?(t+=i(),e-=o):(t=x,e=b-v):3==S?(t-=l(d,s(o,h,c)+T,p,n),e-=d,N.push(t),D.push(e),x=t,b=e):4==S&&(t=M,e=w-n);var L=e,_=t;C.push(JSON.parse('{"x":'+_+',"y":'+L+',"value":'+A+"}"))}else if(3==a&&1!=k)for(var F,V,S=0;5>S;S++){0==S?(F=t,e-=n,V=e):1==S?(t=y,e=m):2==S?(t+=M-y,e-=V-m):3==S?(t=x,e=b):4==S&&(t=M,e=w-n);var L=e,_=t;C.push(JSON.parse('{"x":'+_+',"y":'+L+',"value":'+A+"}"))}}else{var I=t-y,P=u(f,I);if(1==a)for(var S=0;5>S;S++){0==S?(e-=P,M=t,w=e):1==S?e+=P:2==S?0==g?(t-=i(),e-=o):(t=y,e=m-v):3==S&&(t=M,e=w);var L=e,_=t;C.push(JSON.parse('{"x":'+_+',"y":'+L+',"value":'+A+"}"))}else if(2==a)for(var S=0;4>S;S++){0==S?(e-=P,M=t,w=e):1==S?e+=P:2==S?(t=x,e=b-v):3==S&&(t=M,e=w,N.push(t),D.push(e),b=e);var L=e,_=t;C.push(JSON.parse('{"x":'+_+',"y":'+L+',"value":'+A+"}"))}else if(3==a&&1!=k)for(var F,V,S=0;5>S;S++){0==S?(F=t,e-=n,V=e):1==S?(t=y,e=m):2==S?(t+=M-y,e-=V-m):3==S?(t=x,e=b):4==S&&(t=M,e=w-n);var L=e,_=t;C.push(JSON.parse('{"x":'+_+',"y":'+L+',"value":'+A+"}"))}}return C}function d(t,e,n,r){for(var a=[],i=0;3>i;i++){0==i?(t=t,e+=n/2):1==i?t+=.3*outFactor/2:2==i&&(t+=.025*outFactor,e+=.025*outFactor);var o=e,l=t;a.push(JSON.parse('{"x":'+l+',"y":'+o+',"value":'+r+"}"))}return a}var f=O.getValueToPercentageArray(t.data),h=v>g?g:v;outFactor=.6*h;var y,m,x,b,k=10,A=[],M=a(f),w=n(),C=30,S=o(w,M,0,C),T=0,L=t.colorArray,_=[{x:0,y:400},{x:0,y:400},{x:0,y:400},{x:0,y:400},{x:0,y:400}],N=[],D=[],F=0,V=0;g>v?(F=(g-outFactor)/2,V=0):(F=0,V=(v-outFactor)/2.1);for(var I=({x:(h-e())/2,y:(h-e())/2},d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("linear")),P=p.append("g").attr("transform","translate("+(F-.4*outFactor)+","+(V-.15*outFactor)+")"),z=.3*h+.1*h,E=h,R=(M[0],d3.scale.category20c(),E),B=0,Y=k,q=0,G=0;G<M.length;G++){G==M.length-1&&(q=1);{P.append("path").attr("d",I(_)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(2e3).ease("linear").attr("d",I(c(z,R,M[G],f,1,C,S,S[G],w,M,B,G,Y,q,A[G]))).style("opacity",.7).attr("stroke","white").attr("stroke-width",1).attr("fill",function(){return L[G]}),P.append("path").attr("d",I(_)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(1500).ease("linear").attr("d",I(c(z,R,M[G],f,2,C,S,S[G],w,M,B,G,Y,q,A[G]))).attr("stroke","white").style("opacity",.5).attr("stroke-width",.5).attr("fill",function(){return L[G]}),P.append("path").attr("d",I(_)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(1e3).ease("linear").attr("d",I(c(z,R,M[G],f,3,C,S,S[G],w,M,B,G,Y,q,A[G]))).style("opacity",.3).attr("stroke","white").attr("stroke-width",.3).attr("fill",function(){return L[G]})}R=E-M[G]-k,E=R,B=M[G]}for(var j=200>outFactor?"10px":"12px",U=0;U<N.length;U++)P.append("path").attr("x",outFactor).attr("y",outFactor).transition().delay(function(){return 600*U}).ease("bounce").attr("d",I(d(N[U],D[U],M[U],A[U]))).attr("stroke",function(){return L[U]}).attr("stroke-width",1).attr("fill","none"),P.append("text").attr("x",outFactor).attr("y",outFactor).transition().delay(function(){return 600*U}).ease("bounce").attr("x",N[U]+.15*outFactor).attr("y",D[U]+.1*outFactor+M[U]/2).text(t.labels[U]+":"+t.data[U]+" "+t.unit).attr("font-family","sans-serif").attr("font-size",j).attr("fill",L[U])},draw3DPyramidChartWithoutSlice:function(t){function e(){return.6*outFactor*2}function n(){var t=180*Math.atan(outFactor/(.6*outFactor))/Math.PI;return t}function r(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function a(t){for(var e=outFactor,n=[],r=0;r<t.length;r++)n.push(e*t[r]/100),A.push(t[r]);return A.sort(function(t,e){return parseInt(t)<parseInt(e)}),n.sort(function(t,e){return parseInt(t)<parseInt(e)}),n}function i(){return.6*outFactor}function o(t,e,n,a){for(var i=r(e)/Math.sin(t*(Math.PI/180)),o=[],l=0;l<e.length;l++)o.push(i*e[l]/i-a*e[l]/i);return o}function l(t,e){var n=t*Math.cos(e*(Math.PI/180));return n}function s(t,e,n){var a=r(e),i=r(n),o=Math.sin(a/(i-t)),l=180*o/Math.PI;return l}function u(t,e){console.log("  Angle : "+t+" bottomWidth : "+e);var n=t*(Math.PI/180),r=Math.tan(n)*e;return r}function c(t,e,n,r,a,o,c,d,f,h,p,g,v,k,A){var M=t,w=e,C=[];if(1!=k){if(1==a)for(var S=0;5>S;S++){0==S?e-=n:1==S?e+=n:2==S?0==g?(t-=i(),e-=o):(t=y,e=m-v):3==S?(t+=l(d,s(o,h,c)+T,p,n),e-=d,y=t,m=e):4==S&&(t=M,e=w-n);var L=e,_=t;C.push(JSON.parse('{"x":'+_+',"y":'+L+',"value":'+A+"}"))}else if(2==a)for(var S=0;5>S;S++){0==S?e-=n:1==S?e+=n:2==S?0==g?(t+=i(),e-=o):(t=x,e=b-v):3==S?(t-=l(d,s(o,h,c)+T,p,n),e-=d,N.push(t),D.push(e),x=t,b=e):4==S&&(t=M,e=w-n);var L=e,_=t;C.push(JSON.parse('{"x":'+_+',"y":'+L+',"value":'+A+"}"))}else if(3==a&&1!=k)for(var F,V,S=0;5>S;S++){0==S?(F=t,e-=n,V=e):1==S?(t=y,e=m):2==S?(t+=M-y,e-=V-m):3==S?(t=x,e=b):4==S&&(t=M,e=w-n);var L=e,_=t;C.push(JSON.parse('{"x":'+_+',"y":'+L+',"value":'+A+"}"))}}else{var I=t-y,P=u(f,I);if(1==a)for(var S=0;5>S;S++){0==S?(e-=P,M=t,w=e):1==S?e+=P:2==S?0==g?(t-=i(),e-=o):(t=y,e=m-v):3==S&&(t=M,e=w);var L=e,_=t;C.push(JSON.parse('{"x":'+_+',"y":'+L+',"value":'+A+"}"))}else if(2==a)for(var S=0;4>S;S++){0==S?(e-=P,M=t,w=e):1==S?e+=P:2==S?(t=x,e=b-v):3==S&&(t=M,e=w,N.push(t),D.push(e),b=e);var L=e,_=t;C.push(JSON.parse('{"x":'+_+',"y":'+L+',"value":'+A+"}"))}else if(3==a&&1!=k)for(var F,V,S=0;5>S;S++){0==S?(F=t,e-=n,V=e):1==S?(t=y,e=m):2==S?(t+=M-y,e-=V-m):3==S?(t=x,e=b):4==S&&(t=M,e=w-n);var L=e,_=t;C.push(JSON.parse('{"x":'+_+',"y":'+L+',"value":'+A+"}"))}}return C}function d(t,e,n,r){for(var a=[],i=0;3>i;i++){0==i?(t=t,e+=n/2):1==i?t+=.3*outFactor/2:2==i&&(t+=.025*outFactor,e+=.025*outFactor);var o=e,l=t;a.push(JSON.parse('{"x":'+l+',"y":'+o+',"value":'+r+"}"))}return a}var f=O.getValueToPercentageArray(t.data),h=v>g?g:v;outFactor=.6*h;var y,m,x,b,k=0,A=[],M=a(f),w=n(),C=30,S=o(w,M,0,C),T=0,L=t.colorArray,_=[{x:0,y:400},{x:0,y:400},{x:0,y:400},{x:0,y:400},{x:0,y:400}],N=[],D=[],F=0,V=0;g>v?(F=(g-outFactor)/2,V=0):(F=0,V=(v-outFactor)/2.1);for(var I=({x:(h-e())/2,y:(h-e())/2},d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("linear")),P=p.append("g").attr("transform","translate("+(F-.4*outFactor)+","+(V-.2*outFactor)+")"),z=.3*h+.1*h,E=h,R=(M[0],d3.scale.category20c(),E),B=0,Y=k,q=0,G=0;G<M.length;G++){G==M.length-1&&(q=1);{P.append("path").attr("d",I(_)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(2e3).ease("linear").attr("d",I(c(z,R,M[G],f,1,C,S,S[G],w,M,B,G,Y,q,A[G]))).style("opacity",.7).attr("stroke","white").attr("stroke-width",1).attr("fill",function(){return L[G]}),P.append("path").attr("d",I(_)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(1500).ease("linear").attr("d",I(c(z,R,M[G],f,2,C,S,S[G],w,M,B,G,Y,q,A[G]))).attr("stroke","white").style("opacity",.5).attr("stroke-width",.5).attr("fill",function(){return L[G]}),P.append("path").attr("d",I(_)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(1e3).ease("linear").attr("d",I(c(z,R,M[G],f,3,C,S,S[G],w,M,B,G,Y,q,A[G]))).style("opacity",.3).attr("stroke","white").attr("stroke-width",.3).attr("fill",function(){return L[G]})}R=E-M[G]-k,E=R,B=M[G]}for(var j=200>outFactor?"10px":"12px",U=0;U<N.length;U++)P.append("path").attr("x",outFactor).attr("y",outFactor).transition().delay(function(){return 600*U}).ease("bounce").attr("d",I(d(N[U],D[U],M[U],A[U]))).attr("stroke",function(){return L[U]}).attr("stroke-width",1).attr("fill","none"),P.append("text").attr("x",outFactor).attr("y",outFactor).transition().delay(function(){return 600*U}).ease("bounce").attr("x",N[U]+.15*outFactor+3*U).attr("y",D[U]+.1*outFactor+M[U]/2-3*U).text(t.labels[U]+":"+t.data[U]+" "+t.unit).attr("font-family","sans-serif").attr("font-size",j).attr("fill",L[U])}},Q={drawRadarChart:function(t,e,n){var r=g>v?v:g,a=.1*g,i=.1*v,o=0;g>v?(a=Math.round(g-v)/3,o=a):(i=Math.round(v-g)/3,o=i);var l={radius:10,w:r-o,h:r-o,factor:1,factorLegend:.85,levels:3,maxValue:0,radians:2*Math.PI,opacityArea:0,ToRight:5,TranslateX:a,TranslateY:i,ExtraWidthX:100,ExtraWidthY:100,color:d3.scale.category20()};if("undefined"!=typeof n)for(var s in n)"undefined"!=typeof n[s]&&(l[s]=n[s]);l.maxValue=Math.max(l.maxValue,d3.max(e,function(t){return d3.max(t.map(function(t){return t.value}))}));for(var u,c=e[0].map(function(t){return t.axis}),d=c.length,f=l.factor*Math.min(l.w/2,l.h/2),h=d3.format(""),y=p.append("svg:g").attr("width",l.w+l.ExtraWidthX).attr("height",l.h+l.ExtraWidthY).append("g").attr("transform","translate("+.3*g+","+l.TranslateY+")"),x=0;x<l.levels;x++){var b=l.factor*f*((x+1)/l.levels);y.selectAll(".levels").data(c).enter().append("svg:line").attr("x1",function(t,e){return b*(1-l.factor*Math.sin(e*l.radians/d))}).attr("y1",function(t,e){return b*(1-l.factor*Math.cos(e*l.radians/d))}).attr("x2",function(t,e){return b*(1-l.factor*Math.sin((e+1)*l.radians/d))}).attr("y2",function(t,e){return b*(1-l.factor*Math.cos((e+1)*l.radians/d))}).attr("class","line").style("stroke","grey").style("stroke-opacity","3.75").style("stroke-width","0.5px").attr("transform","translate("+(l.w/2-b)+", "+(l.h/2-b)+")")}for(var x=0;x<l.levels;x++){var b=l.factor*f*((x+1)/l.levels);y.selectAll(".levels").data([0]).enter().append("svg:text").attr("x",function(){return b*(1-l.factor*Math.sin(0))}).attr("y",function(){return b*(1-l.factor*Math.cos(0))}).attr("class","legend").style("font-family","sans-serif").style("font-size","12px").attr("transform","translate("+(l.w/2-b+l.ToRight)+", "+(l.h/2-b)+")").style("fill",m["font-color"]).text(h((x+1)*l.maxValue/l.levels))}series=0;var k=y.selectAll(".axis").data(c).enter().append("g").attr("class","axis");k.append("line").attr("x1",l.w/2).attr("y1",l.h/2).attr("x2",function(t,e){return l.w/2*(1-l.factor*Math.sin(e*l.radians/d))}).attr("y2",function(t,e){return l.h/2*(1-l.factor*Math.cos(e*l.radians/d))}).attr("class","line").style("stroke","grey").style("stroke-width","1px"),k.append("text").attr("class","legend").text(function(t){return t}).style("font-family","sans-serif").style("font-size","11px").attr("text-anchor","middle").attr("dy","1.5em").attr("transform",function(){return"translate(0, -10)"}).style("fill",m["font-color"]).attr("x",function(t,e){return l.w/2*(1-l.factorLegend*Math.sin(e*l.radians/d))-60*Math.sin(e*l.radians/d)}).attr("y",function(t,e){return l.h/2*(1-Math.cos(e*l.radians/d))-20*Math.cos(e*l.radians/d)}),e.forEach(function(t){dataValues=[],y.selectAll(".nodes").data(t,function(t,e){dataValues.push([l.w/2*(1-parseFloat(Math.max(t.value,0))/l.maxValue*l.factor*Math.sin(e*l.radians/d)),l.h/2*(1-parseFloat(Math.max(t.value,0))/l.maxValue*l.factor*Math.cos(e*l.radians/d))])}),dataValues.push(dataValues[0]),y.selectAll(".area").data([dataValues]).enter().append("polygon").attr("class","radar-chart-serie"+series).style("stroke-width","2px").style("stroke",l.color(series)).attr("points",function(t){for(var e="",n=0;n<t.length;n++)e=e+t[n][0]+","+t[n][1]+" ";return e}).style("fill",function(){return l.color(series)}).style("fill-opacity",l.opacityArea).on("mouseover",function(){z="polygon."+d3.select(this).attr("class"),y.selectAll("polygon").transition(200).style("fill-opacity",.1),y.selectAll(z).transition(200).style("fill-opacity",.9)}).on("mouseout",function(){y.selectAll("polygon").transition(200).style("fill-opacity",l.opacityArea)}),series++}),series=0,e.forEach(function(t){y.selectAll(".nodes").data(t).enter().append("svg:circle").attr("class","radar-chart-serie"+series).attr("r",l.radius).attr("alt",function(t){return Math.max(t.value,0)}).attr("cx",function(t,e){return dataValues.push([l.w/2*(1-parseFloat(Math.max(t.value,0))/l.maxValue*l.factor*Math.sin(e*l.radians/d)),l.h/2*(1-parseFloat(Math.max(t.value,0))/l.maxValue*l.factor*Math.cos(e*l.radians/d))]),l.w/2*(1-Math.max(t.value,0)/l.maxValue*l.factor*Math.sin(e*l.radians/d))}).attr("cy",function(t,e){return l.h/2*(1-Math.max(t.value,0)/l.maxValue*l.factor*Math.cos(e*l.radians/d))}).attr("data-id",function(t){return t.axis}).style("fill",l.color(series)).style("fill-opacity",1.9).on("mouseover",function(t){newX=parseFloat(d3.select(this).attr("cx"))-10,newY=parseFloat(d3.select(this).attr("cy"))-5,u.attr("x",newX).attr("y",newY).text(h(t.value)).transition(100).style("opacity",1),z="polygon."+d3.select(this).attr("class"),y.selectAll("polygon").transition(100).style("fill-opacity",.1),y.selectAll(z).transition(200).style("fill-opacity",.7)}).on("mouseout",function(){u.transition(200).style("opacity",0),y.selectAll("polygon").transition(200).style("fill-opacity",l.opacityArea)}).append("svg:title").text(function(t){return Math.max(t.value,0)}).style("fill",m["font-color"]),series++}),u=y.append("text").style("opacity",0).style("font-family","sans-serif").style("font-size","13px")}},te={drawCombinationalChart:function(t){function e(){{var t=d3.svg.line().x(function(t,e){return R(E[e])
}).y(function(t,e){return q(M.dataOfLine1[e])});H.selectAll(".path").data([M.xAxisData]).enter().append("path").attr("d",t).attr("stroke",function(){return M.color[0]}).attr("stroke-width",3).attr("fill","none")}H.selectAll("rect").data(M.xAxisData).enter().append("rect").attr("class","country1").attr("value",function(t,e){return e}).attr("fill",function(t,e){return M.dataOfLine1[e]<0?"red":M.color[0]}).attr("x",function(t,e){return R(E[e])-b/2}).attr("y",function(t,e){return q(M.dataOfLine1[e])-b/2}).attr("width",function(t,e){return M.dataOfLine1[e]<0?b+1:b}).attr("height",function(t,e){return M.dataOfLine1[e]<0?b+1:b}).on("mouseover",function(){ce.style("visibility","visible"),re.style("visibility","visible").style("display","none"),n(d3.event,d3.select(this).attr("value"))}).on("mouseout",function(){ce.style("visibility","hidden"),re.style("visibility","hidden"),G.hideTooTip()});{var e=d3.svg.line().x(function(t,e){return console.log("years="+M.xAxisData[e]),R(E[e])}).y(function(t,e){return console.log("dataOfLine2"+M.dataOfLine2[e]),q(M.dataOfLine2[e])}).interpolate("cardinal");H.selectAll(".path").data([M.xAxisData]).enter().append("path").attr("d",e).attr("stroke",M.color[1]).attr("stroke-width",3).attr("fill","none")}H.selectAll("circle").data(M.xAxisData).enter().append("circle").attr("class","country2").attr("value",function(t,e){return e}).attr("fill",function(t,e){return M.dataOfLine2[e]<0?"red":M.color[1]}).attr("cx",function(t,e){return R(E[e])}).attr("cy",function(t,e){return q(M.dataOfLine2[e])}).attr("r",function(t,e){return M.dataOfLine2[e]<0?x+1:x}).on("mouseover",function(){ce.style("visibility","visible"),re.style("visibility","visible").style("display","none"),n(d3.event,d3.select(this).attr("value"))}).on("mouseout",function(){ce.style("visibility","hidden"),re.style("visibility","hidden"),G.hideTooTip()})}function n(t,e){L=0,I=M.xAxisData[e],r(e,t),z=[M.PieData.Data1[e],M.PieData.Data2[e]],a()}function r(t,e){var n;n=M.dataOfLine1[t]>M.dataOfLine2[t]?M.xAxisData[t]+"=>"+M.labelLine1+" "+M.yLabel+" "+M.dataOfLine1[t]+"<br>"+M.xAxisData[t]+"=>"+M.labelLine2+" "+M.yLabel+" "+M.dataOfLine2[t]:M.xAxisData[t]+"=>"+M.labelLine2+" "+M.yLabel+" "+M.dataOfLine2[t]+"<br>"+M.xAxisData[t]+"=>"+M.labelLine1+" "+M.yLabel+" "+M.dataOfLine1[t];var r=[{headingName:M.labelLine2+" "+M.yLabel,headingVal:M.dataOfLine2[t]},{headingName:M.labelLine1+" "+M.yLabel,headingVal:M.dataOfLine1[t]}];G.showToolTip(e,"",M.xAxisData[t],!1,r)}function a(){d3.select("#dountGroup").remove();var t=H.append("g").attr("id","dountGroup").attr("transform","translate("+D.left+","+D.top+")"),e=d3.layout.pie().sort(null).value(function(t){return 0>t?0:t}),n=t.selectAll(".arc").data(e(z)).enter().append("g").attr("value",function(t,e){return 0==e?M.labelLine1:M.labelLine2}).attr("fill",function(t,e){return M.color[e]}).on("mouseover",function(){return d3.select(this).transition().duration(500).ease("bounce").attr("transform",function(t){var e=8;t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var n=Math.sin(t.midAngle)*e,r=-Math.cos(t.midAngle)*e;return"translate("+n+","+r+")"}),re.style("visibility","visible")}).on("mousemove",function(){s(d3.select(this).attr("value"))}).on("mouseout",function(){return d3.select(this).transition().duration(500).ease("bounce").attr("transform","translate(0,0)"),re.style("visibility","hidden")});n.append("path").attr("d",X).transition().duration(1500).attrTween("d",i)}function i(t){var e=d3.interpolate({startAngle:-180*P,endAngle:-180*P},t);return function(t){return X(e(t))}}function o(){T=d3.min(d3.min(M.dataOfLine1)<d3.min(M.dataOfLine2)?M.dataOfLine1:M.dataOfLine2),S=d3.max(d3.max(M.dataOfLine1)>d3.max(M.dataOfLine2)?M.dataOfLine1:M.dataOfLine2)}function l(){var t=j.append("g").attr("id","legendGroup").attr("class","legend").attr("transform","translate("+(2*D.left+1.5*_)+","+(2*D.top-k)+")");t.selectAll("rect").data(M.color).enter().append("rect").attr("class","legend").attr("fill",function(t,e){return M.color[e]}).attr("y",function(t,e){return 2*e*k}).attr("width",k).attr("height",k),t.selectAll("text").data(M.color).enter().append("text").attr("x",function(){return k+3}).attr("y",function(t,e){return 0==e?k:3*k}).style("font-size",12).style("font-family","calibri").style("font-style","italic").text(function(t,e){return 0==e?M.labelLine1+" "+M.yLabel:M.labelLine2+" "+M.yLabel})}function s(t){var e;e=t==M.labelLine1?I+"=>"+M.labelLine1+" "+M.pieDataFactor+" "+z[0]:I+"=>"+M.labelLine2+" "+M.pieDataFactor+" "+z[1],re.style("z-index",1).style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+10+"px").text(e)}function d(){var t,e,n,r,a=H.append("g").attr("id","clickedSymbolGroup").attr("transform","translate(0,0)"),i=[];for(key in M.clickedInfo)i.push(M.xAxisData.indexOf(parseInt(key)));a.selectAll("img").data(i).enter().append("image").attr("value",function(t){return M.xAxisData[t]}).attr("x",function(t){return R(t)-v/2}).attr("y",function(a,o){t=f(M.xAxisData[a]),e=M.dataOfLine1[t],n=M.dataOfLine2[t],r=e>n?e:n;for(var l=0,s=o;s>=0;s--)i[s]==i[o]&&++l;return q(r)-1.5*v*l}).attr("width",v).attr("height",v).attr("xlink:href",M.clickedSybmol).on("click",function(){g(d3.select(this).attr("value"))})}function f(t){for(var e=0;e<M.xAxisData.length&&M.xAxisData[e]!=t;e++);return e}function g(t){d3.select("#innerDiv").text(M.clickedInfo[t]),ae.style("visibility","visible"),ae.style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+10+"px"),re.style("visibility","hidden")}var y,v,x,b,k,A=h,M=t,w=parseInt(d3.select("#"+A).style("width")),C=parseInt(d3.select("#"+A).style("height"));y=401>w?8:601>w?10:13,301>C?(v=10,x=3,b=5,k=7):(v=18,x=5,b=8,k=12);for(var S,T,L,_,N,D={top:.1*C,right:.1*w,bottom:.12*C,left:.1*w},F=w-D.left-D.right,V=C-D.top-D.bottom,I=(d3.select("#"+A),M.xAxisData[0]),P=Math.PI/180,z=[M.PieData.Data1[0],M.PieData.Data2[0]],E=[],O=0;O<M.xAxisData.length;O++)E[O]=O;o();var R=d3.scale.linear().domain([0,M.xAxisData.length]).range([0,F]),q=d3.scale.linear().domain([T,2*S]).range([V,0]),j=(d3.select("#"+A),p);U.init(p,V,F,D.left,D.top);var H=j.append("g").attr("id","combinationalGroup").attr("transform","translate("+D.left+","+D.top+")");_=D.top,N=_-.6*_;var X=d3.svg.arc().innerRadius(N).outerRadius(_);a(),l(),d();var W=9,$=F/2-M.title.length*W/2,J=p.append("g").attr("class","title");B.appendLabel(M.title,$,D.top/2,0,J,m.chartTitleColor,800);var W=6,Z=M.xAxisLabel.toString().length*W,K=V+.12*V,Q=F/2-Z/2;B.appendLabel(M.xAxisLabel,Q,K,0,H,m.xLabelColor,600);var te=M.yLabel.toString().length*W,ee=V/2+te/2,ne=-D.left/2;B.appendLabel(M.yLabel,ne,ee,-90,H,m.yLabelColor,600);var re=d3.select("body").append("div").style("background","rgba(0,0,0,.6)").style("position","absolute").style("visibility","hidden").style("font-family","calibri").style("font-style","normal").style("color","white").style("padding","5px").text("a simple tooltip").style("display","none"),ae=d3.select("body").attr("id","outerDiv").append("div").style("width","200px").style("background","#1f77b4").style("position","absolute").style("visibility","hidden").style("font-family","calibri").style("font-style","normal").style("padding","2px").style("box-shadow","0 0 10px #ccc").style("color","white").style("font-size",15).text("NEWS");ae.append("img").attr("id","closeButton").style("float","right").style("margin-top","-10px").style("margin-right","-10px").attr("src","http://stocinn.github.io/stocweb/img/cross.png").on("click",function(){ae.style("visibility","hidden")}),ae.append("div").attr("id","innerDiv").style("padding","5px 10px 5px 10px").style("font-size",12).style("color","black").style("background","#fff").text("inner box"),e();for(var ie=0,O=0;O<M.xAxisData.length;O++)ie<M.xAxisData[O].toString().length&&(ie=M.xAxisData[O].toString().length);var oe=d3.svg.axis().scale(R).orient("bottom").tickValues(Y.getXTickArray(0,M.xAxisData.length,ie,F)),le=H.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+V+")").call(oe);le.selectAll("text").text(function(t){return M.xAxisData[t]}).attr("font-family","calibri");var se=d3.svg.axis().scale(q).orient("left").tickValues(Y.getTickArray(T,2*S,10));H.append("g").attr("id","y axis").attr("class","yAxis").attr("font-size",y).attr("transform","translate( 0 , 0)").call(se),d3.select(".yAxis path").attr("fill","none");var ue=[],ce=(d3.svg.line().x(function(){return ue[L++]}).y(function(){return ue[L++]}),j.append("path").data([ue]).attr("stroke","gray").attr("stroke-width",1).attr("fill","none"));u(p),c(p)}},ee={drawDrillDownChart:function(t,e,n){function r(){function r(e,r){var l=e;if("undefined"!=typeof l){o.remove(),o=p.append("svg").attr("width",g).attr("height",1.5*v).append("g").attr("transform","translate("+i+","+.05*v+")"),S=d3.scale.ordinal().rangeRoundBands([i,g-.05*g],.1).domain(l.map(function(t){return t.x}));var s=d3.max(l,function(t){return t.y});s=1.5*s,T=d3.scale.linear().range([v-.08*v,.08*v]).domain([0,s]),_=d3.svg.axis().scale(S).tickSize(5).tickSubdivide(!1),N=d3.svg.axis().scale(T).tickSize(5).orient("left").tickSubdivide(!1);for(var d=l[0].name.length,f=0;f<l.length;f++){var h=l[f].name.length;h>d&&(d=h)}var y=Y.getXTickArray(0,l.length,d,g-a.rightMargin);_.tickValues(y);var x=o.append("svg:g").attr("class","x axis").attr("transform","translate(0,"+(v-a.bottomMargin)+")").call(_);x.selectAll("text").text(function(t){return l[t].name});var b=o.append("svg:g").attr("class","y axis").attr("transform","translate("+a.leftMargin+",-35)").call(N);o.selectAll("rect").data(l).enter().append("rect").attr("id",t).on("mouseover",function(t){var e=[{headingName:a.yLabel,headingVal:t.y}];G.showToolTip(d3.event,"",a.xLabel+" "+t.name,!1,e)}).on("mouseout",function(){G.hideTooTip()}).attr("x",0).attr("y",v).transition().duration(1200).attr("x",function(t){return S(t.x)}).attr("y",function(t){return T(t.y)-a.bottomMargin}).attr("width",S.rangeBand()).attr("height",function(t){return v-T(t.y)}).attr("fill",function(t,e){return r[e]});var k=6,A=a.yLabel.toString().length*k,M=v/2+A/2,w=-i-.5*i;B.appendLabel(a.yLabel,w,M,-90,b,m.xLabelColor,600);var A=a.xLabel.toString().length*k,C=.1*v,D=g/2-A/2;B.appendLabel(a.xLabel,D,C,0,x,m.yLabelColor,600),d3.select(".resetDrillDownBtn").on("click",function(){ee.drawDrillDownChart(t,L,n),d3.select(".resetDrillBtnGroup").style("display","none")}),u(p),c(p)}}var i;i=30>.05*g?30:.05*g;var o=p.append("svg:g").attr("width",g).attr("height",v).attr("class","backtobrand").attr("transform","translate("+i+","+.1*v+")").append("g"),l=[],s=0,d=0,f=0;for(var h in e){d<e[h].data&&(d=e[h].data),f>e[h].data&&(f=e[h].data);var y=e[h].subData,x=[],b=0;for(var k in y){var A=y[k],M={name:k,x:b,y:A};x.push(M),b++}var w={x:s,y:e[h].data,color:e[h].color,subDataColorArray:e[h].subDataColorArray,name:h,subData:x};l.push(w),s++}var C=d;C=1.2*C;var S=d3.scale.ordinal().rangeRoundBands([i,g-.05*g],.1).domain(l.map(function(t,e){return e})),T=d3.scale.linear().range([v-a.topMargin,a.bottomMargin]).domain([0,C]),_=d3.svg.axis().scale(S).tickSize(5).tickSubdivide(!0),N=d3.svg.axis().scale(T).tickSize(5).orient("left").tickSubdivide(!1),D=o.append("svg:g").attr("class","x axis").attr("transform","translate(0,"+(v-a.bottomMargin)+")").call(_);D.selectAll("text").text(function(t){return l[t].name}),D.selectAll("text").call(q.wrapText,40);var F=o.append("svg:g").attr("class","y axis").attr("transform","translate("+a.leftMargin+","+-a.bottomMargin+")").call(N);if(o.selectAll("rect").data(l).enter().append("rect").on("click",function(t){t.subData.length>0?r(t.subData,t.subDataColorArray):alert("dont have sub data"),d3.select(".resetDrillBtnGroup").style("display","block")}).on("mousemove",function(t){var e=[{headingName:a.yLabel,headingVal:t.y}];G.showToolTip(d3.event,"",a.xLabel+" "+t.name,!1,e,.95*d3.event.pageY)}).on("mouseleave",function(){G.hideTooTip()}).attr("x",0).attr("y",v).transition().duration(1200).attr("x",function(t){return S(t.x)}).attr("y",function(t){return T(t.y)-a.bottomMargin}).attr("width",S.rangeBand()).attr("height",function(t){return v-T(t.y)}).attr("fill",function(t){return t.color}).style("cursor",function(t){return t.subData.length>0?"pointer":""}),d3.select(".resetDrillDownBtn").empty()){var I=70,P=30,z=p.append("g").attr("class","resetDrillBtnGroup").attr("transform","translate("+(g-3*a.leftMargin)+","+V.top+")");z.append("rect").attr("width",I).attr("height",P).attr("x","0").attr("y","0").attr("rx","2").attr("ry","2").attr("class","resetDrillDownBtn").on("mouseover",function(){d3.select(".resetDrillDownBtn").style("fill","#7F7FFF")}).on("mouseout",function(){d3.select(this).style("fill","#19a586")}).style("fill","#19a586").style("display","inline-block").style("cursor","pointer"),z.append("text").attr("x",20).attr("y",P/2).attr("dy",".35em").attr("class","resetDrillDownBtn").text("Reset").attr("fill","white"),d3.select(".resetDrillBtnGroup").style("display","none")}var E=6,O=a.yLabel.toString().length*E,R=v/2+O/2,j=-i;B.appendLabel(a.yLabel,j,R,-90,F,m.yLabelColor,600);var O=a.xLabel.toString().length*E,U=.1*v,H=g/2-O/2;B.appendLabel(a.xLabel,H,U,0,D,m.xLabelColor,600),u(p),c(p)}var a={topMargin:5,rightMargin:30,bottomMargin:0,leftMargin:10,color:d3.scale.category20(),toolTipLabel:"Drilled Chart",redraw:"false"},i=9,o=g/2-n.title.length*i/2,l=p.append("g").attr("class","title");if(B.appendLabel(n.title,o,.06*v,0,l,m.chartTitleColor,800),"undefined"!=typeof n)for(var s in n)"undefined"!=typeof n[s]&&(a[s]=n[s]);p.selectAll(".tick").empty()?(L=e,v-=.2*v):p.selectAll("g").remove(),r()}},ne={variationAnalysis:function(t){var e,n,r,a,i,o={left:.1*g,right:.1*g,bottom:.15*v,top:.15*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},l=t.data.title,s=t.data.subTitle,d=(t.data.titleColor,t.data.yAxisData),f=t.data.yAxisLabel,h=t.data.xAxisData,y=t.data.xAxisLabel,x=g-o.left-o.right,b=v-o.top-o.bottom;501>g?(a=18,i=8,e=11,n=9,r=9):(a=20,i=12,e=14,n=10,r=10);for(var k="calibri",A=[],M=[],w=0,C=0;C<h.length;C++)for(var S=0;2>S;S++)0==S?A[w]=h[C][S]:M[w++]=h[C][S];variationMainGroup=p.append("g").attr("class","main-group").attr("transform","translate("+o.left+","+o.top+")");var T=9,L=x/2-l.length*T/2,_=p.append("g").attr("class","title");B.appendLabel(l,L,o.top/3,0,_,m.chartTitleColor,800),L=x/2-s.length*T/2,B.appendLabel(s,L,-o.top/2.6,0,variationMainGroup,m.chartTitleColor,600);var N={init:function(t,e,n,r,a){var o=Math.ceil(.2*e),l=Math.ceil(n/o);t.selectAll(".vline").data(d3.range(l)).enter().append("line").attr("x1",function(t){return t*(n/i)}).attr("x2",function(t){return t*(n/i)}).attr("y1",function(){return 0}).attr("y2",function(){return e}).style("stroke","#353b37").style("stroke-width",.3).attr("transform","translate("+r+","+a+")")}};N.init(variationMainGroup,b,x,0,0);var D=d3.scale.linear().domain([0,d.length-1]).range([0,b]),F=d3.svg.axis().scale(D).orient("left").tickValues(Y.getTickArray(0,d.length-1,12)),T=(variationMainGroup.append("g").attr("class","y axis").attr("transform","translate(0,0)").attr("fill","none").call(F).selectAll("text").text(function(t){return d[t]}).attr("fill","black"),8),V=f.toString().length*T,I=b/2+V/2,P=-o.left/2;B.appendLabel(f,P,I,-90,variationMainGroup,m.yLabelColor,600);{var z=d3.scale.linear().domain([1.5*d3.min(A),1.5*d3.max(M)]).range([0,x]),E=d3.svg.axis().scale(z).orient("bottom");variationMainGroup.append("g").attr("class","x axis").attr("transform","translate(0,"+(b+10)+")").attr("font-size",e).attr("fint-family",k).call(E).selectAll("text").attr("fill","black")}d3.select(".x-axis").attr("fill","none");var O=y.toString().length*T,R=b+.15*b,q=x/2-O/2;B.appendLabel(y,q,R,0,variationMainGroup,m.xLabelColor,600);var G=variationMainGroup.append("g").attr("class","rectangle-group").attr("transform","translate(0,0)"),j=G.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(0)");j.append("stop").attr("offset","0").attr("stop-color","#00ff73"),j.append("stop").attr("offset","1").attr("stop-color","#00ffe7");var U=(d3.min(A)+d3.max(M))/2,H=G.selectAll("rect").data(M).enter().append("rect").attr("value",function(t,e){return e}).attr("x",function(){return z(U)}).attr("y",function(t,e){return D(e)}).attr("width",function(){return 0}).attr("height",n).attr("fill","url(#rectangleGradient)");H.transition().duration(1e3).attr("x",function(t,e){return z(A[e])}).attr("width",function(t,e){return z(M[e])-z(A[e])}),G.selectAll("text").data(M).enter().append("text").attr("x",function(t,e){return z(A[e])-(A[e].toString().length+y.length)*T}).attr("y",function(t,e){return D(e)+T}).attr("font-size",r).attr("font-family",k).attr("fill",m.yLabelColor).text(function(t,e){return A[e]+" "+y});var X=variationMainGroup.append("g").attr("class","rectangleTextRightSide").attr("transform","translate(0,0)");X.selectAll("text").data(M).enter().append("text").attr("x",function(t,e){return z(M[e])+5}).attr("y",function(t,e){return D(e)+T}).attr("font-size",r).attr("font-family",k).attr("fill",m.yLabelColor).text(function(t,e){return M[e]+" "+y}),u(p),c(p)}},re={drawPieChartWithTransition:function(e){function n(t){var e=d3.interpolate({startAngle:-180*y,endAngle:-180*y},t);return function(t){return b(e(t))}}for(var e=t.extend({data:[]},e),r=e.value,a=e.label,i=e.key,o=0,l=0;l<i.length;l++)o<i[l].length&&(o=i[l].length);var s=18,u=v>g?g:v,d=.1*u,f=(u-d)/2;f=f-5*o-2*s;var h=0,y=Math.PI/180,x=d3.layout.pie().sort(null).startAngle(0*y).endAngle(360*y),b=d3.svg.arc().innerRadius(h).outerRadius(f),k=d3.svg.arc().innerRadius(h).outerRadius(f+14),A="";A=null==e.color?d3.scale.category20b():function(t){return e.color[t]};var M=p.append("g").attr("transform","translate("+.1*-g+",0)"),w=M.selectAll("g.arc").data(x(r)).enter().append("g").attr("class","slice").attr("stroke","white").attr("stroke-width",0).attr("transform","translate("+g/2+","+v/3+")").on("mouseover",function(t,e){JSON.parse('{"'+a+'":'+t.value+"}");d3.select("#"+i[e].replace(/ /g,"")+"text").transition().attr("x",34).style("font-weight","bold").style("fill","bold"),M.select("#"+i[e].replace(/ /g,"")+"path").attr("stroke","white").transition().duration(500).attr("d",k).attr("stroke-width",1);var n=[{headingName:a,headingVal:t.value}];G.showToolTip(d3.event,"",i[e],!1,n)}).on("mouseleave",function(t,e){d3.select("#"+i[e].replace(/ /g,"")+"text").transition().attr("x",24).style("font-weight",m["font-weight"]),M.select("#"+i[e].replace(/ /g,"")+"path").transition().attr("d",b).attr("stroke-width",0),G.hideTooTip()});w.append("path").attr("fill",function(t,e){return A(e)}).attr("id",function(t,e){return i[e].replace(/ /g,"")+"path"}).attr("d",b).on("click",function(t,e){M.select("#"+i[e].replace(/ /g,"")+"text").transition().attr("x",34).style("font-weight","bold").style("fill","bold"),d3.select(this).attr("stroke","white").transition().duration(500).attr("d",k).attr("stroke-width",1)}).transition().duration(1500).attrTween("d",n);var C=p.selectAll("g.legendGrouping").data(i).enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate(10,"+(10+20*e)+")"});C.append("rect").attr("width",s).attr("height",18).style("fill",function(t,e){return A(e)}),C.append("text").attr("id",function(t,e){return i[e].replace(/ /g,"")+"text"}).attr("x",233).transition().duration(function(t,e){return 400*e}).attr("x",24).attr("y",9).attr("dy",".35em").text(function(t,e){return i[e]}),c(p)},dountChartWithLegend:function(t){function e(t){var e=r(t);b.value.splice(0,0,x.value[e]),b.key.splice(0,0,x.key[e]),b.color.splice(0,0,x.color[e]),x.value.splice(e,1),x.key.splice(e,1),x.color.splice(e,1),o()}function n(t){for(var e=0;e<b.key.length&&b.key[e]!=t;e++);return x.value.splice(0,0,b.value[e]),x.key.splice(0,0,b.key[e]),x.color.splice(0,0,b.color[e]),o(),b.color[e]}function r(t){for(var e=0;e<x.key.length&&x.key[e]!=t;e++);return e}function a(t){for(var e,n=0,r=0;r<x.value.length;r++)x.key[r]==t&&(e=x.value[r]),n+=x.value[r];return Math.round(e/n*100)}function i(t,e){var n=r(t),i=[{headingName:x.label,headingVal:a(t)+"%"}];G.showToolTip(e,"",x.key[n],!1,i)}function o(){d3.select("#group").remove(),S=C.append("g").attr("id","group").attr("transform","translate("+(k+w.left+w.right)/2+","+((A+w.top+w.bottom)/2-w.top)+")");var t=S.selectAll(".arc").data(_(x.value)).enter().append("g").attr("value",function(t,e){return x.key[e]}).attr("fill",function(t,e){return x.color[e]}).on("mouseover",function(){d3.select(this).transition().duration(500).ease("bounce").attr("transform",function(t){var e=10;t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var n=Math.sin(t.midAngle)*e,r=-Math.cos(t.midAngle)*e;return"translate("+n+","+r+")"})}).on("mousemove",function(){i(d3.select(this).attr("value"),d3.event)}).on("mouseleave",function(){d3.select(this).transition().duration(500).ease("bounce").attr("transform","translate(0,0)"),G.hideTooTip()});t.append("path").attr("d",L).transition().duration(1500).attrTween("d",l);try{c(N)}catch(e){}}function l(t){var e=d3.interpolate({startAngle:-180*y,endAngle:-180*y},t);return function(t){return L(e(t))}}var s,u,d,f,h=0,g=0,y=Math.PI/180,v=t.divId,x=t.data,b={key:[],value:[],color:[]},k=parseInt(d3.select("#"+v).style("width")),A=parseInt(d3.select("#"+v).style("height"));301>k||301>A?(d=10,f=6,textSpace=7):401>k||401>A?(d=12,f=9,textSpace=9):601>k||601>A?(d=14,f=10,textSpace=12):(d=15,f=11,textSpace=19);{var M,w={top:.1*A,right:.1*k,bottom:.2*A,left:.1*k},k=k-w.left-w.right,A=A-w.top-w.bottom;x.key.length,d3.select("body").append("div").style("background","rgba(0,0,0,.6)").style("position","absolute").style("visibility","hidden").style("font-family","calibri").style("font-style","normal").style("color","white").text("a simple tooltip")}k>A?(s=A/2,M=.05*A):(s=k/2,M=.05*k),u=s-.5*s;var C=(d3.select("#"+v),p),S=C.append("g").attr("id","group").attr("transform","translate("+(k+w.left+w.right)/2+","+((A+w.top+w.bottom)/2-w.top)+")"),T=2*s,L=d3.svg.arc().innerRadius(u).outerRadius(s),_=d3.layout.pie().sort(null).value(function(t){return t});o();var N=C.append("g").attr("transform","translate("+((k+w.left+w.right)/2-s)+","+((A+w.top+w.bottom)/2+s)+")");N.selectAll("rect").data(x.value).enter().append("rect").attr("class","legend").attr("value",function(t,e){return x.key[e]}).attr("fill",function(t,e){return x.color[e]}).attr("x",function(t,e){return e>3?parseInt(e/4)-1+.3*h++*T:.3*e*T}).attr("y",function(t,e){return e>3?2*M:void 0}).attr("width",M).attr("height",M).on("click",function(){"gray"==d3.select(this).attr("fill")?(d3.select(this).attr("fill",n(d3.select(this).attr("value"))),d3.select(this).style("text-decoration","none")):(d3.select(this).attr("fill","gray"),d3.select(this).style("text-decoration","line-through"),e(d3.select(this).attr("value")))});var D=N.selectAll("text").data(x.value).enter().append("text").attr("x",function(t,e){return e>3?parseInt(e/4)-1+.3*g++*T+M+3:.3*e*T+M+3}).attr("y",function(t,e){return e>3?3*M:M}).style("font-size",d).style("font-family","calibri").style("font-style","italic").text(function(t,e){return x.key[e]});c(N),D.style("fill",m.legendTextColor)},drawDountWithBarChart:function(t){function e(t){var e=r(t);A.value.splice(0,0,v.value[e]),A.key.splice(0,0,v.key[e]),A.color.splice(0,0,v.color[e]),v.value.splice(e,1),v.key.splice(e,1),v.color.splice(e,1),o()}function n(t){for(var e=0;e<A.key.length&&A.key[e]!=t;e++);return v.value.splice(0,0,A.value[e]),v.key.splice(0,0,A.key[e]),v.color.splice(0,0,A.color[e]),o(),A.color[e]}function r(t){for(var e=0;e<v.key.length&&v.key[e]!=t;e++);return e}function a(t){for(var e,n=0,r=0;r<v.value.length;r++)v.key[r]==t&&(e=v.value[r]),n+=v.value[r];return Math.round(e/n*100)}function i(t,e){var n=r(t);console.log("*****event pagey "+d3.event.pageY+" ****spae "+C.top),d3.event.pageY=d3.event.pageY;var i=[{headingName:v.label,headingVal:v.value[n]+" "+a(t)+"%"}];G.showToolTip(e,"",v.key[n],!1,i,.9*d3.event.pageY)}function o(){d3.select("#dountGroup").remove(),T=S.append("g").attr("id","dountGroup").attr("transform","translate("+.4*(M+C.left+C.right)/2+","+((w+C.top+C.bottom)/2-C.bottom)+")");var t=T.selectAll(".arc").data(z(v.value)).enter().append("g").attr("id",function(t,e){return v.key[e]}).attr("value",function(t,e){return v.key[e]}).attr("fill",function(t,e){return v.color[e]}).on("click",function(){s(d3.select(this).attr("value"))}).on("mouseover",function(){d3.select(this).transition().duration(500).ease("bounce").attr("transform",function(t){var e=10;t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var n=Math.sin(t.midAngle)*e,r=-Math.cos(t.midAngle)*e;return"translate("+n+","+r+")"})}).on("mousemove",function(){0==k&&(d3.select("#"+v.key[0]).transition().duration(500).ease("bounce").attr("transform","translate(0,0)"),k=1),i(d3.select(this).attr("value"),d3.event)}).on("mouseout",function(){d3.select(this).transition().duration(500).ease("bounce").attr("transform","translate(0,0)"),G.hideTooTip()});t.append("path").attr("d",P).transition().duration(1500).attrTween("d",l)}function l(t){var e=d3.interpolate({startAngle:-180*b,endAngle:-180*b},t);return function(t){return P(e(t))}}function s(t){d3.select("#barGroup").remove();var e=S.append("g").attr("id","barGroup").attr("transform","translate("+(.4*(M+C.left+C.right)+C.left)+","+((w+C.top+C.bottom)/2-C.bottom-u/1.5)+")");d3.select("#showCountryGroup").remove();var n=S.append("g").attr("id","showCountryGroup").attr("transform","translate("+(.4*(M+C.left+C.right)+C.left)+","+((w+C.top+C.bottom)/2-C.bottom-u)+")");n.append("text").transition().duration(1500).attr("fill",v.color[r(t)]).style("font-family","calibri").style("font-size",2*f).style("font-style","italic").text(t);var a=d3.scale.linear().domain([0,d3.max(x[t])]).range([0,.32*M]),i=e.selectAll("g").data(x[t]).enter().append("g").attr("transform",function(t,e){return"translate(0,"+e*rectSize*2.6+")"}),o=i.append("rect").attr("width",function(){return 0}).attr("height",1.3*rectSize);o.transition().duration(1500).attr("width",function(e,n){return a(x[t][n])}).attr("fill",function(t,e){return x.color[e]});for(var l=0,s=0;s<x[t].length;s++)l+=x[t][s];i.append("text").transition().duration(1500).attr("x",function(e,n){return a(x[t][n])-2*f}).attr("y",1.3*rectSize/2).attr("dy",".35em").style("font-size",f+2).style("fill",v.textAndLegendColor).style("font-family","calibri").style("font-style","italic").text(function(e,n){return Math.round(x[t][n]/l*100)+"%  "+x.key[n]})}var u,d,f,h,g,y=t.divId,v=t.data,x=t.subDataArray,b=Math.PI/180,k=0,A={key:[],value:[],color:[]},M=parseInt(d3.select("#"+y).style("width")),w=parseInt(d3.select("#"+y).style("height"));301>M||301>w?(f=7,h=6,g=7):401>M||401>w?(f=10,h=9,g=9):601>M||601>w?(f=12,h=10,g=12):(f=14,h=11,g=19);var C={top:.1*w,right:.1*M,bottom:.2*w,left:.1*M},M=M-C.left-C.right,w=w-C.top-C.bottom,S=(d3.select("body").append("div").style("background","rgba(0,0,0,.6)").style("position","absolute").style("visibility","hidden").style("font-family","calibri").style("font-style","normal").style("color","white").text("a simple tooltip"),d3.select("#"+y),p.append("g").attr("transform","translate(0,"+C.top+")")),T=S.append("g").attr("id","dountGroup").attr("transform","translate("+.4*(M+C.left+C.right)/2+","+(C.top+C.bottom)+")");.4*M>w?(u=w/2,rectSize=.06*w):(u=.4*M/2,rectSize=.4*M*.06),d=u-.5*u;var L=S.append("g").attr("id","lineGroup").attr("transform","translate("+(M+C.left+C.right)/2.4+",0)"),_=[0,(w+C.top+C.bottom)/2-C.bottom-u,0,(w+C.top+C.bottom)/2-C.bottom+u],N=0,D=d3.svg.line().x(function(){return _[N++]}).y(function(){return _[N++]}),F=L.append("path").data([_]).attr("stroke","lightgray").attr("stroke-width",1).attr("fill","none");F.attr("d",D);var I=2*u+2*V.right/2.5,P=d3.svg.arc().innerRadius(d).outerRadius(u),z=d3.layout.pie().sort(null).value(function(t){return t});o(),s(v.key[0]),d3.select("#"+v.key[0]).transition().duration(500).ease("bounce").attr("transform",function(t){var e=10;t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var n=Math.sin(t.midAngle)*e,r=-Math.cos(t.midAngle)*e;return"translate("+n+","+r+")"});var E=S.append("g").attr("transform","translate("+(.4*(M+C.left+C.right)/2-(u+C.right/2.5))+","+((w+V.top+V.bottom)/2-V.bottom+u+10)+")"),I=2*u+2*C.right/3,O=10,B=10,Y=20,q=0,j=.05*I,U=.05*I,H=R.getLegendPositionArray(v.key,I+.5*I,w);E.selectAll("rect").data(v.key).enter().append("rect").attr("class","legend").attr("value",function(t,e){return v.key[e]}).attr("fill",function(t,e){return v.color[e]}).attr("x",function(t,e){return H[e].x}).attr("y",function(t,e){return H[e].y}).attr("width",O).attr("height",B).on("click",function(){"gray"==d3.select(this).attr("fill")?(d3.select(this).attr("fill",n(d3.select(this).attr("value"))),d3.select(this).style("text-decoration","none")):(d3.select(this).attr("fill","gray"),d3.select(this).style("text-decoration","line-through"),e(d3.select(this).attr("value")))}),q=0,j=0*I+Y,U=0*I,E.selectAll("text").data(v.key).enter().append("text").attr("x",function(t,e){return H[e].textPos}).attr("y",function(t,e){return H[e].y+B}).style("font-size",f).style("fill",v.textAndLegendColor).style("font-style","italic").style("font-family","calibri").text(function(t){return t}),c(p),E.selectAll("text").style("fill",m.legendTextColor)},multipleDountChartAnalysis:function(t){function e(t){var e=d3.interpolate({startAngle:-180*h,endAngle:-180*h},t);return function(t){return T(e(t))}}var n,r,a,i,o={left:.05*g,right:.05*g,bottom:.05*v,top:.05*v,chartSeparator:10,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},l=g-o.left-o.right,s=v-o.top-o.bottom,d=t.data.length,f=1,h=Math.PI/180,y=.015*l,x=1.3*y;a=.8*l/Math.round(d/2)/2<s/2?.8*l/Math.round(d/2)/2:s/2,a=.4*a,i=.75*a;var b=9,k=l/2-t.title.length*b/2,A=p.append("g").attr("class","title");B.appendLabel(t.title,k,o.top,0,A,m.chartTitleColor,800);for(var M,w,C=d3.layout.pie().sort(null).value(function(t){return t}),S=0;d>S;S++){1==d?(n=p.append("g").attr("id","dount-main-group").attr("class","legend").attr("transform","translate("+.8*l/2+","+.5*s+")"),a=s>.8*l?.8*l:s,a=.4*a,i=.75*a):S<Math.round(d/2)?(M=.3*s,n=p.append("g").attr("id","dount-main-group"+S).attr("class","legend").attr("transform","translate("+(.8*l/Math.round(d/2)*(S+1)/2+1.5*S*a)+","+M+")")):(w=d>6?M+4*a:M+3*a,n=p.append("g").attr("id","dount-main-group"+S).attr("class","legend").attr("transform","translate("+(.8*l/Math.round(d/2)*f/2+1.5*(f++-1)*a)+","+w+")"));var T=d3.svg.arc().innerRadius(i).outerRadius(a);r=n.selectAll(".arc").data(C(t.data[S].dountData)).enter().append("g").attr("value",function(t,e){return S+" "+e}).attr("fill",function(e,n){return t.data[S].colorArray[n]}).on("mouseover",function(){{var t=d3.select(this).attr("value");t.split(" ")}d3.select(this).transition().duration(500).ease("bounce").attr("transform",function(t){var e=7;t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var n=Math.sin(t.midAngle)*e,r=-Math.cos(t.midAngle)*e;return"translate("+n+","+r+")"})}).on("mousemove",function(){var e=d3.select(this).attr("value"),n=e.split(" ");console.log(t.data[parseInt(n[0])].dountKey[parseInt(n[1])]);var r=[{headingName:t.data[parseInt(n[0])].dountKey[parseInt(n[1])],headingVal:t.data[parseInt(n[0])].dountData[parseInt(n[1])]+" "+t.unit}];G.showToolTip(d3.event,"",t.data[parseInt(n[0])].className,!1,r)}).on("mouseout",function(){d3.select(".ShowArc").attr("display","none"),d3.select(this).transition().duration(500).ease("linear").attr("transform","translate(0,0)")}).on("mouseleave",function(){G.hideTooTip()}),r.append("path").attr("d",T).transition().duration(1500).attrTween("d",e),n.append("text").attr("x",-(6*t.data[S].totalStudent.length)/2).attr("y",3).attr("font-family","calibri").text(t.data[S].totalStudent),n.append("text").attr("x",-(6*t.data[S].className.length/2)).attr("y",a+11).attr("font-family","calibri").text(t.data[S].className)}var L=p.append("g").attr("class","legend").attr("transform","translate("+.8*l+","+.3*s+")"),_=L.selectAll("rect").data(t.legend).enter().append("rect").attr("width",y).attr("height",y).attr("x",function(){return.78*-l
}).attr("y",function(){return s}).attr("fill",function(e,n){return t.legendColor[n]});_.transition().duration(1500).attr("x",0).attr("y",function(t,e){return 2*e*y});var N=L.selectAll("text").data(t.legend).enter().append("text").attr("x",function(){return.78*-l}).attr("y",function(t,e){return 2*e*y+y/2}).attr("dy",".31em").attr("font-family","calibri").attr("font-size",x).text(function(t){return t});N.transition().duration(1500).attr("x",y+8),L.append("line").attr("x1",-(.75*l*.1)).attr("y1",-y/2).attr("x2",-(.75*l*.1)).attr("y2",2*t.legend.length*y).attr("stroke","lightsteelblue"),u(p),c(p)}},ae={drawHeatMapChart:function(t,e,n){function r(t){B.select(" #img").style("display","block"),B.select("#img").transition().attr("x",g-.09*g).attr("y",q(t.hours))}function a(){B.select("#img").style("display","none")}var i={colorLow:"#F6fdff",colorMed:"#81DCFF",colorHigh:"#0BBCFF",yAxisLabelSpacing:50};if("undefined"!=typeof n)for(var o in n)"undefined"!=typeof n[o]&&(i[o]=n[o]);var l=[],s=e.yAxisValue,d=[],f=(.7*g/s.length,{top:.03*v,right:1/12*g,bottom:.05*v,left:8/60*g}),h=g-i.yAxisLabelSpacing,y=v-.03*v-f.top-f.bottom,m=e.data,x=0;for(var b in m){var k=m[b];d.push(b);for(var A=0;A<k.length;A++){var M={};M.row=x,M.col=A,M.hours=k[A],l.push(M)}x++}var C=d3.min(l,function(t){return t.hours}),L=d3.max(l,function(t){return t.hours}),_=d3.scale.linear().domain([C,(C+L)/2,L]).range([i.colorLow,i.colorMed,i.colorHigh]),N=.8*v/s.length;w=.7*g/x;for(var D=(d3.scale.linear().range([0,h]),d3.scale.linear().range([y,0]),d3.scale.ordinal().domain(d3.range(x)).rangeRoundBands([0,w*x],.05)),F=d3.scale.ordinal().domain(d3.range(s.length)).rangeRoundBands([0,N*s.length],.1),V=d3.svg.axis().scale(D).orient("bottom").ticks(5),I=d3.svg.axis().scale(F).tickFormat(function(t){return s[t]}).orient("left").ticks(5),P=p.append("svg").attr("width",h+f.right/2).attr("height",y+f.top+f.bottom).append("g").attr("transform","translate("+.15*h+","+f.top+")"),z=(P.selectAll("g").data(l,function(t){return t.col+":"+t.row}).enter().append("svg:rect").attr("x",function(t){return t.row*w}).attr("y",function(t){return t.col*N}).attr("width",function(){return w}).attr("height",function(){return N}).style("fill",function(t){return _(t.hours)}).on("mouseover",function(t){d3.select(this).style("fill","cyan");var e=d3.event.pageX;r(t,e)}).on("mouseout",function(){d3.select(this).style("fill",function(t){return _(t.hours)}),a()}),P.selectAll("g").data(l,function(t){return t.col+":"+t.row}).enter().append("svg:text").attr("x",function(t){return t.row*w}).attr("y",function(t){return t.col*N}).attr("text-anchor","middle").attr("font-family","sans-serif").attr("font-size",function(){return w*N/(2.5*(w+N))}).attr("dy",function(t){return t.row+N/2}).attr("dx",function(t){return t.col+w/2}).text(function(t){return t.hours}).on("mouseover",function(t){var e=d3.event.pageX;r(t,e)}).on("mouseout",function(){a()}),[]),E=0;E<d.length;E++)z.push(E);V.tickValues(z),P.append("g").attr("class","x axis").attr("transform","translate(0,"+N*s.length+")").call(V).selectAll("text").text(function(t){return d[t]}).style("text-anchor","end").attr("dx","-1.0em").attr("dy","0.15em").attr("transform",function(){return"rotate(-45)"}),P.append("g").attr("class","y axis").call(I).selectAll("text").style("text-anchor","end").attr("dx","-0.0em").attr("dy","0.0em").attr("transform",function(){return"rotate(0)"});var O={top:20,right:20,bottom:30,left:8},R=(g-O.left-O.right,v-O.top-O.bottom),B=p.append("svg").attr("width",g-O.left+O.right).attr("height",R+O.top+O.bottom).append("g"),Y=B.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("x1","0%").attr("y1",F(0)).attr("x2","0%").attr("y2",F(s.length-1)).attr("gradientUnits","userSpaceOnUse");Y.append("svg:stop").attr("offset","0%").attr("stop-color",_(C)).attr("stop-opacity",1),Y.append("svg:stop").attr("offset","20%").attr("stop-color",_(10)).attr("stop-opacity",1),Y.append("svg:stop").attr("offset","40%").attr("stop-color",_(20)).attr("stop-opacity",1),Y.append("svg:stop").attr("offset","60%").attr("stop-color",_(30)).attr("stop-opacity",1),Y.append("svg:stop").attr("offset","80%").attr("stop-color",_(40)).attr("stop-opacity",1),Y.append("svg:stop").attr("offset","100%").attr("stop-color",_(L)).attr("stop-opacity",1),B.append("svg:rect").attr("x",g-.05*g).attr("y",f.top).attr("width",3*s.length).attr("height",N*s.length).style("fill","url(#gradient)");var q=(d3.max(l,function(t){return t.hours}),d3.scale.linear().range([N*s.length,0]));S=d3.min(l,function(t){return t.hours}),T=d3.max(l,function(t){return t.hours}),q.domain([T,S]);var G=d3.svg.axis().scale(q).orient("right").ticks(4).tickSize(5,0);B.append("g").attr("class","y axis").call(G).selectAll("text").style("text-anchor","right").attr("x",g-.09*g).attr("y",O.top).attr("dx","0.0em").attr("dy","0.0em").attr("transform",function(){return"rotate(0)"}),B.selectAll("line").style("display","none"),B.append("g").append("svg:image").attr("id","img").attr("xlink:href","http://stocinn.github.io/stocweb/img/pointer.png").attr("width",g/30).attr("height",g/30).style("display","none"),u(p),c(p)}},ie={drawScatterPlotChart:function(t,e){function n(t,e,n,l){"circle"==e.shape?r(t,o(e),n,l,e):"square"==e.shape?a(t,o(e),n,l,e):i(t,o(e),n,l,e)}function r(t,e,n,r,a){t.selectAll("."+r+" dot").data(e.coordinates).enter().append("circle").attr("class",r+" dot").on("mouseover",function(t,e){var n=[{headingName:a.name+" "+h,headingVal:t.y}];G.showToolTip(d3.event,t.yVal,y+" "+f[e],!1,n)}).on("mouseout",function(){G.hideTooTip()}).attr("cx",function(){return 0}).attr("cy",function(){return 0}).transition().duration(1e3).attr("cx",function(t,e){return T(e)-2.5}).attr("cy",function(t){return L(t.y)}).attr("r",function(){return 5}).style("fill",function(t){return t.color})}function a(t,e,n,r,a){t.selectAll("."+r+" dot").data(e.coordinates).enter().append("rect").attr("class",r+" dot").on("mouseover",function(t,e){var n=[{headingName:a.name+" "+h,headingVal:t.y}];G.showToolTip(d3.event,t.yVal,y+" "+f[e],!1,n)}).on("mouseout",function(){G.hideTooTip()}).attr("x",0).attr("width",function(){return 0}).attr("height",function(){return 0}).attr("y",0).transition().duration(2e3).attr("x",function(t,e){return T(e)}).attr("y",function(t){return L(t.y)}).attr("width",10).attr("height",10).attr("fill",function(t){return t.color})}function i(t,e,n,r,a){t.selectAll(r+" dot").data(e.coordinates).enter().append("path").on("mouseover",function(t){var e=[{headingName:a.name+" "+h,headingVal:t.y}];G.showToolTip(d3.event,t.yVal,y+" "+f[W],!1,e)}).on("mouseout",function(){G.hideTooTip()}).attr("class",r+" dot").attr("x",0).attr("width",function(){return 0}).attr("height",function(){return 0}).attr("y",0).transition().duration(2e3).attr("d",d3.svg.symbol().type("triangle-up")).attr("transform",function(t,e){return"translate("+T(e)+","+L(t.y)+")"}).attr("fill",function(t){return t.color})}function o(t){var e={},n=[];for(e.coordinates=n,j=0;j<t.data.length;j++){var r={color:t.color,name:t.name,x:j,y:t.data[j]};e.coordinates.push(r)}return e}var l={padding:e.padding,toolTipLabel:"Population"};g=.9*g,v=.9*v;var s,d,f=e.xAxisTickArray,h=e.yIndicationLabel,y=e.xIndicationLabel,x=e.chartTitle,b=0,A=0,M=e.yAixsData;for(W=0;W<M.length;W++)s=d3.max(M[W].data,function(t){return t}),d=d3.max(M[W].data,function(t){return t}),s>b&&(b=s),d>A&&(A=d),M[W].legendName="legend-"+W;{var w=10,C=0;d3.scale.category20()}b=f.length;var S;S=40>.08*g?40:.08*g;var T=d3.scale.linear().domain([0,b]).range([S,g-.05*g]),L=d3.scale.linear().domain([0,1.5*A]).range([v-2*l.padding,l.padding]),_=(d3.scale.linear().domain([10,A]).range([5,10]),d3.format(".1%"),d3.svg.axis().scale(T).orient("bottom").ticks(5)),N=d3.svg.axis().scale(L).orient("left").ticks(5),D=p.append("g").attr("transform","translate("+S+","+C+")");for(U.init(D,v,g,.8*S,C+5),iVal=0;iVal<M.length;iVal++)n(D,M[iVal],M[iVal].color,M[iVal].legendName);for(var F=f[0].toString().length,V=0;V<f.length;V++){var I=f[V].toString().length;I>F&&(F=I)}var P=Y.getXTickArray(0,f.length,F,g-2*l.padding-l.padding);_.tickValues(P);var z=D.append("g").attr("class","axis").attr("transform","translate(0,"+(v-l.padding)+")").call(_);z.selectAll("text").text(function(t){return f[t]});for(var E=D.append("g").attr("class","axis").attr("transform","translate("+w+",0)").call(N),O=D.append("g").attr("class","legend").attr("width",g).attr("height",v).attr("transform","translate("+g/10+",50)"),q=10,H=10,X=[],W=0;W<M.length;W++)X.push(M[W].name);var $=R.getLegendPositionArray(X,.98*g,v);for(k=0;k<M.length;k++)"square"==M[k].shape?(O.selectAll("rect").data([M[k]]).enter().append("rect").attr("x",function(){return $[k].x}).attr("y",function(){return $[k].y}).attr("width",H).attr("height",q).style("fill",function(t){return t.color}).on("click",function(t){var e=d3.selectAll("."+t.legendName+".dot").style("display");if("none"==e)d3.selectAll("."+t.legendName+".dot").style("display","block"),d3.select(".rectLegend."+t.name).style("text-decoration","none");else{{p.selectAll("."+t.legendName+"line")}d3.selectAll("."+t.legendName+".dot").style("display","none"),d3.select(".rectLegend."+t.name).style("text-decoration","line-through")}}),O.selectAll(".rectLegend").data([M[k]]).enter().append("text").attr("class",function(t){return"rectLegend "+t.name}).attr("x",function(){return $[k].textPos}).attr("y",$[k].y+q/2).attr("width",M.length/300*g).attr("height",M.length/300*g).attr("font-size",.02*(g+v)/2).attr("dy",".50em").text(function(t){return t.name})):"circle"==M[k].shape?(O.selectAll("circle").data([M[k]]).enter().append("circle").attr("cx",$[k].x).attr("cy",$[k].y+q/2).attr("r",function(){return H/2}).style("fill",function(t){return t.color}).on("click",function(t){var e=d3.selectAll("."+t.legendName+".dot").style("display");if("none"==e)d3.selectAll("."+t.legendName+".dot").style("display","block"),d3.select(".circleLegend."+t.name).style("text-decoration","none");else{{p.selectAll("."+t.legendName+"line")}d3.selectAll("."+t.legendName+".dot").style("display","none"),d3.select(".circleLegend."+t.name).style("text-decoration","line-through")}}),O.selectAll("text1").data([M[k]]).enter().append("text").attr("class",function(t){return"circleLegend "+t.name}).attr("x",function(){return $[k].textPos}).attr("y",$[k].y+q/2).attr("font-size",.02*(g+v)/2).attr("dy","0.50em").text(function(t){return t.name})):"triangle"==M[k].shape&&(O.selectAll("triangle").data([M[k]]).enter().append("path").attr("x",function(){return $[k].x}).attr("y",$[k].y).attr("d",d3.svg.symbol().type("triangle-up")).attr("transform",function(){return"translate("+$[k].x+","+($[k].y+q/2)+")"}).style("fill",function(t){return t.color}).on("click",function(t){var e=d3.selectAll("."+t.legendName+".dot").style("display");if("none"==e)d3.selectAll("."+t.legendName+".dot").style("display","block"),d3.select(".triangleLegend."+t.name).style("text-decoration","none");else{{p.selectAll("."+t.legendName+".line")}d3.selectAll("."+t.legendName+".dot").style("display","none"),d3.select(".triangleLegend."+t.name).style("text-decoration","line-through")}}),O.selectAll("text2").data([M[k]]).enter().append("text").attr("class",function(t){return"triangleLegend "+t.name}).attr("x",function(){return $[k].textPos}).attr("y",$[k].y+q/2).attr("font-size",.02*(g+v)/2).attr("dy",".50em").text(function(t){return t.name}));var J=7,Z=h.toString().length*J,K=v/2+Z/2;B.appendLabel(h,.8*-S,K,-90,E,m.yLabelColor,600);var Q=y.toString().length*J,te=g/2-Q/2;B.appendLabel(y,te,.15*v,0,z,m.xLabelColor,600);var J=9,ee=g/2-x.length*J/2,ne=p.append("g").attr("class","title");B.appendLabel(x,ee,.06*v,0,ne,m.chartTitleColor,800),u(p),c(p)}},oe={drawThreeDBarChart:function(t,e,n){function r(t,e,n,r,a,i){r=N(r),e=N(e);var o=[];for(l=0;3>l;l++)0==l?(x=t-.07*L,y=e-i+.03*L):1==l?(x=t-20,y=e-i):2==l&&(x=L,y=e-i),o.push(JSON.parse('{"x":'+x+',"y":'+y+"}"));return o}function a(t,e,n,r,a,i){r=N(0)-N(r);var o=[];if(1==a)for(var l=parseInt(.33*n)+1,s=0;5>s;s++){0==s?e=N(0):1==s?e-=r:2==s?t+=n:3==s?e+=r:4==s&&(t-=n);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}else if(2==a){var l=15;e=N(e);for(var s=0;4>s;s++){0==s?e=N(0):1==s?(t-=l,e-=l):2==s?e-=r:3==s&&(t+=l,e+=l);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}}else if(3==a){l=15;for(var s=0;4>s;s++){0==s?e=N(0)-r:1==s?(t-=l,e-=l):2==s?t+=n:3==s&&(t+=l,e+=l);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}}return o}var i={topMargin:5,rightMargin:30,bottomMargin:0,leftMargin:10,color:d3.scale.category20(),toolTipLabelForYAxis:"Profit(in Crores)"};if("undefined"!=typeof n)for(var o in n)"undefined"!=typeof n[o]&&(i[o]=n[o]);var s=g/(2*e.length),d=40;v=.8*v;var f=n.xAxisTickArray,h=.3*g/e.length;d=h;var b=g/(2*e.length);s=b;var A=s+d,M=d3.max(e,function(t){return t}),w=0,C=30,S=1;for(k=0;k<(""+M).length-1;k++)S+="0";var T=d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("linear"),L=e.length*A+50,_=d3.scale.linear().domain([0,e.length]).range([C,.95*L]),N=d3.scale.linear().domain([0,1.2*M]).range([v-.08*v,0]),D=d3.svg.axis().scale(_).orient("bottom").tickFormat(V),F=d3.svg.axis().scale(N).orient("left"),V=d3.format("1");F.tickValues(d3.range(0,1.15*M,1.15*M/10));var I=(M+100*(""+M).length,N(1.15*M));p=p.append("g").attr("transform","translate("+.1*L+","+.08*v+")"),L+=.05*L;var P=g-.89*g,z=v-.9*v,E=p;for(q=0;10>q;q++){var O=E.append("path").attr("d",T(r(P,z,s,M,e,I))).attr("stroke","#353b37").attr("stroke-width",.3).attr("fill","none"),R=O.node().getTotalLength();O.attr("stroke-dasharray",R+" "+R).attr("stroke-dashoffset",R).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",1).attr("stroke","#353b37").attr("stroke-width",.3).attr("fill","none"),I+=N(0)-N(1.15*M/10)}for(var P=g-.89*g,z=v-.9*v,q=0;q<e.length;q++){var O=E.append("path").attr("d",T(a(P+w,z,s,e[q],1,e[q]))).attr("val",function(){var t=a(P+w,z,s,e[q],1,e[q]);return t[0].height}).attr("xVal",f[q]).attr("fill","#9cffe9").on("mouseover",function(){var t=[{headingName:i.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];G.showToolTip(d3.event,"",n.xLabel+" "+d3.select(this).attr("xVal"),!1,t)}).on("mouseout",function(){d3.select(this);G.hideTooTip()}),R=O.node().getTotalLength();O.attr("stroke-dasharray",R+" "+R).attr("stroke-dashoffset",R).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",1).attr("stroke","white").attr("stroke-width",1).attr("fill",i.color);var O=E.append("path").attr("d",T(a(P+w,z,s,e[q],2,e[q]))).attr("val",function(){var t=a(P+w,z,s,e[q],2,e[q]);return t[0].height}).attr("xVal",f[q]).attr("fill","#9cffe9").on("mouseover",function(){var t=[{headingName:i.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];G.showToolTip(d3.event,"",n.xLabel+" "+d3.select(this).attr("xVal"),!1,t)}).on("mouseout",function(){d3.select(this);G.hideTooTip()}),R=O.node().getTotalLength();O.attr("stroke-dasharray",R+" "+R).attr("stroke-dashoffset",R).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",1).attr("stroke","white").attr("stroke-width",1).attr("fill",i.color);var O=E.append("path").attr("d",T(a(P+w,z,s,e[q],3,e[q]))).attr("val",function(){var t=a(P+w,z,s,e[q],3,e[q]);return t[0].height}).attr("xVal",f[q]).attr("fill","#9cffe9").on("mouseover",function(){var t=[{headingName:i.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];G.showToolTip(d3.event,"",n.xLabel+" "+d3.select(this).attr("xVal"),!1,t)}).on("mouseout",function(){d3.select(this);G.hideTooTip()}),R=O.node().getTotalLength();O.attr("stroke-dasharray",R+" "+R).attr("stroke-dashoffset",R).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",1).attr("stroke","white").attr("stroke-width",1).attr("fill",i.color),w+=A}for(var j=0,U=0;U<f.length;U++)j<f[U].toString().length&&(j=f[U].toString().length);D.tickValues(Y.getXTickArray(0,f.length,j,L-C));var H=E.append("g").attr("class","axis").attr("transform","translate("+P+","+(v-20)+")").call(D);H.selectAll("text").text(function(t){return f[t]});var X=E.append("g").attr("class","axis").attr("transform","translate("+.05*L+",-5)").call(F);X.selectAll("line").style("display","none"),X.selectAll("path").style("display","none");var W,$=6,J=i.yLabel.toString().length*$,Z=v/2+J/2;W=350>g?1.2*-C:1.5*-C,B.appendLabel(i.yLabel,W,Z,-90,X,m.yLabelColor,600);var K=i.xLabel.toString().length*$,Q=L/2-K/1.5,te=.15*v;B.appendLabel(i.xLabel,Q,te,0,H,m.xLabelColor,600);var $=9,ee=L/2-i.title.length*$/2,ne=p.append("g").attr("class","title");B.appendLabel(i.title,ee,.05*v,0,ne,m.chartTitleColor,800),c(p),u(p)}},le={drawBasicLineChart:function(t,e){function n(t,e,n){"circle"==e.Shape?r(t,e,n,e.legendName):"square"==e.Shape?a(t,e,n,e.legendName):i(t,e,n,e.legendName)}function r(t,e,n,r){var a=[e.data],i=t.selectAll("svg").data(a).enter().append("g").attr("transform","translate("+d.left+","+d.top+")"),o=i.append("path").attr("class",r+"line "+e.legendName).attr("d",L).attr("fill","none").style("stroke",n),l=o.node().getTotalLength();o.attr("stroke-dasharray",l+", "+l).attr("stroke-dashoffset",l),o.transition().duration(2e3).attr("stroke-dashoffset",0),i.selectAll("."+r+"dot").data(function(t){return t}).enter().append("circle").attr("xVal",function(t,e){return s[e]}).attr("yVal",function(t){return t}).on("mouseover",function(t,n){d3.select(this).attr("stroke","white").attr("stroke-width","2px");var r=[{headingName:e.Name,headingVal:t}];G.showToolTip(d3.event,t.yVal,s[n],!1,r)}).on("mouseout",function(){d3.select(this).attr("stroke","white").attr("stroke-width","0px");d3.select(this);G.hideTooTip()}).attr("class",r+"dot circle").attr("x",0).attr("cx",function(){return 0}).attr("cy",function(){return 0}).attr("y",0).transition().duration(2e3).attr("cx",L.x()).attr("cy",L.y()).attr("r",3).attr("fill",n)}function a(t,e,n,r){var a=[e.data],i=t.selectAll("svg").data(a).enter().append("g").attr("transform","translate("+d.left+","+d.top+")"),o=i.append("path").attr("class",function(){return r+"line "+e.legendName}).attr("d",L).attr("fill","none").style("stroke",n),l=o.node().getTotalLength();o.attr("stroke-dasharray",l+", "+l).attr("stroke-dashoffset",l),o.transition().duration(2e3).attr("stroke-dashoffset",0),i.selectAll("."+r+"dot").data(function(t){return t}).enter().append("rect").attr("xVal",function(t,e){return s[e]}).attr("yVal",function(t){return t}).on("mouseover",function(t,n){d3.select(this).attr("stroke","white").attr("stroke-width","2px");var r=[{headingName:e.Name,headingVal:t}];G.showToolTip(d3.event,t.yVal,s[n],!1,r)}).on("mouseout",function(){d3.select(this).attr("stroke","white").attr("stroke-width","0px"),G.hideTooTip()}).attr("class",r+"dot square").attr("x",0).attr("width",function(){return 0}).attr("height",function(){return 0}).attr("y",0).transition().duration(2e3).attr("x",_.x()).attr("y",_.y()).attr("width",6).attr("height",6).attr("fill",n)}function i(t,e,n,r){var a=[e.data],i=t.selectAll("svg").data(a).enter().append("g").attr("transform","translate("+d.left+","+d.top+")"),o=i.append("path").attr("class",r+"line "+e.legendName).attr("d",L).attr("fill","none").style("stroke",n),l=o.node().getTotalLength();o.attr("stroke-dasharray",l+", "+l).attr("stroke-dashoffset",l),o.transition().duration(2e3).attr("stroke-dashoffset",0),i.selectAll(r+"dot").data(function(t){return t}).enter().append("path").attr("xVal",function(t,e){return s[e]}).attr("yVal",function(t){return t}).on("mouseover",function(t,n){d3.select(this).attr("stroke","white").attr("stroke-width","2px");var r=[{headingName:e.Name,headingVal:t}];G.showToolTip(d3.event,t.yVal,s[n],!1,r)}).on("mouseout",function(){d3.select(this).attr("stroke","white").attr("stroke-width","0px");d3.select(this);G.hideTooTip()}).attr("class",r+"dot triangle").attr("x",0).attr("width",function(){return 0}).attr("height",function(){return 0}).attr("y",0).transition().duration(2e3).attr("d",d3.svg.symbol().type("triangle-up")).attr("transform",function(t,e){return"translate("+k(e)+","+M(t)+")"}).attr("fill",n)}var o={padding:e.padding,yAxisfactor:e.yAxisfactor,yLabelColor:e.yLabelColor,xAxisfactor:e.xAxisfactor,xLabelColor:e.xLabelColor},l=e.title,s=e.xAxisTickArray,d={top:30,right:30,bottom:40,left:100};g=g-d.left-d.right,v=v-d.top-d.bottom;var f,h=0,y=e.yAxisData;for(I=0;I<y.length;I++)f=d3.max(y[I].data,function(t,e){return t.xVal=s[e],t.timeIndex=e,t.shape=y[I].shape,t}),f>h&&(h=f),y[I].legendName="legend-"+I;var x=s.length,k=d3.scale.linear().domain([0,x]).range([.02*g,g]),M=d3.scale.linear().domain([0,1.5*h]).range([v,0]);A=d3.svg.axis().scale(k).orient("bottom"),b=d3.svg.axis().scale(M).ticks(10).orient("left");var w=(o.yAxisfactor,p.append("g").attr("transform","translate("+.06*g+",0)")),C=10,S=g/2-l.length*C/2,T=p.append("g").attr("class","title");B.appendLabel(l,S+d.left,d.top,0,T,m.chartTitleColor,800),U.init(w,v,g,d.left,d.top);{var L=d3.svg.line().x(function(t,e){return k(e)}).y(function(t){return M(t)}).interpolate("cardinal"),_=d3.svg.line().x(function(t,e){return k(e)-3}).y(function(t){return M(t)-3}).interpolate("cardinal");d3.svg.line().x(function(t,e){return k(e)-3}).y(function(t){return M(t)-3}).interpolate("cardinal"),d3.svg.area().x(L.x()).y1(L.y()).y0(M(0))}for(iVal=0;iVal<y.length;iVal++)n(w,y[iVal],y[iVal].color,y[iVal].Name);for(var N=w.append("g").attr("class","legend").attr("width",g).attr("height",v).attr("transform","translate("+g/y.length+",50)"),D=10,F=10,V=[],I=0;I<y.length;I++)V.push(y[I].Name);var P=R.getLegendPositionArray(V,.98*g,v);N.selectAll("rect").data(y).enter().append("rect").attr("x",function(t,e){return P[e].x}).attr("y",function(t,e){return P[e].y}).attr("width",F).attr("height",D).style("fill",function(t){return t.color}).on("click",function(t){var e=d3.selectAll("."+t.legendName+"dot").style("display");if("none"==e){var n=p.selectAll("."+t.legendName+"line");n.transition().duration(1e3).ease("linear").attr("stroke-dashoffset",0),d3.selectAll("."+t.legendName+"dot."+t.Shape).style("display","block"),console.log(t.legendName+"dot"+t.Shape),d3.select("#"+t.legendName+"text").style("text-decoration","none")}else{var n=p.selectAll("."+t.legendName+"line"),r=n.node().getTotalLength();n.transition().duration(1e3).ease("linear").attr("stroke-dashoffset",r),d3.selectAll("."+t.legendName+"dot."+t.Shape).style("display","none"),console.log(t.legendName+"dot"+t.Shape),d3.select("#"+t.legendName+"text").style("text-decoration","line-through")}}),N.selectAll("text").data(y).enter().append("text").attr("id",function(t){return t.legendName+"text"}).attr("x",function(t,e){return P[e].textPos}).attr("y",function(t,e){return P[e].y+D/2}).attr("width",.03*g).attr("height",.03*v).attr("font-size",.024*(g+v)/2).attr("dy",".50em").text(function(t){return t.Name});for(var z=s[0].toString().length,E=0;E<s.length;E++){var O=s[E].toString().length;O>z&&(z=O)}var q=Y.getXTickArray(0,s.length,z,g-.02*g);A.tickValues(q);var j=w.append("g").attr("class","x axis").attr("transform","translate("+d.left+","+(v+d.top)+")").call(A);j.selectAll("text").text(function(t){var e="";return e=s[t]});var H=w.append("g").attr("class","y axis").attr("transform","translate("+d.left+","+d.top+")").call(b),X=v/2+o.yAxisfactor.length/2*5,W=.2*d.left-d.left;B.appendLabel(o.yAxisfactor,W,X,-90,H,m.yLabelColor,600);var $=d.top+5,J=g/2-o.xAxisfactor.length/2*5;B.appendLabel(o.xAxisfactor,J,$,0,j,m.xLabelColor,600),u(p),c(p)}},se={drawStackedAreaChart:function(t,e,n){var r={topMargin:5,rightMargin:30,bottomMargin:0,leftMargin:10,color:d3.scale.category20(),yAxisTootltipLabel:"Cost(in Crores): "};if("undefined"!=typeof n)for(var a in n)"undefined"!=typeof n[a]&&(r[a]=n[a]);var i=e,o={top:20,right:30,bottom:30,left:40};g=g-o.left-o.right,v=v-o.top-o.bottom;var l=d3.scale.ordinal().rangePoints([0,g]),s=d3.scale.linear().range([v,0]),d=d3.scale.category20(),f=d3.svg.axis().scale(l).orient("bottom"),h=d3.svg.axis().scale(s).orient("left"),y=d3.layout.stack().offset("zero").values(function(t){return t.values}).x(function(t){return t}).y(function(t){return t.y}),m=d3.nest().key(function(t){return t.name}),x=d3.svg.area().x(function(t){return l(t.category)}).y0(function(t){return s(t.y0)}).y1(function(t){return s(t.y0+t.y)}),b=p.append("svg").attr("width",g+o.left+o.right).attr("height",v+o.top+o.bottom).append("g").attr("transform","translate("+o.left+","+o.top+")");i.forEach(function(t){t.value=+t.value});var k=y(m.entries(i));l.domain(["Dec","Jan","Feb"]),s.domain([0,d3.max(i,function(t){return t.y0+t.y})]);var A=b.selectAll(".layer").data(k).enter().append("g");A.append("path").attr("class","area").attr("d",function(t){return x(t.values)}).style("fill",function(){return"white"}).on("mouseover",function(t){var e=[{headingName:r.yAxisTootltipLabel+" "+t.values[0].name,headingVal:t.values[0].y}];G.showToolTip(d3.event,"",r.xLabel,!1,e)}).on("mouseout",function(){G.hideTooTip()}).transition().delay(function(t,e){return 500*e}).ease("back").style("fill",function(t,e){return d(e)}),A.append("g").attr("class","x axis").attr("transform","translate(0,"+v+")").transition().duration(2e3).call(f),A.append("g").attr("class","y axis").transition().duration(2e3).call(h),u(p),c(p)}},ue={drawFunnelChart:function(t){function e(t){return t*(Math.PI/180)}for(var n,r,a,i,o=t.funnelData,l=t.funnelKey,s=t.colorArray,u=t.unit,c=t.label,d={left:.1*g,right:.1*g,bottom:.15*v,top:.1*v,chartSeparator:10,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},f=g-d.left-d.right,h=v-d.top-d.bottom,y=p.append("g").attr("class","main-group").attr("transform","translate("+d.left+","+d.top+")"),m=d3.svg.line().x(function(t,e){return S[e]}).y(function(t,e){return T[e]}).interpolate("basis-closed"),x=d3.svg.line().x(function(t,e){return S[e]}).y(function(t,e){return T[e]}),b=d3.svg.line().x(function(t,e){return A[e]}).y(function(t,e){return M[e]}),k=d3.svg.line().x(function(t,e){return L[e]}).y(function(t,e){return _[e]}).interpolate("basis-closed"),A=[f/2,f/2,f/2,f/2],M=[h+40,h+40,h+40,h+40],w=0,C=0,S=[],T=[],L=[],_=[],N=.6*f,D=f/2-N/2,F=0,V=0;V<o.length;V++)w+=o[V];for(var I=h+o.length*d.chartSeparator,P=I/(N/2),z=Math.atan(P)*(180/Math.PI),E=Math.tan(e(z)),O={},R={},B=0;B<o.length;B++){S=[],T=[],L=[],_=[],C=o[B]/w;var Y;Y=Math.abs(B!=o.length-1?I*C/E:I*C/2/E),i=2*(f/2-D)+D,S.push(D),S.push(D+Y),S.push(i-(S[1]-D)),S.push(i),T.push(F),B!=o.length-1?(T.push(F+h*C),T.push(F+h*C)):(T.push(F+h*C/2),T.push(F+h*C/2)),T.push(F),y.append("linearGradient").attr("id","gradient").attr("gradientUnits","userSpaceOnUse").attr("x1",S[0]).attr("y1",T[0]).attr("x2",S[3]).attr("y2",T[2]).selectAll("stop").data([{offset:"15%",color:s[B]},{offset:"62%",color:"#eaeaea"},{offset:"85%",color:s[B]}]).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color});var q=y.selectAll(".path").data([A]).enter().append("path").attr("d",b).attr("value",B).attr("stroke-width",1).attr("fill","url(#gradient)").on("mouseover",function(){for(var t=d3.select(this).attr("value"),e=0,n=0;n<o.length;n++)e+=o[n];var r=Math.round(o[t]/e*100),a=[{headingName:c,headingVal:r+" "+u}];G.showToolTip(d3.event,"",l[t],!1,a,.9*d3.event.pageY)}).on("mouseleave",function(){G.hideTooTip()});q.transition().duration(1e3).ease("linear").attr("d",x(S)),y.append("line").attr("class","horizontalLine").attr("x1",function(){return(S[3]+S[2])/2+5}).attr("y1",function(){return B!=o.length-1?(T[3]+T[2])/2:T[2]}).attr("x2",function(){return f/2+N/2}).attr("y2",function(){return B!=o.length-1?(T[3]+T[2])/2:T[2]}).style("stroke","#a7a7a7"),y.append("text").attr("class","text").attr("x",function(){return f/2+N/2+5}).attr("y",function(){return B!=o.length-1?(T[3]+T[2])/2+3:T[2]+3}).text(l[B]).attr("fill","#a7a7a7").style("font-family","calibri"),D=S[1]+2,F=T[1]+d.chartSeparator,L[0]=S[1],L[2]=S[2],L[1]=(S[1]+S[2])/2,L[3]=L[1];var j=(L[1]-L[0])/2;L[0]=L[0]-j,L[2]=L[2]+j,_[0]=T[1],_[1]=_[0]-10,_[2]=T[1],_[3]=_[0]+10,O[B]=L,R[B]=_,n=S[1],r=T[1],a=S[2]-S[1],S[2]=S[3],S[1]=(S[0]+S[2])/2,S[3]=S[1];var U=(S[1]-S[0])/2;S[0]=S[0]-U,S[2]=S[2]+U,T[1]=T[0]-10,T[2]=T[0],T[3]=T[0]+10;{y.selectAll(".path").data([S]).enter().append("path").attr("d",m).attr("stroke-width",1).attr("fill",function(){return s[B]})}}for(var B=0;B<o.length;B++)if(L=O[B],_=R[B],y.append("linearGradient").attr("id","gradient1").attr("gradientUnits","userSpaceOnUse").attr("x1",L[0]).attr("y1",_[1]).attr("x2",L[2]).attr("y2",_[3]).selectAll("stop").data([{offset:"15%",color:s[B]},{offset:"62%",color:"#eaeaea"},{offset:"85%",color:s[B]}]).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color}),B!=o.length-1){y.selectAll(".path").data([L]).enter().append("path").attr("d",k).attr("stroke-width",0).attr("fill","url(#gradient1)")}y.append("rect").attr("x",n).attr("y",r).attr("width",a).attr("height",I*C/2).attr("fill",s[B-1])}},ce={gaugeGraph:function(e){function n(t){return 18*t.length/2}{var r,e=t.extend({color:"url(#gradient123)",axisColor:"blue",dataA:[]},e);t(f).attr("id")}r=0==e.dataA.length?L:e.dataA;var a=r[0].maxSpeedVal,i=r[0].speedVal,o=a-i,l=[{label:i,value:i},{label:o,value:o}],s=Math.PI,u=.25*g,c=u/2,d=(d3.scale.category20c(),g/2),h=p.append("svg:g").attr("class","pie").attr("transform","translate("+d+","+.3*g+")"),y=d3.svg.arc().outerRadius(u).innerRadius(c),v=d3.layout.pie().sort(null).value(function(t){return t.value}).startAngle(-90*(s/180)).endAngle(90*(s/180)),m=h.selectAll("g.slice").data(v(l)).enter().append("svg:g").attr("class","slice");m.append("svg:path").attr("fill",function(t,e){return 0==e?"yellow":"#00ffe9"}).attr("d",y).on("mouseover",function(t){console.log(JSON.stringify(t))}).on("mouseleave",function(){}),m.append("svg:text").attr("transform",function(t){return"translate("+y.centroid(t)+")"}).attr("text-anchor","middle").attr("fill",function(){return e.textColor}).text(function(t,e){return l[e].label}),h.append("svg:text").attr("x",function(){e.arcStartIndLabel.length;var t=n(e.arcStartIndLabel);return-.35*(g/2+t)}).attr("y",20).attr("text-anchor","start").attr("fill",function(){return"#a7a7a7"}).text(e.arcStartIndLabel),h.append("svg:text").attr("x",0).attr("y",20).attr("text-anchor","middle").attr("fill",function(){return"#a7a7a7"}).text(e.arcMiddleIndLabel),h.append("svg:text").attr("x",function(){var t=n(e.arcEndIndLabel);return.35*(2*u+t)}).attr("y",20).attr("text-anchor","end").attr("fill",function(){return"#a7a7a7"}).text(e.arcEndIndLabel)}},de=!1,fe={areaChart:function(e){var e=t.extend({color:"url(#gradient123)",axisColor:"blue",data:[],attachBrushEvent:!1,xAxisIndicationLabel:"",yAxisIndicationLabel:"",xFieldName:"",yFieldName:""},e);if(data=e.data,d3.select(".resetAreaBtn").empty()){var n=70,r=30,a=d3.select("#"+h).append("div").style("left",.8*g+"px").style("top",.1*v+"px").attr("class","resetAreaBtn").on("mouseover",function(){d3.select(".resetAreaBtn").style("background","#7F7FFF")}).on("mouseout",function(){d3.select(this).style("background","#19a586")}).style("width",n+"px").style("height",r+"px").style("background","#19a586").style("display","inline-block").style("z-index","999").style("position","absolute").style("line-height",r+"px").style("color","#FFFFFF").style("text-align","center").style("border-radius","3px").style("cursor","pointer");a.html("Reset")}if(d3.selectAll(".resetAreaBtn").on("click",function(){C.domain(d3.extent(L,function(t,e){return e})),de=!0,t(f).find("svg g").empty(),t(f).find(".brushedArea").remove(),fe.areaChart({xFieldName:N,yFieldName:D,axisColor:"#222222",attachBrushEvent:!0,xAxisIndicationLabel:e.xAxisIndicationLabel,yAxisIndicationLabel:e.yAxisIndicationLabel,data:L}),J.circleChart({color:"#fff953",r:3,data:L})}),!de){N=e.xFieldName,D=e.yFieldName,L=data,_=e;var i=50;g=t(f).width()-i,v=t(f).height()-i;{t(f).attr("id")}p=p,C=d3.scale.linear().range([0,g-V.scale]),M=d3.scale.linear().range([v-V.scale,0]),S=d3.min(data,function(t){return t[D]}),T=d3.max(data,function(t){return t[D]}),T=1.5*T,C.domain(d3.extent(data,function(t,e){return e
})),M.domain([S,T]),A=d3.svg.axis().scale(C).orient("bottom"),b=d3.svg.axis().scale(M).orient("right").ticks(4).tickSize(5,0),p=p.append("g").attr("transform","translate("+V.left+","+V.top+")").attr("class","grouping")}C.range([V.areaLeft,g-V.scale]),data=0==e.data.length?L:e.data;var o=t(f).attr("id"),l=o+"_area",s=d3.svg.area().x(function(t,e){return C(e)}).y0(v-V.scale).y1(function(t){return M(t[D])}),d=p.append("svg:defs").append("svg:linearGradient").attr("id","gradient123").attr("x1","0%").attr("y1",M(T/1.5)).attr("x2","0%").attr("y2",M(S)).attr("gradientUnits","userSpaceOnUse"),y="#5db6e0";d.append("stop").attr("offset","0%").attr("stop-color",y),d.append("stop").attr("offset","0.25").attr("stop-color","#82c8e8"),d.append("stop").attr("offset","0.5").attr("stop-color","#9ed4ec"),d.append("stop").attr("offset",".75").attr("stop-color","#c9e7f4"),d.append("stop").attr("offset","100%").attr("stop-color","#f0f8fc");for(var x,k,w=(p.append("path").datum(data).attr("class",l).attr("d",s).attr("fill",e.color).on("mousemove",function(){}).on("mouseleave",function(){try{}catch(t){}}),0),F=[],I=0;I<data.length;I++)F[I]=data[I][N],w<F[I].toString().length&&(w=F[I].toString().length);if(A.tickValues(Y.getXTickArray(0,F.length,w,g-V.scale)),0==t(f).find(".axis").length){x=p.append("g").attr("class","x axis").attr("transform","translate(0,"+(v-V.scale+7)+")").attr("fill",e.axisColor).attr("fill","none").call(A),x.selectAll("text").text(function(t){return F[t]}).attr("fill","black"),b.orient("left"),k=p.append("g").attr("class","y axis").attr("transform","translate("+V.areaLeft+",3)").attr("fill",e.axisColor).attr("fill","none").call(b);var P=9,z=g/2.5-e.title.length*P/2,E=p.append("g").attr("class","title");B.appendLabel(e.title,z,.06*v,0,E,m.chartTitleColor,800);var P=6,O=e.xAxisIndicationLabel.toString().length*P,R=.13*v,q=g/2-O/2;B.appendLabel(e.xAxisIndicationLabel,q,R,0,x,m.xLabelColor,600);var G=e.xAxisIndicationLabel.toString().length*P,j=v/2+G/2,U=-V.areaLeft/1.3;B.appendLabel(e.yAxisIndicationLabel,U,j,-90,k,m.yLabelColor,600)}X.drawBrushing(function(n){de=!0,C.domain(d3.extent(n,function(t,e){return e})),t(f).find("svg .grouping").empty(),t(f).find(".brushedArea").remove(),fe.areaChart({axisColor:"#222222",attachBrushEvent:!0,data:n,xAxisIndicationLabel:e.xAxisIndicationLabel,yAxisIndicationLabel:e.yAxisIndicationLabel}),J.circleChart({color:"#fff953",r:3,data:n})}),u(p),c(p)}},he={image:"",needle:"",plot:"",arc:"",prevdata:90,text:"",meterChartTest:function(){var t=p,e=g/3,n=e/2;he.arc=d3.svg.arc().innerRadius(n).outerRadius(e).startAngle(120*(Math.PI/180)).endAngle(240*(Math.PI/180));var r=(t.append("g").attr("class","arc"),t.append("g").attr("transform","translate( "+(g/2-e)+" , "+v/4+")"));he.image=r.append("svg:image").attr("x",0).attr("y",0).attr("width",2*e).attr("height",n).attr("xlink:href","gauge_skin.jpg").attr("id","fillImage"),he.text=t.append("svg:text").attr("transform","translate( "+.5112*g+" , "+.878*v+")").attr("text-anchor","middle").text(""),console.log("height of meter: "+v),console.log("width of meter "+g);{var a=n/2;V.top+4}he.needle=r.append("path").attr("class","tri").attr("d","M"+(a+2)+" 130 L"+a+" 0 L"+(a-3)+" 130 C"+(a-3)+" 140 "+(a+3)+" 140 "+(a+3)+" 130 Z").attr("transform","translate("+(e-n)+","+n+") rotate(-90) ")},turnNeedle:function(t){function e(){return d3.interpolateString("rotate("+n+", 150, 130)","rotate("+r+", 150, 130)")}0>t?he.text.transition().attr("stroke","red").text(t):he.text.transition().attr("stroke","green").text(t),he.needle.transition().duration(1e3).attrTween("transform",e);var n=he.getAngleFromCoordinate(he.getCoordinateFromData(he.prevdata)),r=he.getAngleFromCoordinate(he.getCoordinateFromData(he.getPercentFromAngle(he.getAngleForProfitAndLoss(t))))},getPercentFromAngle:function(t){return 0>t&&t>=-180?-(5*t/9):5*t/9},getAngleFromCoordinate:function(t){var e=0,n=90;return e+=n*t},getCoordinateFromData:function(t){return coordinate=t/100-(1-t/100)},getRadianFromData:function(t){return coordinate=t/57.2958},callTurnNeedle:function(){var t=100*Math.random();meterChart.turnNeedle(t),meterChart.prevdata=t},getAngleForProfitAndLoss:function(t){var e;return e=t>0&&100>=t?90+.9*t:90+.9*t}},pe={drawThreeDStackedBarChart:function(e,n,r,a,i,o,s,d,f){function b(t,e,n,r,a,i){r=H(r),e=H(e);var o=[];for(l=0;3>l;l++)0==l?(x=t-.07*q,y=e-i+.03*g):1==l?(x=t-20,y=e-i):2==l&&(x=q,y=e-i),o.push(JSON.parse('{"x":'+x+',"y":'+y+"}"));return o}function k(t,e,n,r,a,i){r=H(0)-H(r);var o=[];if(1==a)for(var l=parseInt(.33*n)+1,s=0;5>s;s++){0==s?e=e:1==s?e-=r:2==s?t+=n:3==s?e+=r:4==s&&(t-=n);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}else if(2==a)for(var l=parseInt(.33*n)+1,s=0;4>s;s++){0==s?e=e:1==s?(t-=l,e-=l):2==s?e-=r:3==s&&(t+=l,e+=l);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}else if(3==a)for(var l=parseInt(.33*n)+1,s=0;4>s;s++){0==s?(ie=e+r,e-=r):1==s?(t-=l,e-=l):2==s?t+=n:3==s&&(t+=l,e+=l);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}return o}var A={topMargin:5,rightMargin:30,bottomMargin:0,leftMargin:10,color:d3.scale.category20(),toolTipLabelForYAxis:"Profit(in Crores)",axisTextColor:"black",legendTextColor:"black"};if("undefined"!=typeof i)for(var M in i)"undefined"!=typeof i[M]&&(A[M]=i[M]);{var w=.9*g/(2*a[0].data.length),C=10,S=5;.3*g/a.length}C=.6*w;var T=g/(2*a[0].data.length);w=T;for(var L=T+C,_=[],N=0,D=[],F={},V=0;V<a.length;V++){var I=d3.max(a[V].data,function(t){return t});N+=I,_.push(I),D.push(a[V].key),F[a[V].key]="legend-"+V}var P=N,z=0,E=1;for(V=0;V<(""+P).length-1;V++)E+="0";for(var O=d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("linear"),q=a[0].data.length*L+w/2,U=d3.scale.linear().domain([0,a[0].data.length]).range([w/1.5,q]),H=d3.scale.linear().domain([0,1.55*P]).range([v-.15*v,0]),X=d3.svg.axis().scale(U).orient("bottom").tickFormat($).tickSize(0),W=d3.svg.axis().scale(H).orient("left").tickSize(0),$=d3.format("1"),J=0,Z=0;Z<f.length;Z++)J<f[Z].toString().length&&(J=f[Z].toString().length);X.tickValues(Y.getXTickArray(0,f.length,J,q-w/1.5)),W.tickValues(d3.range(0,1.5*P,1.5*P/10));var K,Q=(P+100*(""+P).length,H(1.5*P));K=400>g?50:.02*q,p=p.append("g").attr("transform","translate("+K+",0)"),q+=.1*q;var te=g-.89*g,ee=v-.9*v,ne=p.append("g").attr("transform","translate("+.04*g+",0)");for(j=0;10>j;j++){var re=ne.append("path").attr("d",O(b(te,ee,w,P,n,Q))).attr("stroke-width",.5).attr("fill","none"),ae=re.node().getTotalLength();re.attr("stroke-dasharray",ae+" "+ae).attr("stroke-dashoffset",ae).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",1).attr("stroke",s).attr("stroke-width",.5).attr("fill","none"),Q+=H(0)-H(1.5*P/10)}for(var te=g-.89*g,ee=H(0),ie=0,oe=a[0].data.length,le=a.length,se=0;oe>se;se++){for(var ue=H(0),ce=0,de=0;le>de;de++){{var fe=a[de].data;ne.append("path").attr("class","lineGraphClass "+F[a[de].key]).attr("d",O(k(te+z,ue,w,fe[se],1,fe[se],1))).attr("val",function(){var t=k(te+z,ue,w,fe[se],1,fe[se],1);return t[0].height}).attr("stroke","grey").attr("fill",o[de]).attr("xVal",a[de].key).on("mouseover",function(){var t=[{headingName:A.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];G.showToolTip(d3.event,"",d3.select(this).attr("xVal"),!1,t)}).on("mouseout",function(){d3.select(this);G.hideTooTip()}).style("display","none"),ne.append("path").attr("class","lineGraphClass "+F[a[de].key]).attr("d",O(k(te+z,ue,w,fe[se],2,fe[se],1))).attr("val",function(){var t=k(te+z,ue,w,fe[se],2,fe[se],1);return t[0].height}).attr("stroke","white").attr("fill",o[de]).attr("stroke","grey").attr("xVal",a[de].key).on("mouseover",function(){var t=[{headingName:A.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];G.showToolTip(d3.event,"",d3.select(this).attr("xVal"),!1,t)}).on("mouseout",function(){d3.select(this);G.hideTooTip()}).style("display","none"),ne.append("path").attr("class","lineGraphClass "+F[a[de].key]).attr("d",O(k(te+z,ue,w,fe[se],3,fe[se],1))).attr("val",function(){var t=k(te+z,ue,w,fe[se],3,fe[se],1);return t[0].height}).attr("stroke","grey").attr("fill",o[de]).attr("xVal",a[de].key).on("mouseover",function(){var t=[{headingName:A.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];G.showToolTip(d3.event,"",d3.select(this).attr("xVal"),!1,t)}).on("mouseout",function(){d3.select(this);G.hideTooTip()}).style("display","none")}ce+=fe[se],ue=H(ce)-S*(de+1)}z+=L,ue=H(0)}for(var he=t(".lineGraphClass").hide(),pe=0;pe<he.length;pe++)t(he[pe]).slideUp(100*pe).delay(40*pe).fadeIn();u(p);var ge=ne.append("g").attr("class","axis").attr("transform","translate("+te+","+(v-.15*v+H(1.5*P))+")").call(X);ge.selectAll("text").text(function(t,e){return f[e]}).style("fill",d+" !important");var ye,ve=p.append("g").attr("class","axis").attr("transform","translate("+.08*g+","+H(1.5*P)+")").call(W),me=6,xe=ve.attr("transform").indexOf("(")+1,be=ve.attr("transform").indexOf(","),ke=A.yLabel.toString().length*me,Ae=v/2+ke/2;ye=400>g?1.5*-parseInt(ve.attr("transform").substring(xe,be)):.7*-parseInt(ve.attr("transform").substring(xe,be)),B.appendLabel(A.yLabel,ye,Ae,-90,ve,m.yLabelColor,600);var Me=A.xLabel.toString().length*me,we=q/2-Me,Ce=.1*v;B.appendLabel(A.xLabel,we,Ce,0,ge,m.xLabelColor,600);var me=9,Se=q/2-A.title.length*me/2,Te=p.append("g").attr("class","title");B.appendLabel(A.title,Se,.03*v,0,Te,m.chartTitleColor,800);var Le=ne.append("g").attr("class","legend").attr("width",g).attr("height",v).attr("transform","translate("+te+","+.08*v+")"),_e=0,Ne=0;g>300?(_e=12,Ne=12):(_e=10,Ne=10);var De=(d3.max(a,function(t){return t.key.length}),R.getLegendPositionArray(D,g,.25*P));Le.selectAll("rect").data(D).enter().append("rect").attr("x",function(t,e){return De[e].x}).attr("y",function(t,e){return De[e].y}).attr("width",_e).attr("height",Ne).style("fill",function(t,e){return o[e]}).on("click",function(e){var n=p.selectAll("."+F[e]).style("display");if("none"==n)t("#"+h).find("path."+F[e]).slideUp(400).delay(400).fadeIn(),p.selectAll(".legend-text."+F[e]).style("text-decoration","none");else{{p.selectAll("."+F[e])}t("#"+h).find("path."+F[e]).slideDown(400).delay(400).fadeOut(),p.selectAll(".legend-text."+F[e]).style("text-decoration","line-through")}}),Le.selectAll("text").data(D).enter().append("text").attr("class",function(t){return"legend-text "+F[t]}).attr("x",function(t,e){return De[e].textPos}).attr("y",function(t,e){return De[e].y+Ne}).attr("width",_e).attr("height",Ne).attr("font-size",12).attr("dy",".08em").text(function(t){return t}),c(p)}},ge={globChartAnalysis:function(t){var e=t.data.nodesArray,n=t.data.cordArray,r=t.data.nodesColor,a=t.data.Data,i=(t.data.titleColor,t.data.titleSize,t.data.title),o=t.data.backGroundImage,l=12,s="gray",u=4,d="calibri";p.style("background","url("+o+") no-repeat").style("background-size","100% 100%");for(var f=p.append("g").attr("class","glob-main-group").attr("transform","translate(0,0)"),h=[],y=[],x=0,b=0;b<n.length;b++)for(var k=0;2>k;k++)0==k?h[x]=n[b][k]:y[x++]=n[b][k];var A=9,M=g/2-i.length*A/2,w=p.append("g").attr("class","title");B.appendLabel(i,M,.06*v,0,w,m.chartTitleColor,800);var C=d3.scale.linear().domain([0,100]).range([v,0]),S=d3.svg.axis().scale(C).orient("left"),T=(f.append("g").attr("class","y-axis").attr("transform","translate(30,10)").attr("fill","none").style("display","none").call(S),d3.scale.linear().domain([0,100]).range([0,g-20])),L=d3.svg.axis().scale(T).orient("bottom"),_=(f.append("g").attr("class","x-axis").attr("transform","translate(10,"+(v-30)+")").attr("fill","none").style("display","none").call(L),f.append("g").attr("class","show-nodes").attr("transform","translate(0,0)"));_.selectAll("circle").data(e).enter().append("circle").attr("value",function(t,e){return e}).attr("cx",function(t,e){return T(h[e])}).attr("cy",function(t,e){return C(y[e])}).attr("r",u).attr("fill",function(t,e){return r[e]}).on("mouseover",function(){d3.select(this).attr("r",u+3);var t=d3.select(this).attr("value"),n=e[t];d3.select("#"+n.replace(/ /g,"")).attr("font-size",l+2).attr("fill","black"),d3.selectAll("."+n.replace(/ /g,"")).style("display","none");for(var r,i=0;i<a.length;i++)if(n==a[i].node){r=i;break}for(var o=0;o<a[r].connectedNodes.length;o++){var s=a[r].connectedNodes[o],c=e.indexOf(s);d3.select("#"+s.replace(/ /g,"")).attr("font-size",l+2).attr("fill","black"),d3.select("#"+(n+s).replace(/ /g,"")).attr("font-size",l+1).attr("fill","black");var d=f.append("line").attr("class","dotedLine").attr("x1",function(){return T(h[t])}).attr("y1",function(){return C(y[t])}).attr("x2",function(){return T(h[t])}).attr("y2",function(){return C(y[t])});d.transition().duration(1500).attr("x2",function(){return T(h[c])}).attr("y2",function(){return C(y[c])}).style("stroke","red").style("stroke-dasharray","5, 5")}}).on("mouseout",function(){d3.select(this).attr("r",u);var t=d3.select(this).attr("value"),n=e[t];d3.selectAll("."+n.replace(/ /g,"")).style("display","block"),d3.selectAll(".dotedLine").style("display","none"),d3.select("#"+n.replace(/ /g,"")).attr("font-size",l).attr("fill",s);for(var r,i=0;i<a.length;i++)if(n==a[i].node){r=i;break}for(var o=0;o<a[r].connectedNodes.length;o++){var c=a[r].connectedNodes[o];d3.select("#"+c.replace(/ /g,"")).attr("font-size",l).attr("fill",s),d3.select("#"+(n+c).replace(/ /g,"")).attr("font-size",l-1).attr("fill",s)}});var N=f.append("g").attr("class","show-nodes-text").attr("transform","translate(0,0)");N.selectAll("text").data(e).enter().append("text").attr("id",function(t){return t.replace(/ /g,"")}).attr("x",function(t,e){return T(h[e])-t.length*l/2.5}).attr("y",function(t,e){return C(y[e])-8}).attr("font-size",l).attr("font-family",d).attr("fill",s).text(function(t){return t});for(var D=0;D<a.length;D++)for(var F=a[D].node,V=e.indexOf(F),I=0;I<a[D].connectedNodes.length;I++){var P=a[D].connectedNodes[I],z=e.indexOf(P),E=Math.abs(T(h[z])-T(h[V])),O=Math.abs(C(y[z])-C(y[V])),R=Math.atan2(O,E),Y=R*(180/Math.PI);f.append("text").attr("id",(F+P).replace(/ /g,"")).attr("transform","translate("+(T(h[z])+T(h[V]))/2+","+(C(y[z])+C(y[V]))/2+")rotate("+Y+")").attr("font-size",l-1).attr("font-family",d).attr("fill",s).text(a[D].pathTexts[I]);var q=f.append("line").attr("class",F.replace(/ /g,"")).attr("x1",function(){return T(h[V])}).attr("y1",function(){return C(y[V])}).attr("x2",function(){return T(h[V])}).attr("y2",function(){return C(y[V])});q.transition().delay(200).duration(1500).attr("x2",function(){return T(h[z])}).attr("y2",function(){return C(y[z])}).style("stroke",function(){return a[D].pathColor})}c(p)}},ye={treeChart:function(t){function e(t){var n=0;return t.SubRoot&&t.SubRoot.forEach(function(t){var r=e(t);r>n&&(n=r)}),1+n}function n(t){var n=f.nodes(s).reverse(),a=f.links(n);n.forEach(function(t){t.y=t.depth*((g-20)/e(s))});var l=y.selectAll("g.node").data(n,function(t){return t.ids||(t.ids=++u)}),c=l.enter().append("g").attr("class","node").attr("transform",function(){return"translate("+t.y0+","+t.x0+")"}).on("click",r);c.append("circle").attr("r",1e-6).style("fill",function(){return o}).style("stroke","lightsteelblue").on("mouseover",function(){d3.select(this).style("stroke-width","2")}).on("mouseleave",function(){d3.select(this).style("stroke-width","1")}),c.append("text").attr("x",function(t){return t._children1||t._children1?-10:10}).attr("dy",".35em").attr("text-anchor",function(t){return t._children1||t._children1?"end":"start"}).text(function(t){return t.Element||t.Element||t.Root}).style("fill-opacity",1e-6).attr("fill","white");var p=l.transition().duration(d).attr("transform",function(t){return"translate("+t.y+","+t.x+")"});p.select("circle").attr("r",4.5).style("fill",function(){return o}).style("stroke","lightsteelblue"),p.select("text").style("fill-opacity",1);var v=l.exit().transition().duration(d).attr("transform",function(){return"translate("+t.y+","+t.x+")"}).remove();v.select("circle").attr("r",1e-6),v.select("text").style("fill-opacity",1e-6);var m=y.selectAll("path.link").data(a,function(t){return t.target.ids});m.enter().insert("path","g").attr("class","link").attr("d",function(){var e={x:t.x0,y:t.y0};return h({source:e,target:e})}).style("stroke",i).style("fill","none"),m.transition().duration(d).attr("d",h),m.exit().transition().duration(d).attr("d",function(){var e={x:t.x,y:t.y};return h({source:e,target:e})}).remove(),n.forEach(function(t){t.x0=t.x,t.y0=t.y})}function r(t){t.SubRoot?(t._children1=t.SubRoot,t.SubRoot=null):(t.SubRoot=t._children1,t._children1=null),n(t)}var a=t.data,i=t["link-color"],o=t["node-color"],l={top:.1*v,right:.1*g,bottom:.1*v,left:.1*g};g=g-l.right-l.left,v=v-l.top-l.bottom;var s,u=0,d=750,f=d3.layout.tree().size([v,g]).children(function(t){return t.SubRoot}),h=d3.svg.diagonal().projection(function(t){return[t.y,t.x]}),y=p.append("g").attr("transform","translate("+l.left+","+l.top+")");s=a,s.x0=v/2,s.y0=0,n(s);console.log("Get of depth : "+e(s)),c(p)}},ve={areaChartWithNegativeValueAnalysis:function(e){for(var n=e.data.title,r=e.data.yAxisArray,a=e.data.xAxisArray,i=e.data.xAxisLabel,o=e.data.yAxisLabel,l=e.data.midPoint,s=e.data.midPointLabel,d=e.data.conditionArrayAboveMidPoint,h=e.data.conditionArrayBelowMidPoint,y={left:.1*g,right:.1*g,bottom:.15*v,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},x=g-y.left-y.right,b=v-y.top-y.bottom,k=12,A="calibri",M=[],w=0;w<a.length;w++)M[w]=w;U.init(p,b,x,y.left,y.top);var C=t(f).offset().left;p.on("mouseover",function(){{var t=d3.event.pageX;d3.event.pageY}if(t-=C+y.left,t=Math.round(N.invert(t)),t>=0&&t<=a.length){var e=a[t],n=a[t],l=r[t],s=[{headingName:i,headingVal:n},{headingName:o,headingVal:l}];G.showToolTip(d3.event,"",e,!1,s,.9*d3.event.pageY)}}).on("mouseleave",function(){G.hideTooTip()});var S=p.append("g").attr("class","main-group").attr("transform","translate("+y.left+","+y.top+")"),T=9,L=x/2-n.length*T/2,_=p.append("g").attr("class","title");B.appendLabel(n,L,y.top/2,0,_,m.chartTitleColor,800);for(var N=d3.scale.linear().domain([0,a.length-1]).range([0,x]),D=d3.scale.linear().domain([d3.min(r),1.3*d3.max(r)]).range([b,0]),F=0,w=0;w<a.length;w++)F<a[w].toString().length&&(F=a[w].toString().length);var V=d3.svg.axis().scale(N).orient("bottom").tickValues(Y.getXTickArray(0,a.length,F,x)),I=S.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+b+")").call(V);I.selectAll("text").text(function(t){return a[t]}).style("font-size",k).attr("font-family",A).attr("fill","black");var T=6,P=i.toString().length*T,z=b+.15*b,E=x/2-P/2;B.appendLabel(i,E,z,0,S,m.xLabelColor,600);var O=d3.svg.axis().scale(D).orient("left").tickValues(Y.getTickArray(d3.min(r),1.3*d3.max(r),10));S.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("font-size",k).attr("font-family",A).attr("transform","translate("+-k+",0)").call(O).selectAll("text").attr("font-size",k).attr("font-family",A).attr("fill","black");var R=o.toString().length*T,q=b/2+R/2,j=-y.left/2;B.appendLabel(o,j,q,-90,S,m.yLabelColor,600);var H=s.split(" ");H.push(l);for(var X=parseInt(H.length/2),W=0;W<H.length;W++)B.appendLabel(H[W],x+.01*x,D(l)-X*k+W*k,0,S,m.yLabelColor,600);var $=t.extend({color:"url(#gradientAboveMid)"},$),J=[],Z=[];for(W in d)for(key in d[W])J.push(key),Z.push(d[W][key]);var K=(S.append("svg:defs").append("svg:linearGradient").attr("id","gradientAboveMid").attr("x1","0%").attr("y1",D(l)).attr("x2","0%").attr("y2",D(1.3*d3.max(r))).attr("gradientUnits","userSpaceOnUse").selectAll("stop").data(J).enter().append("stop").attr("offset",function(t){return""+(t-l)/(1.3*d3.max(r))*100+"%"}).attr("stop-color",function(t,e){return Z[e]}),t.extend({color:"url(#gradientBelowMid)"},K)),Q=[],te=[];for(W in h)for(key in h[W])Q.push(key),te.push(h[W][key]);for(var ee=(S.append("svg:defs").append("svg:linearGradient").attr("id","gradientBelowMid").attr("x1","0%").attr("y1",D(d3.min(r))).attr("x2","0%").attr("y2",D(l)).attr("gradientUnits","userSpaceOnUse").attr("gradientUnits","userSpaceOnUse").selectAll("stop").data(Q).enter().append("stop").attr("offset",function(t){return""+(l-t)/(l-d3.min(r))*100+"%"}).attr("stop-color",function(t,e){return te[te.length-1-e]}),[]),ne=0,re=1,ae=-1,ie=-1,W=0;W<r.length;W++){if(ee=[],r[W]>=l){re=1,ee.push(l);for(var oe=W;oe<r.length;oe++){if(r[oe]<l){ee.push(l);break}ee.push(r[oe])}2==ee.length&&W==r.length-1&&(ee=[],ee.push(l),ee.push(r[r.length-1]),ee.push(l))}else{re=0,ee.push(l);for(var oe=W;oe<r.length;oe++){if(r[oe]>=l){ee.push(l);break}ee.push(r[oe])}2==ee.length&&W==r.length-1&&(ee=[],ee.push(l),ee.push(r[r.length-1]))}ae=W,0==ae&&ee.splice(0,1),oe==r.length&&(ie=0),W=oe-1;var le=d3.svg.area().x(function(){return 0}).y0(D(l)).y1(function(t,e){return D(ee[e])}).interpolate("cardinal"),se=S.append("path").datum(ee).attr("class","spyCloseprice").attr("d",le(ee)),ue=d3.svg.area().x(function(t,e){return 0==ae?(ae=1,N(ne++)):0==ie&&e==ee.length-1?(ie=1,N(ne)):N(0==e?ne-.5:e==ee.length-1?ne-.5:M[ne++])}).y0(D(l)).y1(function(t,e){return D(ee[e])}).interpolate("cardinal");se.transition().duration(2e3).attr("d",ue(ee)).attr("fill",function(){return 1==re?$.color:K.color})}var ce=S.selectAll("circle").data(M).enter().append("circle").attr("cx",function(){return 0}).attr("cy",function(){return 0}).attr("r",4).attr("fill",function(t,e){return r[e]>l?Z[Z.length-1]:te[te.length-1]});ce.transition().duration(2e3).attr("cx",function(t,e){return N(M[e])}).attr("cy",function(t,e){return D(r[e])}),u(p),c(p)}},me={areaChartWithVaryColorAnalysis:function(e){var n=e.data.title,r=e.data.yAxisArray,a=e.data.xAxisArray,i=e.data.xAxisLabel,o=e.data.yAxisLabel,l=e.data.midPoint,s=e.data.midPointLabel;v=.9*v;for(var d={left:.1*g,right:.1*g,bottom:.1*v,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},h=g-d.left-d.right,y=v-d.top-d.bottom,x=14,b="calibri",k=[],A=0;A<a.length;A++)k[A]=A;U.init(p,y,h,d.left,d.top);var M=t(f).offset().left,w=p.append("g").attr("class","main-group").attr("transform","translate("+d.left+","+d.top+")").on("mouseover",function(){{var t=d3.event.pageX;d3.event.pageY}t-=M+d.left,t=Math.round(L.invert(t));a[t],r[t]}).on("mouseleave",function(){}),C=9,S=h/2-n.length*C/2,T=p.append("g").attr("class","title");B.appendLabel(n,S,d.top/2,0,T,m.chartTitleColor,800);for(var L=d3.scale.linear().domain([0,a.length-1]).range([0,h]),_=1.3*d3.min(r),N=1.3*d3.max(r),D=d3.scale.linear().domain([_,N]).range([y,0]),F=0,A=0;A<a.length;A++)F<a[A].toString().length&&(F=a[A].toString().length);var V=d3.svg.axis().scale(L).orient("bottom").tickValues(Y.getXTickArray(0,a.length,F,h)),I=w.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+y+")").call(V);I.selectAll("text").text(function(t){return a[t]}).style("font-size",x).attr("font-family",b);var C=6,P=i.toString().length*C,z=y+.15*y,E=h/2-P/2;B.appendLabel(i,E,z,0,w,m.xLabelColor,600);var O=d3.svg.axis().scale(D).orient("left").tickValues(Y.getTickArray(_,N,10));w.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("font-size",12).attr("transform","translate(0,0)").call(O).selectAll("text").attr("font-size",x).attr("font-family",b);o.toString().length*C,-d.left/2;B.appendLabel(o,-d.left/2,y/1.5,-90,w,m.yLabelColor,600);var R=s.split(" ");R.push(l);for(var q=parseInt(R.length/2),G=0;G<R.length;G++)B.appendLabel(R[G],h+.01*h,D(l)-q*x+G*x,0,w,m.yLabelColor,600);for(var j=[],H=-.5,X=0,G=0;G<r.length;){j=[],0==X?(X=1,j.push(r[G]),G+1<r.length&&j.push((r[G+1]+r[G])/2)):(X=0,G+1<r.length&&j.push((r[G+1]+r[G])/2),j.push(r[G+1]),G++),G=G,H+=.5;var W=d3.svg.area().x(function(t,e){return L(0==e?H:H+.5)}).y0(D(l)).y1(function(t,e){return D(j[e])});w.append("path").datum(j).attr("class","spyCloseprice").attr("fill",function(){return 0==X?"#1abc9c":"#d7dcde"}).attr("d",W(j))}var $=w.selectAll("circle").data(k).enter().append("circle").attr("cx",function(){return 0}).attr("cy",function(){return 0}).attr("r",4).attr("fill","#47A3FF");$.transition().duration(2e3).attr("cx",function(t,e){return L(k[e])}).attr("cy",function(t,e){return D(r[e])}),u(p),c(p)}},xe={comparisonAnalysis:function(e){for(var n=e.data.yAxisEstimateData,r=e.data.yAxisActualData,a=e.data.xAxisData,i=e.data.yAxisUnit,o=e.data.yAxisLabel,l=e.data.xAxisLabel,s=e.data.title,d=(e.data.titleColor,e.data.yAxisEstimateDataUnit),h=e.data.yAxisActualDataUnit,y={left:.1*g,right:.1*g,bottom:.15*v,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},x=g-y.left-y.right,b=v-y.top-y.bottom,k=x/(1.5*a.length),A=12,M="calibri",w=[],C=0;C<a.length;C++)w[C]=C;U.init(p,b,x,y.left-k/2,y.top);var S=t(f).offset().left,T=p.append("g").attr("class","main-group").attr("transform","translate("+y.left+","+y.top+")"),L=9,_=x/2-s.length*L/2,N=p.append("g").attr("class","title");B.appendLabel(s,_,y.top/2,0,N,m.chartTitleColor,800);var D=d3.scale.linear().domain([0,a.length]).range([0,x]),F=d3.min(d3.min(n)<d3.min(r)?n:r),V=d3.max(d3.max(n)>d3.max(r)?n:r);F=.3*F,V=1.3*V;for(var I=d3.scale.linear().domain([F,V]).range([b,0]),P=0,C=0;C<a.length;C++)P<a[C].toString().length&&(P=a[C].toString().length);var z=d3.svg.axis().scale(D).orient("bottom").tickValues(Y.getXTickArray(0,a.length,P,x)),E=T.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+b+")").call(z);E.selectAll("text").text(function(t){return a[t]}).style("font-size",A).attr("font-family",M).attr("fill","black");var L=6,O=l.toString().length*L,R=b+.13*b,q=x/2-O/2;B.appendLabel(l,q,R,0,T,m.xLabelColor,600);var j=d3.svg.axis().scale(I).orient("left").tickValues(Y.getTickArray(F,V,8));T.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("transform","translate("+-k/2+",0)").call(j).selectAll("text").style("font-size",A).style("font-family",M).attr("fill","black");var H=o.toString().length*L,X=b/2+H/2,W=-y.left/1.5;B.appendLabel(o,W,X,-90,T,m.yLabelColor,600);var $=T.selectAll(".rect").data(n).enter().append("rect").attr("width",k).attr("height",0).attr("x",function(t,e){return D(e)-k/2}).attr("y",b).attr("fill","#000000").attr("opacity",.2).on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=S+y.left,t=Math.round(D.invert(t));var e=a[t],l=n[t]+" "+i,s=r[t]+" "+i,u=[{headingName:d+" "+o,headingVal:l},{headingName:h+" "+o,headingVal:s}];G.showToolTip(d3.event,"",e,!1,u,.9*d3.event.pageY)}).on("mouseleave",function(){G.hideTooTip()});$.transition().duration(1500).attr("height",function(t){return I(F)-I(t)}).attr("y",function(t){return I(t)});var J=T.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad");J.append("svg:stop").attr("offset","0%").attr("stop-color","#bfefee").attr("stop-opacity",1),J.append("svg:stop").attr("offset","50%").attr("stop-color","#79d1cf").attr("stop-opacity",1),J.append("svg:stop").attr("offset","100%").attr("stop-color","#bfefee").attr("stop-opacity",1);var Z=x/(3*a.length),K=T.selectAll(".rect").data(r).enter().append("rect").attr("width",Z).attr("height",0).attr("x",function(t,e){return D(e)-Z/2}).attr("y",b).attr("fill","url(#gradient)").on("mouseover",function(){d3.select(this).attr("fill","#3e9ad9")}).on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=S+y.left,t=Math.round(D.invert(t));var e=a[t],l=n[t]+" "+i,s=r[t]+" "+i,u=[{headingName:d+" "+o,headingVal:l},{headingName:h+" "+o,headingVal:s}];G.showToolTip(d3.event,"",e,!1,u,.9*d3.event.pageY)}).on("mouseleave",function(){G.hideTooTip(),d3.select(this).attr("fill","url(#gradient)")});K.transition().duration(1500).attr("height",function(t){return I(F)-I(t)}).attr("y",function(t){return I(t)}),u(p),c(p)}},be={musicSpikesAnalysis:function(e){for(var n=e.data.title,r=(e.data.titleColor,e.data.yAxisData),a=e.data.xAxisData,i=e.data.yAxisLabel,o=e.data.xAxisLabel,l=e.data.yAxisUnit,s={left:.1*g,right:.1*g,bottom:.15*v,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},d=g-s.left-s.right,h=v-s.top-s.bottom,y=12,x="calibri",b=[],k=0;k<a.length;k++)b[k]=k;var A=t(f).offset().left,M=p.append("g").attr("class","main-group").attr("transform","translate("+s.left+","+s.top+")").on("mouseover",function(){{var t=d3.event.pageX;d3.event.pageY}if(t-=A+s.left,t=Math.round(T.invert(t)),t>=0&&t<a.length){var e=a[t],n=r[t]+" "+l,o=[{headingName:i,headingVal:n}];G.showToolTip(d3.event,"",e,!1,o,.9*d3.event.pageY)}}).on("mouseleave",function(){G.hideTooTip()}),w=9,C=d/2-n.length*w/2,S=p.append("g").attr("class","title");B.appendLabel(n,C,s.top/2,0,S,m.chartTitleColor,800);for(var T=d3.scale.linear().domain([0,a.length]).range([0,d]),L=.3*d3.min(r),_=1.3*d3.max(r),N=d3.scale.linear().domain([L,_]).range([h,0]),D=0,k=0;k<a.length;k++)D<a[k].toString().length&&(D=a[k].toString().length);var F=d3.svg.axis().scale(T).orient("bottom").tickValues(Y.getXTickArray(0,a.length,D,d)),V=M.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+h+")").call(F);V.selectAll("text").text(function(t){return a[t]}).style("font-size",y).attr("font-family",x).attr("fill","black");var w=6,I=o.toString().length*w,P=h+.13*h,z=d/2-I/2;B.appendLabel(o,z,P,0,M,m.xLabelColor,600);var E=d3.svg.axis().scale(N).orient("left").tickValues(Y.getTickArray(L,_,10));M.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("transform","translate("+-y+",0)").call(E).selectAll("text").style("font-size",y).style("font-family",x).attr("fill","black");var O=i.toString().length*w,R=h/2+O/2,q=-s.left/2;B.appendLabel(i,q,R,-90,M,m.yLabelColor,600);for(var j=d/(2*r.length),U=[],H=0;H<r.length;H++){var X=N(.5*d3.min(r))-N(r[H]);X=Math.round(X/7);for(var W=0;X>W;W++)U.push(0==W?"newRectangle":"oldRectangle")}var $=-1,J=-1,Z=0,K=-1,Q=0,te=M.selectAll("rect").data(U).enter().append("rect").attr("x",function(t){return"newRectangle"==t&&$++,T($)-j/2}).attr("y",function(){return h}).attr("width",j).attr("height",function(){return 4}).attr("fill",function(t){"newRectangle"==t&&(Q=0,K++);var e=N.invert(N(r[K])+7*Q++);return e<.33*d3.max(r)?"#1fb5ad":e<.66*d3.max(r)?"#5cb85c":"#ff7878"});te.transition().duration(1e3).attr("y",function(t){return"newRectangle"==t&&(Z=0,J++),N(r[J])+7*Z++}),u(p),c(p)}},ke={drawThreeDGroupedBarChart:function(e,n,r,a){function i(t,e,n,r,a,i){r=I(r),e=I(e);var o=[];for(l=0;3>l;l++)0==l?(x=t-.05*D,y=e-i-.04*D):1==l?(x=t-20,y=e-i):2==l&&(x=b,y=e-i),o.push(JSON.parse('{"x":'+x+',"y":'+y+"}"));return o}function o(t,e,n,r,a,i){r=I(0)-I(r);var o=[];if(1==a)for(var l=parseInt(.33*n)+1,s=0;5>s;s++){0==s?e=I(0):1==s?e-=r:2==s?t+=n:3==s?e+=r:4==s&&(t-=n);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}else if(2==a){var l=parseInt(.33*n)+1;e=I(e);for(var s=0;4>s;s++){0==s?e=I(0):1==s?(t-=l,e-=l):2==s?e-=r:3==s&&(t+=l,e+=l);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}}else if(3==a)for(var l=parseInt(.33*n)+1,s=0;4>s;s++){0==s?e=I(0)-r:1==s?(t-=l,e-=l):2==s?t+=n:3==s&&(t+=l,e+=l);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}return o}var s={topMargin:5,rightMargin:30,bottomMargin:0,leftMargin:10,colorArray:[],toolTipLabelForYAxis:"Profit(in Crores)"};if("undefined"!=typeof a)for(var d in a)"undefined"!=typeof a[d]&&(s[d]=a[d]);var f={top:.1*v,right:.05*g,bottom:.13*v,left:.05*g},h=a.xAxisTickArray,b=g-f.left-f.right,A=v-f.top-f.bottom,M=.9*g/(2*n.length),w=.9*g/(2*(n.length+r.length)),C=d3.max(n,function(t){return t}),S=d3.max(r,function(t){return t}),T=C>S?C:S,L=w,_=1;for(k=0;k<(""+T).length-1;k++)_+="0";var N=d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("linear"),D=(n.length+r.length)*w+M*r.length,F=g-.9*g,V=d3.scale.linear().domain([0,n.length]).range([F+L,b]),I=d3.scale.linear().domain([0,1.3*T]).range([A,0]),P=d3.svg.axis().scale(V).orient("bottom").tickFormat(E),z=d3.svg.axis().scale(I).orient("left"),E=d3.format("1");z.tickValues(d3.range(0,1.3*T,1.3*T/10));
var O=(T+100*(""+T).length,I(1.3*T));p=p.append("g").attr("transform","translate("+.07*g+","+f.top+")"),D+=.15*D;var R=I(1.2*T),q=p;for(H=0;10>H;H++){var j=q.append("path").attr("d",N(i(F,R,w,T,n,O))).attr("stroke","#353b37").attr("stroke-width",.3).attr("fill","none"),U=j.node().getTotalLength();j.attr("stroke-dasharray",U+" "+U).attr("stroke-dashoffset",U).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",1).attr("stroke","#353b37").attr("stroke-width",.3).attr("fill","none"),O+=I(0)-I(1.3*T/10)}for(var R=v-.9*v,H=(a.colorArray,0);H<n.length;H++){q.append("path").attr("class","threeDGroupedBarChart "+H).attr("d",N(o(V(H),R,w,r[H],1,r[H]))).attr("val",function(){var t=o(V(H),R,w,r[H],1,r[H]);return t[0].height}).attr("xVal",h[H]).attr("fill","white").on("mouseover",function(){var t=[{headingName:s.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];G.showToolTip(d3.event,"",a.xLabel+" "+d3.select(this).attr("xVal"),!1,t)}).on("mouseout",function(){d3.select(this);G.hideTooTip()}).attr("fill",function(){return s.barColorArray[0]}),q.append("path").attr("class","threeDGroupedBarChart "+H).attr("d",N(o(V(H),R,w,r[H],2,r[H]))).attr("val",function(){var t=o(V(H),R,w,r[H],2,r[H]);return t[0].height}).attr("xVal",h[H]).attr("fill","white").on("mouseover",function(){var t=[{headingName:s.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];G.showToolTip(d3.event,"",a.xLabel+" "+d3.select(this).attr("xVal"),!1,t)}).on("mouseout",function(){d3.select(this);G.hideTooTip()}).attr("fill",function(){return s.barColorArray[0]}),q.append("path").attr("class","threeDGroupedBarChart "+H).attr("d",N(o(V(H),R,w,r[H],3,r[H]))).attr("val",function(){var t=o(V(H),R,w,r[H],3,r[H]);return t[0].height}).attr("xVal",h[H]).attr("fill","white").on("mouseover",function(){var t=[{headingName:s.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];G.showToolTip(d3.event,"",a.xLabel+" "+d3.select(this).attr("xVal"),!1,t)}).on("mouseout",function(){d3.select(this);G.hideTooTip()}).attr("fill",function(){return s.barColorArray[0]}),q.append("path").attr("class","threeDGroupedBarChart "+H).attr("d",N(o(V(H)-w,R,w,n[H],1,n[H]))).attr("val",function(){var t=o(V(H)-w,R,w,n[H],1,n[H]);return t[0].height}).attr("xVal",h[H]).attr("fill","white").on("mouseover",function(){var t=[{headingName:s.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];G.showToolTip(d3.event,"",a.xLabel+" "+d3.select(this).attr("xVal"),!1,t)}).on("mouseout",function(){d3.select(this);G.hideTooTip()}).attr("fill",function(){return s.barColorArray[1]}),q.append("path").attr("class","threeDGroupedBarChart "+H).attr("d",N(o(V(H)-w,R,w,n[H],2,n[H]))).attr("val",function(){var t=o(V(H)-w,R,w,n[H],2,n[H]);return t[0].height}).attr("xVal",h[H]).attr("fill","white").on("mouseover",function(){var t=[{headingName:s.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];G.showToolTip(d3.event,"",a.xLabel+" "+d3.select(this).attr("xVal"),!1,t)}).on("mouseout",function(){d3.select(this);G.hideTooTip()}).attr("fill",function(){return s.barColorArray[1]}),q.append("path").attr("class","threeDGroupedBarChart "+H).attr("d",N(o(V(H)-w,R,w,n[H],3,n[H]))).attr("val",function(){var t=o(V(H)-w,R,w,n[H],3,n[H]);return t[0].height}).attr("xVal",h[H]).attr("fill","white").on("mouseover",function(){var t=[{headingName:s.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];G.showToolTip(d3.event,"",a.xLabel+" "+d3.select(this).attr("xVal"),!1,t)}).on("mouseout",function(){d3.select(this);G.hideTooTip()}).attr("fill",function(){return s.barColorArray[1]})}for(var X=t(".threeDGroupedBarChart").hide(),W=0;W<X.length;W++)t(X[W]).slideUp(300*W).delay(100*W).fadeIn();for(var $=0,J=0;J<h.length;J++)$<h[J].toString().length&&($=h[J].toString().length);P.tickValues(Y.getXTickArray(0,h.length,$,g-(F+L)));var Z=q.append("g").attr("class","axis").attr("fill","none").attr("transform","translate(0,"+A+")").call(P);Z.selectAll("text").text(function(t){return h[t]});var K=g-.9*g,Q=q.append("g").attr("class","axis").attr("transform","translate("+(K-.05*D)+","+-.04*D+")").call(z);Q.selectAll("line").style("display","none"),Q.selectAll("path").style("display","none");var te,ee=Q.attr("transform").indexOf("(")+1,ne=Q.attr("transform").indexOf(","),re=6,ae=s.yLabel.toString().length*re,ie=A/2+ae/2;te=400>g?2*-parseInt(Q.attr("transform").substring(ee,ne)):.95*-parseInt(Q.attr("transform").substring(ee,ne)),B.appendLabel(s.yLabel,te,ie,-90,Q,m.yLabelColor,600);var oe=s.xLabel.length*re,le=.15*A,se=b/2-oe/2;B.appendLabel(s.xLabel,se,le,0,Z,m.xLabelColor,600);var re=9,ue=b/2-s.title.length*re/2,ce=p.append("g").attr("class","title");B.appendLabel(s.title,ue,.01*v,0,ce,m.chartTitleColor,800),c(p),u()}},Ae={barWithLabelAnalysis:function(t){var e=t.yAxisData,n=t.xAxisData,r=t.colorArray,a=t.averageValue,i=t.unit,o=t.title,l={left:.1*g,right:.1*g,bottom:.1*v,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},s=g-l.left-l.right,d=v-l.top-l.bottom,f=10;U.init(p,d,s,l.left,l.top);for(var h=[],y=0;y<n.length;y++)h[y]=y;var x=p.append("g").attr("class","barMainGroup").attr("transform","translate("+l.left+","+l.top+")"),b=9,k=s/2-o.length*b/2,A=p.append("g").attr("class","title");B.appendLabel(o,k,l.top/2,0,A,m.chartTitleColor,800);var M=d3.scale.linear().domain([0,n.length-1]).range([0,s]),w=d3.min(e),C=1.5*d3.max(e);0>w&&(w=1.5*w);var S=d3.scale.linear().domain([w,C]).range([d,0]),T=d3.svg.axis().scale(S).orient("left"),L=(x.append("g").attr("class","y axis").attr("transform","translate("+.2*-l.left+",0)").attr("fill","none").call(T).selectAll("text").attr("fill","black"),s/(3*n.length)),_=x.selectAll(".rect").data(e).enter().append("rect").attr("width",L).attr("height",0).attr("x",function(t,e){return M(e)-L/2}).attr("y",S(a)).attr("fill",function(t,e){return r[e]});_.transition().duration(1500).attr("height",function(t){return t>a?S(a)-S(t):S(t)-S(a)}).attr("y",function(t){return S(t>a?t:a)});{var N=(x.selectAll(".text").data(e).enter().append("text").attr("x",function(t,e){return M(e)-L/3}).attr("y",function(t){return t>a?S(t)-5:S(t)+15}).attr("fill","white").text(function(t){return t>a?"+"+t+" "+i:t+" "+i}),p.append("g").attr("class","legend").attr("transform","translate("+l.left+","+l.top+")")),D=d+.02*d,F=R.showHorizontalLegend(s,D,n,f);N.selectAll(".rect").data(F).enter().append("rect").attr("width",f).attr("height",f).attr("x",function(t,e){return F[e].x}).attr("y",function(t,e){return F[e].y}).attr("fill",function(t,e){return r[e]}),N.selectAll(".text").data(F).enter().append("text").attr("x",function(t,e){return F[e].textXPos}).attr("y",function(t,e){return F[e].y+f}).attr("font-family","calibri").text(function(t,e){return n[e]})}c(p),u()}},Me={logoChart:function(e){function n(t,e,n){var r=e.append("g").attr("class",""+t.profileImageName).attr("transform","translate(0,0)"),a=t.y+.5,i=t.x+.5,o=t.arcRadius,s=1.2*t.arcRadius,u=t.imageFrameColor,c=t.profileImageName,d=t.imageWidth,f=t.imageHeight,p=(d3.layout.pie().sort(null).value(function(t){return t}),d3.svg.arc().innerRadius(o).outerRadius(s).startAngle(0).endAngle(8)),g=r.append("path").attr("d",p).attr("id","arc"+n).attr("transform",function(){return"translate("+C(i)+","+M(a)+")"}).attr("fill",u).style("opacity",0);if(g.transition().duration(2e3).style("opacity",1),r.append("image").attr("xlink:href",c).attr("width",d).attr("height",f).attr("value",n).attr("x",C(i)-t.imageWidth/2).attr("y",M(a)-t.imageHeight/2).on("mousemove",function(){var t=d3.select(this).attr("value"),e=[{headingName:y[t],headingVal:x[t]}];G.showToolTip(d3.event,"","",!1,e,.9*d3.event.pageY)}).on("mouseleave",function(){G.hideTooTip()}),l[n]>0)var v=C(i)-(s+o)/2,m=M(a)-2.2*(s-o),A=C(i)-((s+o)/2-1.5*(s-o)),w=M(a),S=C(i)-((s+o)/2+1.5*(s-o)),T=M(a);else var v=C(i)+(s+o)/2,m=M(a)+2.2*(s-o),A=C(i)+((s+o)/2-1.5*(s-o)),w=M(a),S=C(i)+((s+o)/2+1.5*(s-o)),T=M(a);var L=r.append("polygon").attr("class","triangle-value-indicator").style("stroke","white").style("stroke-width",2).style("fill",function(){return l[n]>=0?h[2]:h[3]}).attr("points",function(){return l[n]>=0?""+v+","+(M(a-.5)-15)+","+A+","+M(a-.5)+","+S+","+M(a-.5):""+v+","+(M(a+.5)+15)+","+A+","+M(a+.5)+","+S+","+M(a+.5)});L.transition().duration(2e3).attr("points",""+v+","+m+","+A+","+w+","+S+","+T);var _=t.text.toString(),N=8,D=8;_=_+" "+k;var F=C(i)-_.length/2*N,V=M(a)+s+D;r.append("text").attr("x",F).attr("y",V).attr("dx",".2em").attr("dy",".25em").attr("text-anchor","start").attr("fill",function(){return l[n]>0?b[0]:b[1]}).text(function(){return l[n]>0?"+"+_:_})}g=.98*t(f).width(),v=.98*t(f).height();var r={left:.05*g,right:.05*g,bottom:.1*v,top:.05*v,chartSeparator:5},a=g-r.left-r.right,i=v-r.top-r.bottom,o=e.title,l=e.textArray,s=e.imageArray,u=e.imageFrameColor,d=e.legendArray,h=e.legendImageArray,y=e.nameArray,x=e.classArray,b=e.textColor,k=e.unit,A=3,w=Math.ceil(s.length/A),S=9,T=a/2-o.length*S/2,L=p.append("g").attr("class","title");B.appendLabel(o,T,r.top,0,L,m.chartTitleColor,800);var _=p.append("g").attr("transform","translate("+r.left+","+r.top+")");C=d3.scale.linear().range([0,a-r.right]);s.length-1;M=d3.scale.linear().range([i-r.top,r.bottom]);var N;N=g>400?4:3,w=s.length>N?N:s.length,A=Math.ceil(s.length/N),M.domain([0,A]),C.domain([0,w]);for(var D=[],F=A-1,V=0,I=0,P=0;P<s.length;P++){I++,console.log("counter "+I+"  "+(I>w)),I>w&&(F--,V=0,I=1);var z={x:V,y:F,index:P};D.push(z),console.log("x "+z.x+"  y"+z.y+" row "+w+" c"+I),V++}var E,O;E=D[1]?(C(D[1].x)-C(D[0].x))/2:C(D[0].x+.5),O=A>1?(M(D[N].y)-M(D[0].y))/2:M(D[0].y+.5);var Y=0;Y=O>E?E:O,Y=1.1*Math.abs(Y);for(var q=Y,j=.5*Y,P=0;P<D.length;P++)D[P].imageWidth=q,D[P].imageHeight=q,D[P].arcRadius=j,D[P].profileImageName=s[P],D[P].imageFrameColor=u[P],D[P].text=l[P],n(D[P],_,P);var U=p.append("g").attr("class","legend").attr("transform","translate("+r.left+","+r.top+")"),H=5,X=i,W=R.showHorizontalLegend(a,X,d,1.5*H),$=[];$.push(W[0]),$.push(W[1]);U.selectAll(".circle").data($).enter().append("circle").attr("class","legend").attr("r",H).attr("cx",function(t,e){return $[e].x}).attr("cy",function(t,e){return $[e].y}).attr("fill",function(t,e){return h[e]});$=[],$.push(W[2]),$.push(W[3]),U.selectAll(".polygon").data($).enter().append("polygon").attr("class","legend").style("fill",function(t,e){return h[e]}).attr("points",function(t,e){var n=$[e].x,r=$[e].y;return""+(n-2)+","+(r-H/2)+","+(n-9)+","+(r+8)+","+(n+5)+","+(r+8)});U.selectAll(".text").data(W).enter().append("text").attr("x",function(t,e){return W[e].textXPos}).attr("y",function(t,e){return W[e].y+H}).attr("font-family","calibri").attr("font-size","11px","important").text(function(t,e){return d[e]});c(p)}},we={multiAxisChartAnalysis:function(e){var n=e.yObject,r=e.xAxisData,a=e.legendColor,i=e.legend,o=e.title,l={left:.05*g,right:.05*g,bottom:.1*v,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},s=g-l.left-l.right,u=v-l.top-l.bottom,d=9,h=s/2-o.length*d/2,y=p.append("g").attr("class","title");B.appendLabel(o,h,l.top/2,0,y,m.chartTitleColor,800);for(var x=t(f).offset().left,b=p.append("g").attr("class","scoredMainGroup").attr("transform","translate("+l.left+","+l.top+")").on("mouseover",function(){{var t=d3.event.pageX;d3.event.pageY}if(t-=x+l.left,t=Math.round(I.invert(t)),t>=0&&t<r.length){console.log(t);var e=r[t],a=[{headingName:i[0],headingVal:n[0].yAxisData[t]},{headingName:i[1],headingVal:n[0].yAixsAvgData[t]},{headingName:i[2],headingVal:n[1].yAxisData[t]},{headingName:i[3],headingVal:n[1].yAixsAvgData[t]},{headingName:i[4],headingVal:n[2].yAxisData[t]},{headingName:i[5],headingVal:n[2].yAixsAvgData[t]}];G.showToolTip(d3.event,"",e,!1,a,d3.event.pageY,u/2)}k.attr("display","block").attr("x1",I(t)).attr("x2",I(t))}).on("mouseleave",function(){k.attr("display","none"),G.hideTooTip()}),k=b.append("line").attr("y1",l.top).attr("y2",u).attr("stroke","#a7a7a7").attr("display","none"),A=[],M=0,w=s,C=11,S=0,T=0;T<n.length;T++){for(var L=0,_=0;_<n[T].yAxisData.length;_++)L<n[T].yAxisData[_].toString().length&&(L=n[T].yAxisData[_].toString().length),L<n[T].yAixsAvgData[_].toString().length&&(L=n[T].yAixsAvgData[_].toString().length);L*=C;var N=d3.min(d3.min(n[T].yAxisData)<d3.min(n[T].yAixsAvgData)?n[T].yAxisData:n[T].yAixsAvgData),D=d3.max(d3.max(n[T].yAxisData)>d3.max(n[T].yAixsAvgData)?n[T].yAxisData:n[T].yAixsAvgData);if(D=D>0?1.3*D:.7*D,N=N>0?.5*N:1.5*N,A[T]=d3.scale.linear().domain([N,D]).range([u,0]),T%2==0){M+=L;var F=d3.svg.axis().scale(A[T]).orient("left").tickValues(function(){return 0==S?Y.getTickArray(N,D,6):Y.getTickArray(N,D,5)});b.append("g").attr("class","y axis").attr("transform","translate("+M+",0)").attr("fill","none").style("stroke-width",.3).style("stroke",n[T].yAxisColor).call(F).selectAll("text").attr("fill",n[T].yAxisColor)}else{var F=d3.svg.axis().scale(A[T]).orient("left").tickValues(function(){return 0==S?(S=1,Y.getTickArray(N,D,6)):(S=0,Y.getTickArray(N,D,5))});b.append("g").attr("class","y axis").attr("transform","translate("+w+",0)").attr("fill","none").style("stroke-width",.3).style("stroke",n[T].yAxisColor).call(F).selectAll("text").attr("fill",n[T].yAxisColor),w-=L}}for(var V=[],T=0;T<r.length;T++)V[T]=T;for(var I=d3.scale.linear().domain([0,r.length-1]).range([M,w-.01*w]),L=0,T=0;T<r.length;T++)L<r[T].toString().length&&(L=r[T].toString().length);for(var P=d3.svg.axis().scale(I).orient("bottom").tickValues(Y.getXTickArray(0,r.length,L,w-M)),z=(b.append("g").attr("class","x axis").attr("transform","translate(0,"+u+")").attr("fill","none").call(P).selectAll("text").text(function(t){return r[t]}),b.append("g").attr("class","legend").attr("transform","translate("+M+",0)")),E=15,O=3,q=0,j=R.showHorizontalLegend(w-M,q,i,E),T=(z.selectAll(".line").data(j).enter().append("line").attr("x1",function(t,e){return j[e].x}).attr("y1",function(t,e){return j[e].y}).attr("x2",function(t,e){return j[e].x+E}).attr("y2",function(t,e){return j[e].y}).attr("stroke",function(t,e){return a[e]}).attr("stroke-width",function(t,e){return e%2==0?O:1.5}).style("stroke-dasharray",function(t,e){return e%2==0?"0, 0":"2, 2"}),z.selectAll(".text").data(j).enter().append("text").attr("x",function(t,e){return j[e].textXPos}).attr("y",function(t,e){return j[e].y+O}).attr("font-family","calibri").text(function(t,e){return i[e]}),0);T<n.length;T++){var U=d3.svg.line().x(function(t,e){return I(V[e])}).y(function(t,e){return A[T](n[T].yAxisData[e])}),H=b.selectAll(".path").data([r]).enter().append("path").attr("d",U).attr("stroke",n[T].yAxisColor).attr("stroke-width",3).attr("fill","none"),X=H.node().getTotalLength();H.attr("stroke-dasharray",function(){return X+","+X}).attr("stroke-dashoffset",X).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0);var W=d3.svg.line().x(function(t,e){return I(V[e])}).y(function(t,e){return A[T](n[T].yAixsAvgData[e])}),$=b.selectAll(".path").data([r]).enter().append("path").attr("d",W).attr("stroke",n[T].yAxisColor).attr("stroke-width",1.5).attr("fill","none"),J=$.node().getTotalLength();$.attr("stroke-dasharray",function(){for(var t=3,e=2*t,n=t;J>e;)n+=","+t+","+t,e+=2*t;return n+","+J}).attr("stroke-dashoffset",J).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0);var Z=b.selectAll(".circle").data(r).enter().append("circle").attr("cx",0).attr("cy",0).attr("r",3).attr("stroke",n[T].yAxisColor).attr("fill","white");Z.transition().duration(2500).attr("cx",function(t,e){return I(V[e])}).attr("cy",function(t,e){return A[T](n[T].yAxisData[e])});var K=b.selectAll(".circle").data(r).enter().append("circle").attr("cx",0).attr("cy",0).attr("r",3).attr("stroke",n[T].yAxisColor).attr("fill","white");K.transition().duration(2500).attr("cx",function(t,e){return I(V[e])}).attr("cy",function(t,e){return A[T](n[T].yAixsAvgData[e])})}c(p)}},Ce={threeDPieChartAnalysis:function(t){function e(t,e,n,r){if(t.endAngle-t.startAngle==0)return"M 0 0";var a=e*Math.cos(t.startAngle),i=n*Math.sin(t.startAngle),o=e*Math.cos(t.endAngle),l=n*Math.sin(t.endAngle),s=[];return s.push("M",a,i,"A",e,n,"0",t.endAngle-t.startAngle>Math.PI?1:0,"1",o,l,"L",r*o,r*l),s.push("A",r*e,r*n,"0",t.endAngle-t.startAngle>Math.PI?1:0,"0",r*a,r*i,"z"),s.join(" ")}function n(t,e,n,r){var a=t.startAngle>Math.PI?Math.PI:t.startAngle,i=t.endAngle>Math.PI?Math.PI:t.endAngle,o=e*Math.cos(a),l=n*Math.sin(a),s=e*Math.cos(i),u=n*Math.sin(i),c=[];return c.push("M",o,r+l,"A",e,n,"0 0 1",s,r+u,"L",s,u,"A",e,n,"0 0 0",o,l,"z"),c.join(" ")}function r(t,e,n,r,a){var i=t.startAngle<Math.PI?Math.PI:t.startAngle,o=t.endAngle<Math.PI?Math.PI:t.endAngle,l=a*e*Math.cos(i),s=a*n*Math.sin(i),u=a*e*Math.cos(o),c=a*n*Math.sin(o),d=[];return d.push("M",l,s,"A",a*e,a*n,"0 0 1",u,c,"L",u,r+c,"A",a*e,a*n,"0 0 0",l,r+s,"z"),d.join(" ")}function a(t,e){return t.endAngle-t.startAngle>.2?Math.round(u[e]/C*100)+f:""}function i(t){return Math.round(u[t]/C*100)+f}function o(t){var e=d3.interpolate({startAngle:-180*A,endAngle:-180*A},t);return function(t){return r(e(t),T,L,_,N)}}function l(t){var n=d3.interpolate({startAngle:-180*A,endAngle:-180*A},t);return function(t){return e(n(t),T,L,N)}}function s(t){var e=d3.interpolate({startAngle:-180*A,endAngle:-180*A},t);return function(t){return n(e(t),T,L,_)}}for(var u=t.dountData,c=t.dountKey,d=t.colorArray,f=t.unit,h=t.factor,y={left:.1*g,right:.1*g,bottom:.15*v,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},m=g-y.left-y.right,x=v-y.top-y.bottom,b=p.append("g").attr("class","main-group").attr("transform","translate("+y.left+","+y.top+")"),k=b.append("g").attr("class","dountPie").attr("transform","translate("+m/2+","+x/2+")"),A=Math.PI/180,M=0,w=8,C=0,S=0;S<u.length;S++)C+=u[S];var T=m>x?x:m;T=.45*T;var L=.75*T,_=25,N=0,D=d3.layout.pie().sort(null).value(function(t){return t});k.selectAll(".innerSlice").data(D(u)).enter().append("path").attr("class","innerSlice").style("fill",function(t,e){return d[e]}).attr("d",function(t){return r(t,T,L,_,N)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*M,n=Math.sin(t.midAngle)*M;return"translate("+e+","+n+")"}).transition().duration(1500).attrTween("d",o),k.selectAll(".topSlice").data(D(u)).enter().append("g").attr("class","topSlice").style("fill",function(t,e){return d[e]}).style("stroke",function(t,e){return d[e]}).append("path").attr("value",function(t,e){return e}).attr("d",function(t){return e(t,T,L,N)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*M,n=Math.sin(t.midAngle)*M;return"translate("+e+","+n+")"}).on("mouseover",function(){var t=d3.select(this).attr("value"),e=d3.select("#text"+t).attr("x");d3.select("#text"+t).attr("x",function(){return e>0?e-10+20:e-10}).style("font-weight",600)}).on("mouseout",function(){var t=d3.select(this).attr("value"),e=d3.select("#text"+t).attr("x");d3.select("#text"+t).attr("x",function(){return e>0?e-10:e-10+20}).style("font-weight","normal")}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=c[t],n=i(t),r=[{headingName:h,headingVal:n}];G.showToolTip(d3.event,"",e,!1,r,.96*d3.event.pageY)}).on("mouseleave",function(){G.hideTooTip()}).transition().duration(1500).attrTween("d",l),k.selectAll(".outerSlice").data(D(u)).enter().append("path").attr("class","outerSlice").style("fill",function(t,e){return d[e]}).attr("d",function(t){return n(t,T,L,_)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*M,n=Math.sin(t.midAngle)*M;return"translate("+e+","+n+")"}).transition().duration(1500).attrTween("d",s),k.selectAll(".percent").data(D(u)).enter().append("text").attr("class","percent").attr("x",function(t){return.6*T*Math.cos(.5*(t.startAngle+t.endAngle))}).attr("y",function(t){return.6*L*Math.sin(.5*(t.startAngle+t.endAngle))}).text(function(t,e){return a(t,e)});for(var F,V,I=d3.svg.line().x(function(t,e){return P[e]}).y(function(t,e){return z[e]}),P=[],z=[],E=0,S=0;S<u.length;S++)F=u[S]/C*360,V=E,E+=F,V=(V+E)/2,P[0]=.98*T*Math.cos(V*(Math.PI/180)),z[0]=.98*L*Math.sin(V*(Math.PI/180)),P[1]=1.4*T*Math.cos(V*(Math.PI/180)),z[1]=1.4*L*Math.sin(V*(Math.PI/180)),P[2]=P[1]+.2*T*Math.cos(V*(Math.PI/180)),z[2]=z[1],k.selectAll(".path").data([P]).enter().append("path").attr("d",I).attr("stroke-width",1).attr("fill","none").attr("stroke",d[S]),k.append("text").attr("id",function(){return"text"+S}).attr("x",function(){return P[2]>0?P[2]:P[2]-c[S].length*w}).attr("y",z[2]+3).attr("fill",d[S]).text(function(){return c[S]})}},Se={threeDDountChartAnalysis:function(e){function n(t,e,n,r){if(t.endAngle-t.startAngle==0)return"M 0 0";var a=e*Math.cos(t.startAngle),i=n*Math.sin(t.startAngle),o=e*Math.cos(t.endAngle),l=n*Math.sin(t.endAngle),s=[];return s.push("M",a,i,"A",e,n,"0",t.endAngle-t.startAngle>Math.PI?1:0,"1",o,l,"L",r*o,r*l),s.push("A",r*e,r*n,"0",t.endAngle-t.startAngle>Math.PI?1:0,"0",r*a,r*i,"z"),s.join(" ")}function r(t,e,n,r){var a=t.startAngle>Math.PI?Math.PI:t.startAngle,i=t.endAngle>Math.PI?Math.PI:t.endAngle,o=e*Math.cos(a),l=n*Math.sin(a),s=e*Math.cos(i),u=n*Math.sin(i),c=[];return c.push("M",o,r+l,"A",e,n,"0 0 1",s,r+u,"L",s,u,"A",e,n,"0 0 0",o,l,"z"),c.join(" ")}function a(t,e,n,r,a){var i=t.startAngle<Math.PI?Math.PI:t.startAngle,o=t.endAngle<Math.PI?Math.PI:t.endAngle,l=a*e*Math.cos(i),s=a*n*Math.sin(i),u=a*e*Math.cos(o),c=a*n*Math.sin(o),d=[];return d.push("M",l,s,"A",a*e,a*n,"0 0 1",u,c,"L",u,r+c,"A",a*e,a*n,"0 0 0",l,r+s,"z"),d.join(" ")}function i(t){return Math.round(u[t]/S*100)+h}function o(t){var e=d3.interpolate({startAngle:-180*M,endAngle:-180*M},t);return function(t){return a(e(t),L,_,N,D)}}function l(t){var e=d3.interpolate({startAngle:-180*M,endAngle:-180*M},t);return function(t){return n(e(t),L,_,D)}}function s(t){var e=d3.interpolate({startAngle:-180*M,endAngle:-180*M},t);return function(t){return r(e(t),L,_,N)}}for(var u=e.dountData,c=e.dountKey,d=e.colorArray,h=e.unit,y=e.factor,m={left:.1*g,right:.1*g,bottom:.15*v,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},x=g-m.left-m.right,b=v-m.top-m.bottom,k=p.append("g").attr("class","main-group").attr("transform","translate("+m.left+","+m.top+")"),A=k.append("g").attr("class","dountPie").attr("transform","translate("+x/2+","+b/2+")"),M=(t(f).offset().left,Math.PI/180),w=0,C=8,S=0,T=0;T<u.length;T++)S+=u[T];var L=x>b?b:x;L=.45*L;var _=.75*L,N=25,D=.75,F=d3.layout.pie().sort(null).value(function(t){return t});A.selectAll(".innerSlice").data(F(u)).enter().append("path").attr("class","innerSlice").style("fill",function(t,e){return d[e]}).attr("d",function(t){return a(t,L,_,N,D)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*w,n=Math.sin(t.midAngle)*w;return"translate("+e+","+n+")"}).transition().duration(1500).attrTween("d",o),A.selectAll(".topSlice").data(F(u)).enter().append("g").attr("class","topSlice").style("fill",function(t,e){return d[e]}).style("stroke",function(t,e){return d[e]}).append("path").attr("value",function(t,e){return e}).attr("d",function(t){return n(t,L,_,D)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*w,n=Math.sin(t.midAngle)*w;return"translate("+e+","+n+")"}).on("mouseover",function(){var t=d3.select(this).attr("value"),e=d3.select("#text"+t).attr("x");d3.select("#text"+t).attr("x",function(){return e>0?e-10+20:e-10}).style("font-weight",600)}).on("mouseout",function(){var t=d3.select(this).attr("value"),e=d3.select("#text"+t).attr("x");d3.select("#text"+t).attr("x",function(){return e>0?e-10:e-10+20}).style("font-weight","normal")}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=c[t],n=i(t),r=[{headingName:y,headingVal:n}];G.showToolTip(d3.event,"",e,!1,r,.96*d3.event.pageY)}).on("mouseleave",function(){G.hideTooTip()}).transition().duration(1500).attrTween("d",l),A.selectAll(".outerSlice").data(F(u)).enter().append("path").attr("class","outerSlice").style("fill",function(t,e){return d[e]}).attr("d",function(t){return r(t,L,_,N)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*w,n=Math.sin(t.midAngle)*w;return"translate("+e+","+n+")"}).transition().duration(1500).attrTween("d",s);for(var V,I,P=d3.svg.line().x(function(t,e){return z[e]}).y(function(t,e){return E[e]}),z=[],E=[],O=0,T=0;T<u.length;T++)V=u[T]/S*360,I=O,O+=V,I=(I+O)/2,z[0]=.98*L*Math.cos(I*(Math.PI/180)),E[0]=.98*_*Math.sin(I*(Math.PI/180)),z[1]=1.4*L*Math.cos(I*(Math.PI/180)),E[1]=1.4*_*Math.sin(I*(Math.PI/180)),z[2]=z[1]+.2*L*Math.cos(I*(Math.PI/180)),E[2]=E[1],A.selectAll(".path").data([z]).enter().append("path").attr("d",P).attr("stroke-width",1).attr("fill","none").attr("stroke",d[T]),A.append("text").attr("id",function(){return"text"+T}).attr("x",function(){return z[2]>0?z[2]:z[2]-(c[T].length+i(T).length+1)*C}).attr("y",E[2]+3).attr("fill",d[T]).text(function(){return i(T)+" "+c[T]})}},Te={roundedThreeDBarAnalysis:function(e){for(var n=e.barData,r=e.xAxisLabel,a=e.yAxisLabel,i=e.title,o=e.unit,l={left:.1*g,right:.1*g,bottom:.15*v,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},s=g-l.left-l.right,d=v-l.top-l.bottom,h=s/(1.5*n.length),y=7,x=[],b=[],k=0;k<n.length;k++)x[k]=k,b[k]=n[k].visits;var A=p.append("g").attr("class","main-group").attr("transform","translate("+l.left+","+l.top+")"),M=9,w=s/2-i.length*M/2,C=p.append("g").attr("class","title");B.appendLabel(i,w,l.top/2,0,C,m.chartTitleColor,800);var M=7,S=r.toString().length*M,T=d+.13*d,L=s/2-S/2;B.appendLabel(r,L,T,0,A,m.xLabelColor,600);var _=a.toString().length*M,N=d/2+_/2,D=-l.left/1.3;B.appendLabel(a,D,N,-90,A,m.yLabelColor,600);var F=d3.scale.linear().domain([0,n.length]).range([0,s]),V=d3.min(b),I=d3.max(b);0==I?I+=2:I=I>0?1.2*I:.8*I,0==V?V-=2:V=0>V?1.5*V:.1*V;var P=d3.scale.linear().domain([V,I]).range([d,0]),z=d3.svg.axis().scale(F).orient("bottom").tickValues(x),E=A.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+d+")").call(z);E.selectAll("text").text(function(t){return n[t].country});var O=d3.svg.axis().scale(P).orient("left").tickValues(Y.getTickArray(V,I,9));A.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("transform","translate("+-h/2+",0)").call(O).selectAll("text");var R=t(f).offset().left,q=A.selectAll(".rect").data(b).enter().append("rect").attr("width",h).attr("height",0).attr("x",function(t,e){return F(e)-h/2}).attr("y",d-y).attr("fill",function(t,e){return n[e].color}).attr("opacity",.6).on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=R+l.left,t=Math.round(F.invert(t));var e=n[t].country,r=b[t],i=[{headingName:a,headingVal:r+" "+o}];G.showToolTip(d3.event,"",e,!1,i,.96*d3.event.pageY)}).on("mouseleave",function(){G.hideTooTip()});q.transition().duration(1500).ease("bounce").attr("height",function(t){return P(V)-P(t)-2*y}).attr("y",function(t){return P(t)+y});var j=A.selectAll(".ellipse").data(b).enter().append("ellipse").attr("cx",function(t,e){return F(e)}).attr("cy",d-y).attr("rx",h/2).attr("ry",y).attr("fill",function(t,e){return n[e].color});j.transition().duration(1500).ease("bounce").attr("cy",function(t){return P(t)+y});A.selectAll(".ellipse").data(b).enter().append("ellipse").attr("cx",function(t,e){return F(e)}).attr("cy",d-y).attr("rx",h/2).attr("ry",y).attr("fill",function(t,e){return n[e].color});u(p),c(p)}},Le={arcWithCylinderChartAnalysis:function(e){function n(t){d3.select("#bar-main-group").remove();var e=p.append("g").attr("id","bar-main-group").attr("transform","translate("+l.left+","+l.top+")"),n=d3.scale.linear().domain([0,_.length]).range([.55*s,s]),r=d3.min(i[t].barData),o=d3.max(i[t].barData);0==o?o+=2:o=o>0?1.2*o:.8*o,0==r?r-=2:r=0>r?1.5*r:0*r;var u=d3.scale.linear().domain([r,o]).range([d,0]),c=d3.svg.axis().scale(n).orient("bottom").tickValues(_),f=e.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+d+")").call(c);f.selectAll("text").text(function(e){return i[t].label[e]}).attr("fill","#a7a7a7");var h=e.selectAll(".rect").data(i[t].barData).enter().append("rect").attr("class","cylinder"+t).attr("width",A).attr("height",0).attr("x",function(t,e){return n(e)-A/2}).attr("y",d-S).attr("fill",function(e,n){return a[i[t].label[n]]}).attr("opacity",.6);h.transition().duration(1500).ease("bounce").attr("height",function(t){return u(r)-u(t)-2*S}).attr("y",function(t){return u(t)+S});var g=e.selectAll(".ellipse").data(i[t].barData).enter().append("ellipse").attr("class","cylinder"+t).attr("cx",function(t,e){return n(e)}).attr("cy",d-S).attr("rx",A/2).attr("ry",S).attr("fill",function(e,n){return a[i[t].label[n]]});g.transition().duration(1500).ease("bounce").attr("cy",function(t){return u(t)+S});e.selectAll(".ellipse").data(i[t].barData).enter().append("ellipse").attr("class","cylinder"+t).attr("cx",function(t,e){return n(e)}).attr("cy",d-S).attr("rx",A/2).attr("ry",S).attr("fill",function(e,n){return a[i[t].label[n]]});d3.selectAll(".cylinder"+t).on("mousemove",function(){{var e=d3.event.pageX;d3.event.pageY}e-=L+l.left,e=Math.round(n.invert(e));var r=i[t].label[e],a=i[t].barData[e],o=[{headingName:i[t].key,headingVal:a}];G.showToolTip(d3.event,"",r,!1,o,.96*d3.event.pageY)}).on("mouseleave",function(){G.hideTooTip()});var y=(e.selectAll(".text").data(i[t].barData).enter().append("text").attr("x",function(t,e){return n(e)-7*t.toString().length/2}).attr("y",function(t){return u(t)+S-8}).text(function(t){return t}).attr("fill",m.yLabelColor),9),v=.7*s-i[t].key.toString().length*y/2;B.appendLabel(i[t].key,v,l.top/2,0,e,m.chartTitleColor,800)}function r(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}var a=e.color,i=e.subData,o=e.title,l={left:.1*g,right:.1*g,bottom:.1*v,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},s=g-l.left-l.right,d=v-l.top-l.bottom,h=p.append("g").attr("class","main-group").attr("transform","translate("+l.left+","+l.top+")"),y=9,x=s/1.7-o.length*y/2,b=p.append("g").attr("class","title");B.appendLabel(o,x,l.top/1.5,0,b,m.chartTitleColor,800);var k=h.append("g").attr("class","arc-main-group").attr("transform","translate("+(.5*s/2-.5*l.left)+","+d/2+")"),A=.45*s/(2*i[0].barData.length),M=.5*s>d?d:.5*s;M=.5*M;for(var w=.4*M,C=(M-w)/(2*i[0].barData.length),S=.2*A,T=Math.PI,L=(Math.PI/180,t(f).offset().left),_=[],N=0;N<i[0].barData.length;N++)_[N]=N;var D=(k.append("circle").attr("r",w).attr("fill","#454747").attr("opacity",.05).attr("stroke","#454747"),d3.svg.arc().innerRadius(w).outerRadius(M)),F=d3.layout.pie().sort(null).value(function(){return 1}),V=k.selectAll(".arc").data(F(i)).enter().append("g").attr("class","pie").attr("value",function(t,e){return e}).attr("startAngle",function(t,e){return e/i.length*360}).attr("endAngle",function(t,e){return(e+1)/i.length*360}).attr("fill",function(){return"#53565b"}).on("click",function(){d3.selectAll(".pie").attr("fill","#53565b").attr("opacity",1),d3.select(this).attr("fill","lightsteelblue").attr("opacity",.5);{var t=d3.select(this).attr("startAngle");d3.select(this).attr("endAngle")}t=360-t,d3.selectAll(".individualArc").transition().ease("bounce").duration(1500).attr("transform","rotate("+t+")"),d3.selectAll(".pie").attr("transform","rotate("+t+")");var e=d3.select(this).attr("value");n(e)}).on("mouseover",function(){}).on("mouseleave",function(){});V.append("path").attr("d",D);for(var I,P=(V.append("text").attr("class","keyOfArc").attr("id",function(t,e){return"text"+e}),M),z=0,E=0;E<i.length;E++){P=M,theta=1/i.length*360,sum=r(i[E].barData);for(var O=0;O<i[E].barData.length;O++){var R=i[E].barData[O]/sum*(360/i.length),Y=d3.svg.arc().innerRadius(P-C).outerRadius(P).startAngle(z*(T/180)).endAngle((R+z)*(T/180)),q=d3.svg.arc().innerRadius(P-C).outerRadius(P).startAngle(z*(T/180)).endAngle(z*(T/180)),j=k.append("path").attr("d",q).attr("class","individualArc").attr("fill",function(){return a[i[E].label[O]]}).attr("value",E+" "+O).on("mousemove",function(){var t=d3.select(this).attr("value"),e=t.split(" "),n=i[e[0]].label[e[1]],r=i[e[0]].barData[e[1]],a=[{headingName:i[e[0]].key,headingVal:r}];
G.showToolTip(d3.event,"",n,!1,a,.96*d3.event.pageY)}).on("mouseleave",function(){G.hideTooTip()});j.transition().ease("bounce").duration(1500).attr("d",Y);var U=(P-C)*Math.sin((R+z)*(Math.PI/180)),H=-(P-C)*Math.cos((R+z)*(Math.PI/180));V.append("text").attr("class","labelOfArc").attr("transform","translate("+U+","+H+")rotate("+(R+z)+")").style("font-size",1.3*C+"px","important").text(function(){return i[E].barData[O]}).attr("fill",m.yLabelColor),P-=2*C}I=z,z+=theta,I=(I+z)/2;var X=1.1*M*Math.sin(I*(Math.PI/180)),W=-1.1*M*Math.cos(I*(Math.PI/180));d3.select("#text"+E).attr("transform","translate("+X+","+W+")rotate("+I+")").text(i[E].key).attr("fill",m.yLabelColor)}n(0),u(p),c(p)}},_e={ThreeDComparisionAnalysis:function(e){var n,r=e.yAxisEstimateData,a=e.yAxisActualData,i=e.xAxisData,o=e.yAxisUnit,l=e.yAxisLabel,s=e.xAxisLabel,d=e.title,h=e.yAxisActualDataUnit,y=e.yAxisEstimateDataUnit,x=e.legendArray,b={left:.13*g,right:.05*g,bottom:.1*v,top:.2*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},k=g-b.left-b.right,A=v-b.top-b.bottom,M=t(f).offset().left,w=k/(1.8*i.length);n=w>60?.3*w:.4*w;for(var C=[],S=[],T=12,L="calibri",_=[],N=0;N<i.length;N++)_[N]=N;var D=p.append("g").attr("class","main-group").attr("transform","translate("+b.left+","+b.top+")"),F=9,V=k/2-d.length*F/2,I=p.append("g").attr("class","title");B.appendLabel(d,V,b.top/2,0,I,m.chartTitleColor,800);var F=7,P=l.toString().length*F,z=A/2+P/2,E=-b.left/1.3;B.appendLabel(l,E,z,-90,D,m.yLabelColor,600);var O=s.toString().length*F,q=A+.13*A,j=k/2-O/2;B.appendLabel(s,j,q,0,D,m.xLabelColor,600);var U=(parseInt(A/w),d3.scale.linear().domain([0,i.length]).range([0,k])),H=d3.min(d3.min(r)<d3.min(a)?r:a),X=d3.max(d3.max(r)>d3.max(a)?r:a);0==X?X+=2:X=X>0?1.2*X:.8*X,0==H?H-=2:H=0>H?1.5*H:0*H;var W=d3.scale.linear().domain([H,X]).range([A,0]),$=d3.svg.axis().scale(U).orient("bottom"),J=D.append("g").attr("id","xAxis").attr("class","xAxis").attr("fill","none").attr("transform","translate(0,"+A+")").call($);J.selectAll("text").text(function(t){return i[t]}).style("font-size",T).attr("font-family",L).attr("fill","black");var Z=Y.getTickArray(H,X,8),K=d3.svg.axis().scale(W).orient("left").tickValues(Z);D.append("g").attr("id","yAxis").attr("class","yAxis").attr("fill","none").attr("transform","translate("+-w/1.3+",0)").call(K).selectAll("text").style("font-size",T).style("font-family",L).attr("fill","black");for(var Q,te=d3.svg.line().x(function(t,e){return C[e]}).y(function(t,e){return S[e]}),ee=d3.svg.line().x(function(t){return t}).y(function(){return A}),ne=0;ne<Z.length;ne++){C[0]=-2*n,S[0]=W(Z[ne]),C[1]=0,S[1]=W(Z[ne])-n,C[2]=k,S[2]=S[1],Q=D.selectAll(".path").data([C]).enter().append("path").attr("d",te).attr("fill","none").attr("stroke","gray");var re=Q.node().getTotalLength();Q.attr("stroke-dasharray",function(){return re+","+re}).attr("stroke-dashoffset",re).transition().duration(1500).ease("linear").attr("stroke-dashoffset",0)}for(var N=0;N<r.length;N++)C[0]=U(N)-.55*w,S[0]=W(H)-n,C[1]=C[0],S[1]=W(r[N])+n,C[2]=C[1]+w,S[2]=S[1],C[3]=C[2],S[3]=S[0],Q=D.selectAll(".path").data([C]).enter().append("path").attr("class","pathClass").attr("d",ee).attr("fill","#f6cd03"),Q.transition().duration(2e3).ease("elastic").attr("d",te),C[0]=U(N)-.55*w,S[0]=W(r[N])+n,C[1]=C[0]+.25*w,S[1]=S[0]-n,C[2]=C[1]+w,S[2]=S[1],C[3]=C[0]+w,S[3]=S[0],Q=D.selectAll(".path").data([C]).enter().append("path").attr("d",ee).attr("class","pathClass").attr("fill","#f9f303"),Q.transition().duration(2e3).ease("elastic").attr("d",te),C[0]=C[3],S[0]=W(H)-n,C[1]=C[3]+.25*w,S[1]=W(H)-2*n,Q=D.selectAll(".path").data([C]).enter().append("path").attr("class","pathClass").attr("d",ee).attr("fill","#c9a703"),Q.transition().duration(2e3).ease("elastic").attr("d",te);for(var N=0;N<a.length;N++)C[0]=U(N)-.8*w,S[0]=W(a[N])+n,C[1]=C[0]+.25*w,S[1]=S[0]-n,C[2]=C[1]+w,S[2]=S[1],C[3]=C[0]+w,S[3]=S[0],Q=D.selectAll(".path").data([C]).enter().append("path").attr("class","pathClass").attr("d",ee).attr("fill","#fa7600"),Q.transition().duration(2e3).ease("elastic").attr("d",te),C[0]=C[3],S[0]=W(H),C[1]=C[3]+.25*w,S[1]=W(H)-n,Q=D.selectAll(".path").data([C]).enter().append("path").attr("class","pathClass").attr("d",ee).attr("fill","#cc5200"),Q.transition().duration(2e3).ease("elastic").attr("d",te),C[0]=U(N)-.8*w,S[0]=W(H),C[1]=C[0],S[1]=W(a[N])+n,C[2]=C[1]+w,S[2]=S[1],C[3]=C[2],S[3]=S[0],Q=D.selectAll(".path").data([C]).enter().append("path").attr("class","pathClass").attr("d",ee).attr("fill","#fa6400"),Q.transition().duration(2e3).ease("elastic").attr("d",te);d3.selectAll(".pathClass").on("mousemove",function(){{var t=event.pageX;event.pageY}t-=M+b.left,t=Math.round(U.invert(t));var e=i[t],n=r[t]+" "+o,s=a[t]+" "+o,u=[{headingName:y+" "+l,headingVal:n},{headingName:h+" "+l,headingVal:s}];G.showToolTip(d3.event,"",e,!1,u,.9*d3.event.pageY)}).on("mouseleave",function(){G.hideTooTip()});{var ae=10,ie=-5,oe=R.showHorizontalLegend(k,ie,x,ae),le=p.append("g").attr("class","legend").attr("transform","translate("+b.left+","+b.top+")");le.selectAll(".rect").data(oe).enter().append("rect").attr("width",ae).attr("height",ae).attr("x",function(t,e){return oe[e].x}).attr("y",function(t,e){return oe[e].y}).attr("fill",function(t,e){return 0==e?"#f6cd03":"#fa6400"}),le.selectAll(".text").data(oe).enter().append("text").attr("x",function(t,e){return oe[e].textXPos}).attr("y",function(t,e){return oe[e].y+ae}).style("font-family","calibri").text(function(t,e){return x[e]})}u(p),c(p)}},Ne={detailAnalysis:function(e){for(var n=e.data.leftYAxisData,r=e.data.rightYAxisData,a=e.data.xAxisData,i=e.data.topYSymbolArray,o=e.data.bottomYSymbolArray,l=e.data.title,s=(e.data.titleColor,e.data.titleSize,e.data.rightYAxisLabel),d=e.data.leftYAxisLabel,h=e.data.xAxisLabel,y=e.data.leftYAxisColor,x=e.data.rightYAxisColor,b={left:.1*g,right:.1*g,bottom:.13*v,top:.1*v,chartSeparator:5,xScalePaddingTop:.2*v,yScalePaddingLeft:.1*g},k=g-b.left-b.right,A=v-b.top-b.bottom,M=e.data.imageFolderPath,w=e.data.bottomYSymbolLabel,C=e.data.leftYAxisUnit,S=e.data.rightYAxisUnit,T=[],L=0;L<a.length;L++)T[L]=L;U.init(p,A,k,b.left,b.top);var _=t(f).offset().left,N=p.append("g").attr("class","scoredMainGroup").attr("transform","translate("+b.left+","+b.top+")").on("mouseover",function(){var t=d3.event.pageX,e=d3.event.pageY;console.log("x = "+t+" y = "+e),t-=_+b.left,t=Math.round(J.invert(t)),console.log("x = "+t+" y = "+e);var a=o[t],l=i[t],s=C,u=n[t],c=S,d=r[t],f=[{headingName:w,headingVal:a},{headingName:s,headingVal:u},{headingName:c,headingVal:d}];G.showToolTip(d3.event,"",l,!1,f)}).on("mouseleave",function(){G.hideTooTip()}),D=9,F=k/2-l.length*D/2,V=p.append("g").attr("class","title");B.appendLabel(l,F,b.top,0,V,m.chartTitleColor,800);var D=6,I=s.toString().length*D,P=A/2-I/2,z=k+.01*k;B.appendLabel(s,z,P,90,N,m.yLabelColor,600);var I=d.toString().length*D,E=A/2+I/2,O=-b.yScalePaddingLeft/2;B.appendLabel(d,O,E,-90,N,m.yLabelColor,600);var R=h.toString().length*D,q=A+.13*A,j=k/2-R/2;B.appendLabel(h,j,q,0,N,m.xLabelColor,600);for(var H=d3.scale.linear().domain([.7*d3.min(n),1.5*d3.max(n)]).range([A,0]),X=d3.svg.axis().scale(H).orient("left"),W=(N.append("g").attr("class","y axis").attr("transform","translate(0,0)").attr("fill","none").call(X).selectAll("text").style("fill",y,"important"),d3.scale.linear().domain([.8*d3.min(r),1.1*d3.max(r)]).range([A,0])),$=d3.svg.axis().scale(W).orient("left"),T=(N.append("g").attr("class","y axis").attr("transform","translate("+k+",0)").attr("fill","none").call($).selectAll("text").style("fill",x,"important"),[]),L=0;L<a.length;L++)T[L]=L;for(var J=d3.scale.linear().domain([0,a.length-1]).range([0,.9*k]),Z=0,L=0;L<a.length;L++)Z<a[L].toString().length&&(Z=a[L].toString().length);var K=d3.svg.axis().scale(J).orient("bottom").tickValues(Y.getXTickArray(0,a.length,Z,k)),Q=(N.append("g").attr("class","x axis").attr("transform","translate(0,"+A+")").attr("fill","none").call(K).selectAll("text").text(function(t){return a[t]}).attr("fill","black"),k/(2*o.length)),te=N.selectAll("img").data(o).enter().append("image").attr("x",function(){return 0}).attr("y",function(){return A-Q}).attr("width",Q).attr("height",Q).attr("xlink:href",function(t){return M+""+t+".png"});te.transition().duration(2500).attr("x",function(t,e){return J(T[e])-Q/2});var ee=d3.svg.line().x(function(t,e){return J(T[e])}).y(function(t,e){return W(r[e])}).interpolate("cardinal"),ne=k/(2*i.length),re=N.selectAll(".path").data([r]).enter().append("path").attr("d",ee).attr("stroke",x).attr("stroke-width",1).attr("fill","none"),ae=re.node().getTotalLength();re.attr("stroke-dasharray",function(){return ae+","+ae}).attr("stroke-dashoffset",ae).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0);var ie=N.selectAll("img").data(i).enter().append("image").attr("x",function(){return 0}).attr("y",function(){return 0}).attr("width",ne).attr("height",ne).attr("xlink:href",function(t){return M+""+t+".png"});ie.transition().duration(2500).attr("x",function(t,e){return J(T[e])-ne/2}).attr("y",function(t,e){return W(r[e])-(ne+5)});var oe=d3.svg.line().x(function(t,e){return J(T[e])}).y(function(t,e){return H(n[e])}).interpolate("cardinal"),le=N.selectAll(".path").data([n]).enter().append("path").attr("d",oe).attr("stroke",y).attr("stroke-width",1).attr("fill","none"),se=le.node().getTotalLength();le.attr("stroke-dasharray",function(){for(var t=3,e=2*t,n=t;se>e;)n+=","+t+","+t,e+=2*t;return n+","+se}).attr("stroke-dashoffset",se).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0),u(p),c(p)}},De={threeDBubbleChart:function(t){function e(t){for(var e=0;e<t.length;e++){for(var n=[],r=0;r<t[e].data.length;r++){var a=t[e].data[r];n.push(JSON.parse('{"x":'+a[0]+',"y":'+a[1]+',"r":'+a[2]+"}"))}y.push(n)}return y}function n(t){var e=V(t);return.008*f>e&&(e=.008*f),e>.04*f&&(e=.04*f),e}function r(){return d3.svg.axis().scale(I).orient("bottom").ticks(10)}function a(){return d3.svg.axis().scale(P).orient("left").ticks(10)}var i=t.data.title,o=(t.data.titleColor,t.data.yAxisData,t.data.yAxisLabel),l=(t.data.xAxisData,t.data.xAxisLabel),s=t.data.series,d=t.data.legendArray;501>g?(titleFontSize=18,gridFactor=8,fontSize=11,rectangleSize=9,rectangleTextSize=9):(titleFontSize=20,gridFactor=12,fontSize=14,rectangleSize=10,rectangleTextSize=10);for(var f=v>g?g:v,h={top:.15*v,right:.15*g,bottom:.15*v,left:.15*g},y=[],x=e(s),b=d3.min(x[0],function(t){return t.x}),k=d3.max(x[0],function(t){return t.x}),A=d3.min(x[0],function(t){return t.y}),M=d3.max(x[0],function(t){return t.y}),w=d3.max(x[0],function(t){return t.r}),C=d3.min(x[0],function(t){return t.r}),S=0,T=0,L=0,_=0,N=0,D=0,F=1;F<x.length;F++)S=d3.max(x[F],function(t){return t.r}),T=d3.min(x[F],function(t){return t.r}),_=d3.max(x[F],function(t){return t.x}),L=d3.min(x[F],function(t){return t.x}),D=d3.max(x[F],function(t){return t.y}),N=d3.min(x[F],function(t){return t.y}),S>w&&(w=S),C>T&&(C=T),_>k&&(k=_),b>L&&(b=L),D>M&&(M=D),A>N&&(A=N);var V=d3.scale.linear().domain([0,w]).range([0,.1*f]),I=d3.scale.linear().range([h.left,g-h.right]).domain([0,1.1*k]),P=d3.scale.linear().range([v-h.top,h.bottom]).domain([A,1.2*M]),z=d3.svg.axis().scale(I).orient("bottom"),E=d3.svg.axis().scale(P).orient("left"),O=p.append("g").attr("class","bubble-main-group").attr("transform","translate(0,0)"),Y=9,q=g/2-i.length*Y/2,j=p.append("g").attr("class","title");B.appendLabel(i,q,h.top/2,0,j,m.chartTitleColor,800);var Y=6,U=l.toString().length*Y,H=v-h.top+.13*(v-h.top),X=(g-h.right)/2-U/2;B.appendLabel(l,X,H,0,O,m.xLabelColor,600);var W=o.toString().length*Y,$=v/2+W/2,J=h.left/2;B.appendLabel(o,J,$,-90,O,m.yLabelColor,600);for(var Z=t.data.colorArray,K=0;K<x.length;K++){O.selectAll("circle.s"+K).data(x[K]).enter().insert("circle").attr("cx",function(t){return I(t.x)}).attr("cy",function(t){return P(t.y)}).attr("r",function(t){return n(t.r)}).on("mouseover",function(t){var e=[{headingName:o,headingVal:t.y}];G.showToolTip(d3.event,"",l+" "+t.x,!1,e)}).on("mouseleave",function(){G.hideTooTip()}).transition().duration(1e3).attr("opacity",.3).attr("class","s"+K).attr("fill",function(){return"url(#gradient"+K+")"});var Q=O.append("svg:defs").append("svg:linearGradient").attr("id","gradient"+K).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad");Q.append("svg:stop").attr("offset","0%").attr("stop-color",Z[K]).attr("stop-opacity",1),Q.append("svg:stop").attr("offset","100%").attr("stop-color",Z[K]+1e3).attr("stop-opacity",1)}O.append("g").attr("class","xGrid").attr("transform","translate(0,"+(g-h.bottom)+")").call(r().tickSize(-g+h.bottom,0,0).tickFormat("")).attr("opacity","0.3"),O.append("g").attr("class","yGrid").attr("transform","translate("+h.left+",0)").call(a().tickSize(-v+2*h.bottom,0,0).tickFormat("")).attr("opacity","0.3"),O.append("svg:g").attr("class","xAxis axis").transition().call(z).attr("transform","translate(0,"+(f-.9*h.bottom)+")").attr("fill","black"),O.append("svg:g").attr("class","yAxis axis").transition().call(E).attr("transform","translate("+.9*h.left+",0)").attr("fill","black"),p.selectAll(".yAxis path").attr("fill","none"),p.selectAll(".xAxis path").attr("fill","none"),p.selectAll(".xGrid").attr("stroke","lightgrey"),p.selectAll(".yGrid").attr("stroke","lightgrey"),p.selectAll(".xGrid ").attr("opacity",.5),p.selectAll(".yGrid ").attr("opacity",.5),p.selectAll(".xGrid .tick").attr("stroke-width",0),p.selectAll(".yGrid .tick").attr("stroke-width",0);for(var te=v-h.top,ee=g-h.right,ne=O.append("g").attr("class","legend").attr("transform","translate("+.9*h.left+","+.13*te+")"),re=12,ae=12,ie=R.getLegendPositionArray(d,ee,te),oe=0;oe<ie.length;oe++)console.log("x "+ie[oe].x+" y "+ie[oe].y+" end "+ie[oe].endPos);ne.selectAll("rect.legendRect").data(d).enter().append("rect").attr("class","legendRect").attr("x",function(t,e){return ie[e].x}).attr("y",function(t,e){return ie[e].y}).attr("width",re).attr("height",ae).style("fill",function(t,e){return"url(#gradient"+e+")"}).attr("opacity",.3),newXCord=0,ne.selectAll("text").data(d).enter().append("text").attr("x",function(t,e){return ie[e].textPos}).attr("y",function(t,e){return ie[e].y+ae}).attr("width",re).attr("height",ae).attr("font-size",12).text(function(t){return t}),u(p),c(p)}};return{drawLine:H.drawLine,drawBarWithMultipleLineAndCircle:H.drawBarWithMultipleLineAndCircle,squareChart:$.squareChart,areaChart:fe.areaChart,circleChart:J.circleChart,pieChart:Z.pieChart,gaugeGraph:ce.gaugeGraph,drawYAxis:E.drawYAxis,drawMulitpleLineChartWithSquare:E.drawMulitpleLineChartWithSquare,setYSclae:W.setYSclae,drawPyramidChart:K.drawPyramidChart,draw3DPyramidChartWithoutSlice:K.draw3DPyramidChartWithoutSlice,draw3DPyramidSliceChart:K.draw3DPyramidSliceChart,drawRadarChart:Q.drawRadarChart,drawDrillDownChart:ee.drawDrillDownChart,drawPieChartWithTransition:re.drawPieChartWithTransition,dountChartWithLegend:re.dountChartWithLegend,drawDountWithBarChart:re.drawDountWithBarChart,multipleDountChartAnalysis:re.multipleDountChartAnalysis,drawHeatMapChart:ae.drawHeatMapChart,groupedBarChart:W.groupedBarChart,groupedBar2DChart:W.groupedBar2DChart,bulletBar:W.bulletBar,cricketAnalysis:W.cricketAnalysis,barWithLogo:W.barWithLogo,drawScatterPlotChart:ie.drawScatterPlotChart,drawBasicLineChart:le.drawBasicLineChart,drawThreeDBarChart:oe.drawThreeDBarChart,drawStackedAreaChart:se.drawStackedAreaChart,stackedBarChart:W.stackedBarChart,drawFunnelChart:ue.drawFunnelChart,areaChart:fe.areaChart,meterChart:he.meterChart,turnNeedle:he.turnNeedle,drawCombinationalChart:te.drawCombinationalChart,drawThreeDStackedBarChart:pe.drawThreeDStackedBarChart,variationAnalysis:ne.variationAnalysis,areaChartWithNegativeValueAnalysis:ve.areaChartWithNegativeValueAnalysis,areaChartWithVaryColorAnalysis:me.areaChartWithVaryColorAnalysis,musicSpikesAnalysis:be.musicSpikesAnalysis,comparisonAnalysis:xe.comparisonAnalysis,drawThreeDGroupedBarChart:ke.drawThreeDGroupedBarChart,globChartAnalysis:ge.globChartAnalysis,detailAnalysis:Ne.detailAnalysis,threeDBubbleChart:De.threeDBubbleChart,treeChart:ye.treeChart,barWithLabelAnalysis:Ae.barWithLabelAnalysis,logoChart:Me.logoChart,multiAxisChartAnalysis:we.multiAxisChartAnalysis,roundedThreeDBarAnalysis:Te.roundedThreeDBarAnalysis,threeDDountChartAnalysis:Se.threeDDountChartAnalysis,threeDPieChartAnalysis:Ce.threeDPieChartAnalysis,arcWithCylinderChartAnalysis:Le.arcWithCylinderChartAnalysis,ThreeDComparisionAnalysis:_e.ThreeDComparisionAnalysis}}}(jQuery);var meterChart={image:"",needle:"",plot:"",arc:"",prevdata:90,text:"",init:function(t){var e=d3.select("#"+t).style("width"),n=d3.select("#"+t).style("height");e=parseInt(e.replace("px","")),n=parseInt(n.replace("px",""));var r=d3.select("#"+t).append("svg").attr("width",e).attr("height",n).append("g").attr("transform","translate("+e/4+",0)");this.arc=d3.svg.arc().innerRadius(30).outerRadius(120).startAngle(120*(Math.PI/180)).endAngle(240*(Math.PI/180));r.append("g").attr("class","arc");this.image=r.append("svg:image").attr("x",20).attr("y",0).attr("width",280).attr("height",250).attr("xlink:href","http://stocinn.github.io/stocweb/img/gauge_skin.jpg").attr("id","fillImage"),this.text=r.append("svg:text").attr("transform","translate(165,220)").attr("text-anchor","middle").text(""),this.needle=r.append("g").attr("class","needle").attr("transform","translate( 20 , 70)").append("path").attr("class","tri").attr("d","M152 130 L150 0 L147 130 C147 140 153 140 153 130 Z").attr("transform","rotate(-90, 150,130)")},turnNeedle:function(t){function e(){return d3.interpolateString("rotate("+n+", 150, 130)","rotate("+r+", 150, 130)")}0>t?meterChart.text.transition().attr("fill","red").text(t):meterChart.text.transition().attr("fill","green").text(t),this.needle.transition().duration(1e3).attrTween("transform",e);var n=this.getAngleFromCoordinate(meterChart.getCoordinateFromData(meterChart.prevdata)),r=this.getAngleFromCoordinate(meterChart.getCoordinateFromData(meterChart.getPercentFromAngle(meterChart.getAngleForProfitAndLoss(t))))},getPercentFromAngle:function(t){return 0>t&&t>=-180?-(5*t/9):5*t/9},getAngleFromCoordinate:function(t){var e=0,n=90;return e+=n*t},getCoordinateFromData:function(t){return coordinate=t/100-(1-t/100)},getRadianFromData:function(t){return coordinate=t/57.2958},callTurnNeedle:function(){var t=100*Math.random();meterChart.turnNeedle(t),meterChart.prevdata=t},getAngleForProfitAndLoss:function(t){var e;return e=t>0&&100>=t?90+.9*t:90+.9*t}};StockMarketChartManager={xScaleHistoricChart:"",data:"",cmfConfigurations:"",lineChartConfiguration:"",powerGauageChartConfiguration:"",selectorContainerId:"",chartHeightMap:{},margin:{top:10,left:20,right:20,bottom:10},scalableLimit:2,areaSubsetArray:[],area:"",textLabelDx:50,dateArray:[],chartStyleMap:{hlcChart:"block",cmfChart:"block",powerGaugeChart:"block"},drawStockMarketCharts:function(t,e,n,r,a,i){StockMarketChartManager.selectorContainerId=t,StockMarketChartManager.emptyCharts(),StockMarketChartManager.getHeightOfEachChart(),StockMarketChartManager.cmfConfigurations=n,StockMarketChartManager.lineChartConfiguration=r,StockMarketChartManager.powerGauageChartConfiguration=a,StockMarketChartManager.data=e,StockMarketChartManager.dateArray=i,StockMarketChartManager.drawHLCChart(r),StockMarketChartManager.drawCmfChart(n),StockMarketChartManager.drawPowerGauageChart(a),StockMarketChartManager.drawTimeScale(i),StockMarketChartManager.attachHoveringEffect(),StockMarketChartManager.listenWindowResize(),StockMarketChartManager.appendToolTip()},listenWindowResize:function(){$(window).resize(function(){StockMarketChartManager.updateChartOnResize()})},attachHoveringEffect:function(){var t=StockMarketChartManager.selectorContainerId,e=StockMarketChartManager.margin,n=StockMarketChartManager.dateArray,r=StockMarketChartManager.lineChartConfiguration.data,a=StockMarketChartManager.cmfConfigurations.data,i=StockMarketChartManager.powerGauageChartConfiguration.data,o=StockMarketChartManager.lineChartConfiguration.highFieldName,l=StockMarketChartManager.lineChartConfiguration.closeFieldName,s=StockMarketChartManager.lineChartConfiguration.lowFieldName,u=StockMarketChartManager.cmfConfigurations.fieldName,c=StockMarketChartManager.powerGauageChartConfiguration.pgrFieldName;d3.select("#"+t).on("mousemove",function(){console.log("mousemove ");var d=StockMarketChartManager.xScaleHistoricChart,f=(e.left-.08*e.left,d3.event.pageX-$("#"+t).offset().left),h=Math.round(d.invert(f));if(0>h||h>n.length-1)d3.select("#"+t).selectAll(".drag-line").style("display","none"),StockMarketChartManager.hideToolTip();else{d3.select("#"+t).selectAll(".drag-line").attr("x1",d(h)).attr("x2",d(h));var p=r[h][o],g=r[h][l],y=r[h][s],v=a[h][u],m=i[h][c];console.log(p+" :: ::"+g+" :: "+y+":: "+v+" :: "+m+" :: "+n[h]);var x=[{headingName:l,headingVal:g},{headingName:o,headingVal:p},{headingName:s,headingVal:y},{headingName:u,headingVal:v},{headingName:c,headingVal:m}];StockMarketChartManager.showToolTip(d3.event,"",n[h],!1,x,""),d3.select("#"+t).selectAll(".drag-line").style("display","block")}}).on("mouseleave",function(){StockMarketChartManager.hideToolTip(),d3.select("#"+t).selectAll(".drag-line").style("display","none")})},updateChartOnResize:function(){var t=StockMarketChartManager.cmfConfigurations,e=StockMarketChartManager.lineChartConfiguration,n=StockMarketChartManager.powerGauageChartConfiguration;StockMarketChartManager.emptyCharts();var r=StockMarketChartManager.chartStyleMap.hlcChart,a=StockMarketChartManager.chartStyleMap.cmfChart,i=StockMarketChartManager.chartStyleMap.powerGaugeChart;StockMarketChartManager.getHeightOfEachChart(),"block"==r&&StockMarketChartManager.drawHLCChart(e),"block"==a&&StockMarketChartManager.drawCmfChart(t),"block"==i&&StockMarketChartManager.drawPowerGauageChart(n);var o=StockMarketChartManager.dateArray;StockMarketChartManager.drawTimeScale(o)},updateChartWithData:function(t){var e=StockMarketChartManager.selectorContainerId,n=StockMarketChartManager.cmfConfigurations,r=StockMarketChartManager.lineChartConfiguration,a=StockMarketChartManager.powerGauageChartConfiguration;StockMarketChartManager.drawStockMarketCharts(e,t,n,r,a)},hideChart:function(t){var e=(StockMarketChartManager.selectorContainerId,StockMarketChartManager.cmfConfigurations),n=StockMarketChartManager.lineChartConfiguration,r=StockMarketChartManager.powerGauageChartConfiguration;StockMarketChartManager.emptyCharts(),StockMarketChartManager.chartStyleMap[t]="none";var a=StockMarketChartManager.chartStyleMap.hlcChart,i=StockMarketChartManager.chartStyleMap.cmfChart,o=StockMarketChartManager.chartStyleMap.powerGaugeChart;StockMarketChartManager.getHeightOfEachChart(),"block"==a&&StockMarketChartManager.drawHLCChart(n),"block"==i&&StockMarketChartManager.drawCmfChart(e),"block"==o&&StockMarketChartManager.drawPowerGauageChart(r);var l=StockMarketChartManager.dateArray;StockMarketChartManager.drawTimeScale(l)},showChart:function(t){StockMarketChartManager.selectorContainerId;StockMarketChartManager.chartStyleMap[t]="block";var e=StockMarketChartManager.chartStyleMap.hlcChart,n=StockMarketChartManager.chartStyleMap.cmfChart,r=StockMarketChartManager.chartStyleMap.powerGaugeChart,a=StockMarketChartManager.cmfConfigurations,i=StockMarketChartManager.lineChartConfiguration,o=StockMarketChartManager.powerGauageChartConfiguration;StockMarketChartManager.emptyCharts(),StockMarketChartManager.getHeightOfEachChart(),"block"==e&&StockMarketChartManager.drawHLCChart(i),"block"==n&&StockMarketChartManager.drawCmfChart(a),"block"==r&&StockMarketChartManager.drawPowerGauageChart(o);var l=StockMarketChartManager.dateArray;StockMarketChartManager.drawTimeScale(l)},attachPanningAndZooming:function(t,e){function n(){var t=r.translate(),e=t[0],n=t[1];e=Math.min(e,0),e=Math.max(e,i-a*i),r.translate([e,n]);d3.selectAll(".money-flow-area ").data([StockMarketChartManager.areaSubsetArray]).attr("d",function(t){return StockMarketChartManager.area(t)})}var r=d3.behavior.zoom().x(t).scaleExtent([1,8]).on("zoom",n);d3.select("#"+e).call(r);var a=StockMarketChartManager.scalableLimit,i=d3.select("#"+e).style("width").replace("px","")},emptyCharts:function(){var t=StockMarketChartManager.selectorContainerId;document.getElementById(""+t).innerHTML=""},getHeightOfEachChart:function(){var t=StockMarketChartManager.selectorContainerId,e=d3.select("#"+t).style("height");e=parseInt(e.replace("px",""));var n={cmf:"",hlc:"",powergauage:""},r=StockMarketChartManager.chartStyleMap.cmfChart,a=StockMarketChartManager.chartStyleMap.hlcChart,i=StockMarketChartManager.chartStyleMap.powerGaugeChart,o=e/2,l=e;"block"==i&&(l-=o/3),"block"==r&&(l-=o/1.5);var s=e;"block"==i&&(s-=o/3),"block"==a&&(s-=o);var u=o/6;n.cmf=s,n.hlc=l,n.powergauage=u,StockMarketChartManager.chartHeightMap=n},generateXScale:function(){var t=d3.min(dateArray.map(function(t){return parseDate.parse(t)})),e=d3.max(dateArray.map(function(t){return parseDate.parse(t)}));xScaleHistoricChart=d3.time.scale().range([0,historicalChartWidth*scalableLimit]).domain([t,e])},drawCmfChart:function(t){function e(t){return t>x?1:x>t?-1:0}var n=StockMarketChartManager.selectorContainerId,r=StockMarketChartManager.margin,a=(StockMarketChartManager.scalableLimit,t.data),i=t.fieldName,o=StockMarketChartManager.chartHeightMap,l=d3.select("#"+n).style("width"),s=o.cmf;l=parseInt(l.replace("px",""));var u=l-r.left-r.right,c=s-r.top-r.bottom,d=d3.select("#"+n).append("svg:svg").attr("class","cmfChart").attr("id","cmfChart").attr("width",l).attr("height",s),f=(d.append("defs").append("svg:clipPath").attr("id","clip1").append("svg:rect").attr("id","clip-rect").attr("x","0").attr("y","0").attr("width",l).attr("height",s),d.append("g").attr("clip-path","url(#clip1)"));if(void 0!=a&&0!=a.length){for(var h=0;h<a.length;h++){var p=a[h];for(var g in p)(isNaN(p[g])||null==p[g])&&(p[g]="N/A");a[h]=p}for(var y=new Array,h=0;h<a.length;h++)"N/A"!=a[h][i]&&y.push(a[h][i]);y.sort(function(t,e){return t>e?1:e>t?-1:0});var v=y[0],m=y[y.length-1],x=0,b=d3.scale.linear().domain([v,m]).range([c-r.bottom,r.top]),k=d3.scale.linear().domain([d3.min(a.map(function(t){return t.timeIndex})),d3.max(a.map(function(t){return t.timeIndex}))]).range([r.left,u]);StockMarketChartManager.xScaleHistoricChart=k;var A=StockMarketChartManager.textLabelDx;f.append("line").attr("class","divider").attr("x1",k(a[0].timeIndex)).attr("y1",b(x)).attr("x2",k(a[a.length-1].timeIndex)).attr("y2",b(x)),f.append("text").attr("class","yrule").attr("x",u-r.right+A).attr("y",b(x)).attr("dy",0).attr("dx","-1.2em").attr("text-anchor","end").text(parseFloat(x).toFixed(2)).style("color","#FFFFFF").attr("fill","white");var M=[0];$(a).each(function(t,n){t>0&&(isNaN(a[t-1][i])||isNaN(n[i])?M.push(t):e(a[t-1][i])!=e(n[i])&&0!=n[i]&&M.push(t))}),M.push(a.length-1);var w,C=a[0][i]>x;$(M).each(function(t,e){var n;if(t!=M.length-1){var r=M[t+1];n=a.slice(e,r),void 0!=w&&n.unshift({timeIndex:w,MoneyFlow:x}),w=Math.round((a[r-1].timeIndex+a[r].timeIndex)/2);var o;o=r!=e&&r!=a.length-1?x:"N/A"==a[r][i]?x:a[r][i],n.push({timeIndex:r+1<=a.length-1?w:a[a.length-1].timeIndex+1,MoneyFlow:o}),a[a.length-1][i]>0&&a[a.length-2][i]<0&&r==a.length-1&&r!=e?(n.splice(-1,1),n.push({timeIndex:r+1<=a.length-1?w:a[a.length-1].timeIndex+1,MoneyFlow:x})):a[a.length-1][i]<0&&a[a.length-2][i]>0&&r==a.length-1&&r!=e?(n.splice(-1,1),n.push({timeIndex:r+1<=a.length-1?w:a[a.length-1].timeIndex+1,MoneyFlow:x})):r!=e&&r==a.length-1&&n.push({timeIndex:r+1<=a.length-1?w:a[a.length-1].timeIndex+1,MoneyFlow:x}),C="N/A"==a[e].cmfFieldName?a[r][i]>=x:a[e][i]>=x;var l=d3.svg.area().x(function(t){return k(t.timeIndex)}).y0(b(x)).y1(function(t){return"N/A"!=t[i]?b(void 0!=t[i]?t[i]:x):(console.log("0 "+b(x)),b(x))}).interpolate("basis");$(n).each(function(t,e){void 0===e[i]&&(e[i]="N/A"),StockMarketChartManager.areaSubsetArray.push(e)}),f.append("path").datum(n).attr("class","money-flow-area "+(C?"positive":"negative")).attr("fill",function(){return C?"green":"red"}).attr("d",l(n))}}),d.append("line").attr("x1",5).attr("x2",5).attr("y1",0).attr("y2",s).attr("class","drag-line").style("display","none").style("stroke","#FFFFFF").style("stroke-width","2px")}},drawHLCChart:function(t){for(var e=StockMarketChartManager.selectorContainerId,n=StockMarketChartManager.margin,r=(StockMarketChartManager.scalableLimit,t.data),a=t.highFieldName,i=t.closeFieldName,o=t.lowFieldName,l=t.HighBand,s=t.LowBand,u=t.Band,c=t.Trend,d=StockMarketChartManager.chartHeightMap,f=0;f<r.length;f++){var h=r[f];for(var p in h)(isNaN(h[p])||null==h[p])&&(h[p]="N/A");r[f]=h}var g=d3.select("#"+e).style("width"),y=d.hlc;g=parseInt(g.replace("px",""));var v=g-n.left-n.right,m=y-n.top-n.bottom,x=d3.select("#"+e).append("svg:svg").attr("class","hlcChart").attr("id","hlcChart").attr("width",g).attr("height",y),b=getMinRange(r),k=getMaxRange(r),A=d3.scale.linear().domain([b,k]).range([m-n.bottom,n.top]),M=d3.scale.linear().domain([d3.min(r.map(function(t){return t.timeIndex})),d3.max(r.map(function(t){return t.timeIndex}))]).range([n.left,v]);StockMarketChartManager.xScaleHistoricChart=M;var w=StockMarketChartManager.textLabelDx;x.selectAll("text.yrule").data(A.ticks(10)).enter().append("svg:text").attr("class","yrule").attr("x",v-n.right+w).attr("y",A).attr("dy",0).attr("dx",0).attr("text-anchor","end").style("color","#FFFFFF").style("font-size","12px").attr("fill","#FFFFFF").append("tspan").text(function(t){return new Number(t).toFixed(2)+""}),x.selectAll("line.close").data(r).enter().append("svg:line").attr("class","close").attr("x1",function(t){return M(t.timeIndex)+.25*v/r.length-.5}).attr("y1",function(t){return"N/A"!=t[i]?A(t[i]):($(this).select("line.close").attr("class","NA"),A(0))}).attr("x2",function(t){return M(t.timeIndex)+.25*(v-(n.left+n.right))/r.length+2}).attr("y2",function(t){return"N/A"!=t[i]?A(t[i]):($(this).select("line.close").attr("class","NA"),A(0))}).style("stroke","#15c515").attr("stroke-width","1px"),x.selectAll("line.stem").data(r).enter().append("svg:line").attr("class","stem").attr("x1",function(t){return M(t.timeIndex)+.25*(v-(n.left+n.right))/r.length}).attr("x2",function(t){return M(t.timeIndex)+.25*(v-(n.left+n.right))/r.length}).attr("y1",function(t){return"N/A"!=t[a]?A(t[a]):($(this).select("line.stem").attr("class","NA"),A(0))}).attr("y2",function(t){return"N/A"!=t[o]?A(t[o]):($(this).select("line.stem").attr("class","NA"),A(0))}).attr("stroke","#15c515").attr("stroke-width","1px");var C=d3.svg.line().x(function(t){return M(t.timeIndex)}).y(function(t){return A(t[l])}).interpolate("linear").defined(function(t){return 0!=t[l]}).defined(function(t){return"N/A"!=t[l]&&0!=t[l]}),S=d3.svg.line().x(function(t){return M(t.timeIndex)}).y(function(t){return A(t[s])}).interpolate("linear").defined(function(t){return 0!=t[s]}).defined(function(t){return"N/A"!=t[s]&&0!=t[s]}),T=d3.svg.line().x(function(t){return M(t.timeIndex)}).y(function(t){return A(t[u])}).interpolate("linear").defined(function(t){return 0!=t[u]}).defined(function(t){return"N/A"!=t[u]&&0!=t[u]}),L=d3.svg.line().x(function(t){return M(t.timeIndex)}).y(function(t){return A(t[c])}).interpolate("linear").defined(function(t){return 0!=t[c]&&"N/A"!=t[c]});x.selectAll("path.high-band").data([r]).enter().append("path").attr("class","high-band band").style("stroke-dasharray","1, 4").attr("d",C).attr("stroke-width",2).attr("fill","none").attr("stroke-dasharray","1px, 4px").attr("stroke","#fcfcfc"),x.selectAll("path.low-band").data([r]).enter().append("path").attr("class","low-band band").style("stroke-dasharray","1, 4").attr("d",S).attr("stroke-width",2).attr("fill","none").attr("stroke-dasharray","1px, 4px").attr("stroke","#fcfcfc"),x.selectAll("path.mid-band").data([r]).enter().append("path").attr("class","band mid-band").style("stroke-dasharray","1, 4").attr("d",T).attr("stroke-width",1).attr("fill","none").attr("stroke","#fcfcfc"),x.selectAll("path.trend").data([r]).enter().append("path").attr("class","trend").attr("d",L).attr("fill","none").attr("stroke","#e38502").attr("stroke-width","1px"),x.append("line").attr("x1",5).attr("x2",5).attr("y1",0).attr("y2",y).attr("class","drag-line").style("display","none").style("stroke","#FFFFFF").style("stroke-width","2px")
},drawPowerGauageChart:function(t){for(var e=StockMarketChartManager.selectorContainerId,n=StockMarketChartManager.margin,r=(StockMarketChartManager.scalableLimit,t.data),a=t.pgrFieldName,i=t.pgrColorMap,o=StockMarketChartManager.chartHeightMap,l=0;l<r.length;l++){var s=r[l];for(var u in s)(isNaN(s[u])||null==s[u])&&(s[u]="N/A");r[l]=s}var c=d3.select("#"+e).style("width"),d=o.powergauage;c=parseInt(c.replace("px",""));var f=c-n.left-n.right,h=d-n.top-n.bottom,p=d3.select("#"+e).append("svg:svg").attr("class","power-gauage").attr("id","power-gauage").attr("width",c).attr("height",d),g=d3.max(r.map(function(t){return t.powerGauageFieldName})),y=d3.min(r.map(function(t){return t.powerGauageFieldName})),v=(d3.scale.linear().domain([y,g]).range([h-n.bottom,n.top]),d3.scale.linear().domain([d3.min(r.map(function(t){return t.timeIndex})),d3.max(r.map(function(t){return t.timeIndex}))]).range([n.left,f]));StockMarketChartManager.xScaleHistoricChart=v;var m=v(r[1].timeIndex)-v(r[0].timeIndex);p.selectAll("rect.rel-strength").data(r).enter().append("svg:rect").attr("class","rel-strength").attr("x",function(t){return v(t.timeIndex)}).attr("y",function(){return 0}).attr("width",m).attr("height",h).attr("fill",function(t){return i[t[a]]}).attr("stroke",function(t){return i[t[a]]}),p.append("line").attr("x1",5).attr("x2",5).attr("y1",0).attr("y2",d).attr("class","drag-line").style("display","none").style("stroke","#FFFFFF").style("stroke-width","2px")},drawTimeScale:function(t){var e=StockMarketChartManager.xScaleHistoricChart,n=StockMarketChartManager.selectorContainerId,r=StockMarketChartManager.margin,a=d3.select("#"+n).style("width"),i=30;a=parseInt(a.replace("px",""));var o=(a-r.left-r.right,{}),l=[],s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],u={};$(t).each(function(t,e){var n=new Date(e);void 0==o[n.getMonth()+"-"+n.getYear()]&&n.getDate()<15&&(l.push(e),u[e]=t,o[n.getMonth()+"-"+n.getYear()]=!0)});for(var c in u)console.log("keys    "+c+" value "+u[c]);var d=new Date(l[0]),f=d3.select("#"+n).append("svg:svg").attr("class","time-axis").attr("id","time-axis").attr("width",a).attr("height",i),h=f.selectAll("div.tick").data(l).enter().append("g").attr("class","tick").attr("transform",function(t){console.log("xScale  "+e(u[t]));var n=e(u[t]);return"translate("+n+","+r.top+")"});h.append("text").style("color","#FFFFFF").style("font-size","12px").attr("fill","#FFFFFF").text(function(t,e){var n=new Date(t);return 0==e?"'"+(d.getFullYear()+"").substr(2,3):s[n.getMonth()]}),f.append("line").attr("x1",5).attr("x2",5).attr("y1",0).attr("y2",i).attr("class","drag-line").style("display","none").style("stroke","#FFFFFF").style("stroke-width","2px")},appendToolTip:function(){{var t='<div id="tooltipChart-stock-market" style="z-index:99999;float:none;display:none; margin:0px; padding:0px; position:absolute; width:150px;"><div id="textContainer" style="width:150px; background-color:#eeeeee; border:solid 1px #666666; box-shadow:5px 5px 5px #5d5d5d; border-radius:7px; font-family:calibri; float:left; font-size:11px; padding:10px;">	<div class="xVal" style="text-align:center; font-size:13px; background-color:#6699cc; border-top-left-radius:7px; margin-top:-10px; margin-left:-10px;  margin-right:-10px;border-top-right-radius:7px; padding:5px 10px;">14 jan</div><div id="y-label" class="y-label label1" style="width:60%;display:none; float:left; text-align:left; padding:3px 0;">Auto Loans</div><div  class="yVal label1" style="width:40%; float:right;display:none; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label2" style="width:60%; float:left;display:none; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label2" style="width:40%;display:none; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label3" style="width:60%; float:left; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label3" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label4" style="width:60%; float:left; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label4" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label5" style="width:60%; float:left; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label5" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>	</div></div>';StockMarketChartManager.selectorContainerId}$("body").append(t)},showToolTip:function(t,e,n,r,a){var i,o=t.pageX;i=t.pageY;var l;l=e;var s;s=n,$("#tooltipChart-stock-market").find(".xVal").html(""),$("#tooltipChart-stock-market").find(".xVal").html(s),$("#tooltipChart-stock-market").find(".y-label").html(""),$("#tooltipChart-stock-market").find(".yVal").html(""),$("#tooltipChart-stock-market").find(".yVal").hide(),$("#tooltipChart-stock-market").find(".y-label").hide();for(var u=$("#tooltipChart-stock-market"),c=0;c<a.length;c++){var d=a[c],f=c+1,h=".y-label.label"+f,p=".yVal.label"+f;$(u).find(h).html(d.headingName),$(u).find(p).html(d.headingVal),$(u).find(p).show(),$(u).find(h).show()}var g=o;if($(".ps-scrollbar-x-rail"))try{g+=parseInt($(".ps-scrollbar-x-rail").css("left").replace("px",""))}catch(y){}var v=$("body").find("#tooltipChart-stock-market"),m=($(v).find("#textContainer"),i-.9*$("body").find("#tooltipChart-stock-market").height());g-=.95*$("body").find("#tooltipChart-stock-market").width(),g-$(v).width()<170&&(g=.5*g+$(v).width()),console.log("page y "+m+"y "+i),$("body").find("#tooltipChart-stock-market").css("left",g);var x=StockMarketChartManager.selectorContainerId,b=parseInt(d3.select("#"+x).style("height").replace("px",""));$("body").find("#tooltipChart-stock-market").css("top",b/2),$("body").find("#tooltipChart-stock-market").show()},hideToolTip:function(){$("#tooltipChart-stock-market").find(".yVal").html(""),d3.select("#tooltipChart-stock-market").style("display","none")}};